{
  "title": "How to set up an application with pyproject.toml",
  "source_url": "https://docs.langchain.com/langsmith/setup-pyproject",
  "content": "An application must be configured with a [configuration file](/langsmith/cli#configuration-file) in order to be deployed to LangSmith (or to be self-hosted). This how-to guide discusses the basic steps to set up an application for deployment using `pyproject.toml` to define your package's dependencies.\n\nThis example is based on [this repository](https://github.com/langchain-ai/langgraph-example-pyproject), which uses the LangGraph framework.\n\nThe final repository structure will look something like this:\n\n```bash  theme={null}\nmy-app/\n├── my_agent # all project code lies within here\n│   ├── utils # utilities for your graph\n│   │   ├── __init__.py\n│   │   ├── tools.py # tools for your graph\n│   │   ├── nodes.py # node functions for your graph\n│   │   └── state.py # state definition of your graph\n│   ├── __init__.py\n│   └── agent.py # code for constructing your graph\n├── .env # environment variables\n├── langgraph.json  # configuration file for LangGraph\n└── pyproject.toml # dependencies for your project\n```\n\n<Tip>\n  LangSmith Deployment supports deploying a [LangGraph](/oss/python/langgraph/overview) *graph*. However, the implementation of a *node* of a graph can contain arbitrary Python code. This means any framework can be implemented within a node and deployed on LangSmith Deployment. This lets you keep your core application logic outside LangGraph while still using LangSmith for [deployment](/langsmith/deployments), scaling, and [observability](/langsmith/observability).\n</Tip>\n\nYou can also set up with:\n\n* `requirements.txt`: for dependency management, check out [this how-to guide](/langsmith/setup-app-requirements-txt) on using `requirements.txt` for LangSmith.\n* a monorepo: To deploy a graph located inside a monorepo, take a look at [this repository](https://github.com/langchain-ai/langgraph-example-monorepo) for an example of how to do so.\n\nAfter each step, an example file directory is provided to demonstrate how code can be organized.\n\n## Specify dependencies\n\nDependencies can optionally be specified in one of the following files: `pyproject.toml`, `setup.py`, or `requirements.txt`. If none of these files is created, then dependencies can be specified later in the [configuration file](#create-the-configuration-file).\n\nThe dependencies below will be included in the image, you can also use them in your code, as long as with a compatible version range:\n\n```\nlanggraph>=0.6.0\nlanggraph-sdk>=0.1.66\nlanggraph-checkpoint>=2.0.23\nlangchain-core>=0.2.38\nlangsmith>=0.1.63\norjson>=3.9.7,<3.10.17\nhttpx>=0.25.0\ntenacity>=8.0.0\nuvicorn>=0.26.0\nsse-starlette>=2.1.0,<2.2.0\nuvloop>=0.18.0\nhttptools>=0.5.0\njsonschema-rs>=0.20.0\nstructlog>=24.1.0\ncloudpickle>=3.0.0\n```\n\nExample `pyproject.toml` file:\n\n```toml  theme={null}\n[build-system]\nrequires = [\"hatchling\"]\nbuild-backend = \"hatchling.build\"\n\n[project]\nname = \"my-agent\"\nversion = \"0.0.1\"\ndescription = \"An excellent agent build for LangSmith.\"\nauthors = [\n    {name = \"Polly the parrot\", email = \"1223+polly@users.noreply.github.com\"}\n]\nlicense = {text = \"MIT\"}\nreadme = \"README.md\"\nrequires-python = \">=3.9\"\ndependencies = [\n    \"langgraph>=0.6.0\",\n    \"langchain-fireworks>=0.1.3\"\n]\n\n[tool.hatch.build.targets.wheel]\npackages = [\"my_agent\"]\n```\n\nExample file directory:\n\n```bash  theme={null}\nmy-app/\n└── pyproject.toml   # Python packages required for your graph\n```\n\n## Specify environment variables\n\nEnvironment variables can optionally be specified in a file (e.g. `.env`). See the [Environment Variables reference](/langsmith/env-var) to configure additional variables for a deployment.\n\nExample `.env` file:\n\n```\nMY_ENV_VAR_1=foo\nMY_ENV_VAR_2=bar\nFIREWORKS_API_KEY=key\n```\n\nExample file directory:\n\n```bash  theme={null}\nmy-app/\n├── .env # file with environment variables\n└── pyproject.toml\n```\n\n<Tip>\n  By default, LangSmith follows the `uv`/`pip` behavior of **not** installing prerelease versions unless explicitly allowed. If want to use prereleases, you have the following options:\n\n  * With `pyproject.toml`: add `allow-prereleases = true` to your `[tool.uv]` section.\n  * With `requirements.txt` or `setup.py`: you must explicitly specify every prerelease dependency, including transitive ones. For example, if you declare `a==0.0.1a1` and `a` depends on `b==0.0.1a1`, then you must also explicitly include `b==0.0.1a1` in your dependencies.\n</Tip>\n\n## Define graphs\n\nImplement your graphs. Graphs can be defined in a single file or multiple files. Make note of the variable names of each [CompiledStateGraph](https://reference.langchain.com/python/langgraph/graphs/#langgraph.graph.state.CompiledStateGraph) to be included in the application. The variable names will be used later when creating the [configuration file](/langsmith/cli#configuration-file).\n\nExample `agent.py` file, which shows how to import from other modules you define (code for the modules is not shown here, please see [this repository](https://github.com/langchain-ai/langgraph-example-pyproject) to see their implementation):\n\n```python  theme={null}\n# my_agent/agent.py\nfrom typing import Literal\nfrom typing_extensions import TypedDict\n\nfrom langgraph.graph import StateGraph, END, START\nfrom my_agent.utils.nodes import call_model, should_continue, tool_node # import nodes\nfrom my_agent.utils.state import AgentState # import state\n\n# Define the runtime context\nclass GraphContext(TypedDict):\n    model_name: Literal[\"anthropic\", \"openai\"]\n\nworkflow = StateGraph(AgentState, context_schema=GraphContext)\nworkflow.add_node(\"agent\", call_model)\nworkflow.add_node(\"action\", tool_node)\nworkflow.add_edge(START, \"agent\")\nworkflow.add_conditional_edges(\n    \"agent\",\n    should_continue,\n    {\n        \"continue\": \"action\",\n        \"end\": END,\n    },\n)\nworkflow.add_edge(\"action\", \"agent\")\n\ngraph = workflow.compile()\n```\n\nExample file directory:\n\n```bash  theme={null}\nmy-app/\n├── my_agent # all project code lies within here\n│   ├── utils # utilities for your graph\n│   │   ├── __init__.py\n│   │   ├── tools.py # tools for your graph\n│   │   ├── nodes.py # node functions for your graph\n│   │   └── state.py # state definition of your graph\n│   ├── __init__.py\n│   └── agent.py # code for constructing your graph\n├── .env\n└── pyproject.toml\n```\n\n## Create the configuration file\n\nCreate a [configuration file](/langsmith/cli#configuration-file) called `langgraph.json`. See the [configuration file reference](/langsmith/cli#configuration-file) for detailed explanations of each key in the JSON object of the configuration file.\n\nExample `langgraph.json` file:\n\n```json  theme={null}\n{\n  \"dependencies\": [\".\"],\n  \"graphs\": {\n    \"agent\": \"./my_agent/agent.py:graph\"\n  },\n  \"env\": \".env\"\n}\n```\n\nNote that the variable name of the `CompiledGraph` appears at the end of the value of each subkey in the top-level `graphs` key (i.e. `:<variable_name>`).\n\n<Warning>\n  **Configuration file location**\n  The configuration file must be placed in a directory that is at the same level or higher than the Python files that contain compiled graphs and associated dependencies.\n</Warning>\n\nExample file directory:\n\n```bash  theme={null}\nmy-app/\n├── my_agent # all project code lies within here\n│   ├── utils # utilities for your graph\n│   │   ├── __init__.py\n│   │   ├── tools.py # tools for your graph\n│   │   ├── nodes.py # node functions for your graph\n│   │   └── state.py # state definition of your graph\n│   ├── __init__.py\n│   └── agent.py # code for constructing your graph\n├── .env # environment variables\n├── langgraph.json  # configuration file for LangGraph\n└── pyproject.toml # dependencies for your project\n```\n\n## Next\n\nAfter you setup your project and place it in a GitHub repository, it's time to [deploy your app](/langsmith/deployment-quickstart).\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/langsmith/setup-pyproject.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 8091
}