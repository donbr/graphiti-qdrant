{
  "title": "Subagents",
  "source_url": "https://docs.langchain.com/oss/javascript/deepagents/subagents",
  "content": "Learn how to use subagents to delegate work and keep context clean\n\nDeep agents can create subagents to delegate work. You can specify custom subagents in the `subagents` parameter. Subagents are useful for [context quarantine](https://www.dbreunig.com/2025/06/26/how-to-fix-your-context.html#context-quarantine) (keeping the main agent's context clean) and for providing specialized instructions.\n\n```mermaid  theme={null}\ngraph TB\n    Main[Main Agent] --> |task tool| Sub[Subagent]\n\n    Sub --> Research[Research]\n    Sub --> Code[Code]\n    Sub --> General[General]\n\n    Research --> |isolated work| Result[Final Result]\n    Code --> |isolated work| Result\n    General --> |isolated work| Result\n\n    Result --> Main\n```\n\n## Why use subagents?\n\nSubagents solve the **context bloat problem**. When agents use tools with large outputs (web search, file reads, database queries), the context window fills up quickly with intermediate results. Subagents isolate this detailed work—the main agent receives only the final result, not the dozens of tool calls that produced it.\n\n**When to use subagents:**\n\n* ✅ Multi-step tasks that would clutter the main agent's context\n* ✅ Specialized domains that need custom instructions or tools\n* ✅ Tasks requiring different model capabilities\n* ✅ When you want to keep the main agent focused on high-level coordination\n\n**When NOT to use subagents:**\n\n* ❌ Simple, single-step tasks\n* ❌ When you need to maintain intermediate context\n* ❌ When the overhead outweighs benefits\n\n## Configuration\n\n`subagents` should be a list of dictionaries or `CompiledSubAgent` objects. There are two types:\n\n### SubAgent (Dictionary-based)\n\nFor most use cases, define subagents as dictionaries:\n\n**Required fields:**\n\n* **name** (`str`): Unique identifier for the subagent. The main agent uses this name when calling the `task()` tool.\n* **description** (`str`): What this subagent does. Be specific and action-oriented. The main agent uses this to decide when to delegate.\n* **system\\_prompt** (`str`): Instructions for the subagent. Include tool usage guidance and output format requirements.\n* **tools** (`List[Callable]`): Tools the subagent can use. Keep this minimal and include only what's needed.\n\n**Optional fields:**\n\n* **model** (`str | BaseChatModel`): Override the main agent's model. Use the format `\"provider:model-name\"` (for example, `\"openai:gpt-4o\"`).\n* **middleware** (`List[Middleware]`): Additional middleware for custom behavior, logging, or rate limiting.\n* **interrupt\\_on** (`Dict[str, bool]`): Configure human-in-the-loop for specific tools. Requires a checkpointer.\n\n### CompiledSubAgent\n\nFor complex workflows, use a pre-built LangGraph graph:\n\n**Fields:**\n\n* **name** (`str`): Unique identifier\n* **description** (`str`): What this subagent does\n* **runnable** (`Runnable`): A compiled LangGraph graph (must call `.compile()` first)\n\n## Using SubAgent\n\n```typescript  theme={null}\nimport { tool } from \"langchain\";\nimport { TavilySearch } from \"@langchain/tavily\";\nimport { createDeepAgent } from \"deepagents\";\nimport { ChatAnthropic } from \"@langchain/anthropic\";\nimport { z } from \"zod\";\n\nconst internetSearch = tool(\n  async ({\n    query,\n    maxResults = 5,\n    topic = \"general\",\n    includeRawContent = false,\n  }: {\n    query: string;\n    maxResults?: number;\n    topic?: \"general\" | \"news\" | \"finance\";\n    includeRawContent?: boolean;\n  }) => {\n    const tavilySearch = new TavilySearch({\n      maxResults,\n      tavilyApiKey: process.env.TAVILY_API_KEY,\n      includeRawContent,\n      topic,\n    });\n    return await tavilySearch._call({ query });\n  },\n  {\n    name: \"internet_search\",\n    description: \"Run a web search\",\n    schema: z.object({\n      query: z.string().describe(\"The search query\"),\n      maxResults: z.number().optional().default(5),\n      topic: z\n        .enum([\"general\", \"news\", \"finance\"])\n        .optional()\n        .default(\"general\"),\n      includeRawContent: z.boolean().optional().default(false),\n    }),\n  },\n);\n\nconst researchSubagent = {\n  name: \"research-agent\",\n  description: \"Used to research more in depth questions\",\n  systemPrompt: \"You are a great researcher\",\n  tools: [internetSearch],\n  model: new ChatAnthropic({model:\"claude-sonnet-4-5-20250929\"}),  // Optional override, defaults to main agent model\n};\nconst subagents = [researchSubagent];\n\nconst agent = createDeepAgent({\n  model: new ChatAnthropic({model:\"claude-sonnet-4-5-20250929\"}),\n  subagents: subagents,\n});\n```\n\n## Using CompiledSubAgent\n\nFor more complex use cases, you can provide your own pre-built LangGraph graph as a subagent:\n\n```typescript  theme={null}\nimport { createDeepAgent, CompiledSubAgent } from \"deepagents\";\nimport { createAgent } from \"langchain\";\n\n// Create a custom agent graph\nconst customGraph = createAgent({\n  model: yourModel,\n  tools: specializedTools,\n  prompt: \"You are a specialized agent for data analysis...\",\n});\n\n// Use it as a custom subagent\nconst customSubagent: CompiledSubAgent = {\n  name: \"data-analyzer\",\n  description: \"Specialized agent for complex data analysis tasks\",\n  runnable: customGraph,\n};\n\nconst subagents = [customSubagent];\n\nconst agent = createDeepAgent({\n  model: \"claude-sonnet-4-5-20250929\",\n  tools: [internetSearch],\n  systemPrompt: researchInstructions,\n  subagents: subagents,\n});\n```\n\n## The general-purpose subagent\n\nIn addition to any user-defined subagents, deep agents have access to a `general-purpose` subagent at all times. This subagent:\n\n* Has the same system prompt as the main agent\n* Has access to all the same tools\n* Uses the same model (unless overridden)\n\n### When to use it\n\nThe general-purpose subagent is ideal for context isolation without specialized behavior. The main agent can delegate a complex multi-step task to this subagent and get a concise result back without bloat from intermediate tool calls.\n\n<Card title=\"Example\">\n  Instead of the main agent making 10 web searches and filling its context with results, it delegates to the general-purpose subagent: `task(name=\"general-purpose\", task=\"Research quantum computing trends\")`. The subagent performs all the searches internally and returns only a summary.\n</Card>\n\n## Best practices\n\n### Write clear descriptions\n\nThe main agent uses descriptions to decide which subagent to call. Be specific:\n\n✅ **Good:** `\"Analyzes financial data and generates investment insights with confidence scores\"`\n\n❌ **Bad:** `\"Does finance stuff\"`\n\n### Keep system prompts detailed\n\nInclude specific guidance on how to use tools and format outputs:\n\n```typescript  theme={null}\nconst researchSubagent = {\n  name: \"research-agent\",\n  description: \"Conducts in-depth research using web search and synthesizes findings\",\n  systemPrompt: `You are a thorough researcher. Your job is to:\n\n  1. Break down the research question into searchable queries\n  2. Use internet_search to find relevant information\n  3. Synthesize findings into a comprehensive but concise summary\n  4. Cite sources when making claims\n\n  Output format:\n  - Summary (2-3 paragraphs)\n  - Key findings (bullet points)\n  - Sources (with URLs)\n\n  Keep your response under 500 words to maintain clean context.`,\n  tools: [internetSearch],\n};\n```\n\n### Minimize tool sets\n\nOnly give subagents the tools they need. This improves focus and security:\n\n```typescript  theme={null}\n// ✅ Good: Focused tool set\nconst emailAgent = {\n  name: \"email-sender\",\n  tools: [sendEmail, validateEmail],  // Only email-related\n};\n\n// ❌ Bad: Too many tools\nconst emailAgentBad = {\n  name: \"email-sender\",\n  tools: [sendEmail, webSearch, databaseQuery, fileUpload],  // Unfocused\n};\n```\n\n### Choose models by task\n\nDifferent models excel at different tasks:\n\n```typescript  theme={null}\nconst subagents = [\n  {\n    name: \"contract-reviewer\",\n    description: \"Reviews legal documents and contracts\",\n    systemPrompt: \"You are an expert legal reviewer...\",\n    tools: [readDocument, analyzeContract],\n    model: \"claude-sonnet-4-5-20250929\",  // Large context for long documents\n  },\n  {\n    name: \"financial-analyst\",\n    description: \"Analyzes financial data and market trends\",\n    systemPrompt: \"You are an expert financial analyst...\",\n    tools: [getStockPrice, analyzeFundamentals],\n    model: \"gpt-5\",  // Better for numerical analysis\n  },\n];\n```\n\n### Return concise results\n\nInstruct subagents to return summaries, not raw data:\n\n```typescript  theme={null}\nconst dataAnalyst = {\n  systemPrompt: `Analyze the data and return:\n  1. Key insights (3-5 bullet points)\n  2. Overall confidence score\n  3. Recommended next actions\n\n  Do NOT include:\n  - Raw data\n  - Intermediate calculations\n  - Detailed tool outputs\n\n  Keep response under 300 words.`,\n};\n```\n\n## Common patterns\n\n### Multiple specialized subagents\n\nCreate specialized subagents for different domains:\n\n```typescript  theme={null}\nimport { createDeepAgent } from \"deepagents\";\n\nconst subagents = [\n  {\n    name: \"data-collector\",\n    description: \"Gathers raw data from various sources\",\n    systemPrompt: \"Collect comprehensive data on the topic\",\n    tools: [webSearch, apiCall, databaseQuery],\n  },\n  {\n    name: \"data-analyzer\",\n    description: \"Analyzes collected data for insights\",\n    systemPrompt: \"Analyze data and extract key insights\",\n    tools: [statisticalAnalysis],\n  },\n  {\n    name: \"report-writer\",\n    description: \"Writes polished reports from analysis\",\n    systemPrompt: \"Create professional reports from insights\",\n    tools: [formatDocument],\n  },\n];\n\nconst agent = createDeepAgent({\n  model: \"claude-sonnet-4-5-20250929\",\n  systemPrompt: \"You coordinate data analysis and reporting. Use subagents for specialized tasks.\",\n  subagents: subagents,\n});\n```\n\n**Workflow:**\n\n1. Main agent creates high-level plan\n2. Delegates data collection to data-collector\n3. Passes results to data-analyzer\n4. Sends insights to report-writer\n5. Compiles final output\n\nEach subagent works with clean context focused only on its task.\n\n## Troubleshooting\n\n### Subagent not being called\n\n**Problem**: Main agent tries to do work itself instead of delegating.\n\n**Solutions**:\n\n1. **Make descriptions more specific:**\n\n   ```typescript  theme={null}\n   // ✅ Good\n   { name: \"research-specialist\", description: \"Conducts in-depth research on specific topics using web search. Use when you need detailed information that requires multiple searches.\" }\n\n   // ❌ Bad\n   { name: \"helper\", description: \"helps with stuff\" }\n   ```\n\n2. **Instruct main agent to delegate:**\n\n   ```typescript  theme={null}\n   const agent = createDeepAgent({\n     systemPrompt: `...your instructions...\n\n     IMPORTANT: For complex tasks, delegate to your subagents using the task() tool.\n     This keeps your context clean and improves results.`,\n     subagents: [...]\n   });\n   ```\n\n### Context still getting bloated\n\n**Problem**: Context fills up despite using subagents.\n\n**Solutions**:\n\n1. **Instruct subagent to return concise results:**\n\n   ```typescript  theme={null}\n   systemPrompt: `...\n\n   IMPORTANT: Return only the essential summary.\n   Do NOT include raw data, intermediate search results, or detailed tool outputs.\n   Your response should be under 500 words.`\n   ```\n\n2. **Use filesystem for large data:**\n\n   ```typescript  theme={null}\n   systemPrompt: `When you gather large amounts of data:\n   1. Save raw data to /data/raw_results.txt\n   2. Process and analyze the data\n   3. Return only the analysis summary\n\n   This keeps context clean.`\n   ```\n\n### Wrong subagent being selected\n\n**Problem**: Main agent calls inappropriate subagent for the task.\n\n**Solution**: Differentiate subagents clearly in descriptions:\n\n```typescript  theme={null}\nconst subagents = [\n  {\n    name: \"quick-researcher\",\n    description: \"For simple, quick research questions that need 1-2 searches. Use when you need basic facts or definitions.\",\n  },\n  {\n    name: \"deep-researcher\",\n    description: \"For complex, in-depth research requiring multiple searches, synthesis, and analysis. Use for comprehensive reports.\",\n  }\n];\n```\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/oss/deepagents/subagents.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 12368
}