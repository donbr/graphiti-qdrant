{
  "title": "Egress for subscription metrics and operational metadata",
  "source_url": "https://docs.langchain.com/langsmith/self-host-egress",
  "content": "<Info>\n  This section only applies to customers who are not running in offline mode and assumes you are using a self-hosted LangSmith instance serving version 0.9.0 or later. Previous versions of LangSmith did not have this feature.\n</Info>\n\nSelf-Hosted LangSmith instances store all information locally and will never send sensitive information outside of your network. We currently only track platform usage for billing purposes according to the entitlements in your order. In order to better remotely support our customers, we do require egress to `https://beacon.langchain.com`.\n\nIn the future, we will be introducing support diagnostics to help us ensure that LangSmith is running at an optimal level within your environment.\n\n<Warning>\n  **This will require egress to `https://beacon.langchain.com` from your network. Refer to the [allowlisting IP section](/langsmith/cloud#allowlisting-ip-addresses) for static IP addresses, if needed.**\n</Warning>\n\nGenerally, data that we send to Beacon can be categorized as follows:\n\n* Subscription Metrics\n\n  * Subscription metrics are used to determine level of access and utilization of LangSmith. This includes, but are not limited to:\n\n    * Number of traces\n    * Seats allocated per contract\n    * Seats in currently use\n\n* Operational Metadata\n  * This metadata will contain and collect the above subscription metrics to assist with remote support, allowing the LangChain team to diagnose and troubleshoot performance issues more effectively and proactively.\n\n## LangSmith Telemetry\n\nAs of version ***0.11***, LangSmith deployments will by default send telemetry data back to our backend. All telemetry data is associated with an organization and deployment, but never identified with individual users. We ***do not collect PII*** (personally identifiable information) in any form.\n\n### What we use it for\n\n* To provide more proactive support and faster troubleshooting of self-hosted instances.\n* Assisting with performance tuning.\n* Understanding real-world usage to prioritize improvements.\n\n### What we collect\n\n* **Request metadata**: anonymized request counts, sizes, and durations.\n* **Database metrics**: query durations, error rates, and performance counters.\n* **Operational LangSmith traces**: traces with timing and error information for high-latency or failed requests. These are **not** customer traces, these are operational traces about the functioning of the LangSmith instance.\n\n<Info>\n  We do not collect actual payload contents, database records, or any data that can identify your end users or customers.\n</Info>\n\n### How to disable\n\nSet the following values in your `langsmith_config.yaml` file:\n\n```yaml  theme={null}\nconfig:\n  telemetry:\n    metrics: false\n    traces: false\n```\n\n## Example payloads\n\nIn an effort to maximize transparency, we provide sample payloads here:\n\n### License Verification\n\n**Endpoint:**\n\n`POST beacon.langchain.com/v1/beacon/verify`\n\n**Request:**\n\n```json  theme={null}\n{\n  \"license\": \"<YOUR_LICENSE_KEY>\"\n}\n```\n\n**Response:**\n\n```json  theme={null}\n{\n  \"token\": \"Valid JWT\" //Short-lived JWT token to avoid repeated license checks\n}\n```\n\n### Usage Reporting\n\n**Endpoint:**\n\n`POST beacon.langchain.com/v1/beacon/ingest-traces`\n\n**Request:**\n\n```json  theme={null}\n{\n  \"license\": \"<YOUR_LICENSE_KEY>\",\n  \"trace_transactions\": [\n    {\n      \"id\": \"af28dfea-5358-463d-a2dc-37df1da72498\",\n      \"tenant_id\": \"3a1c2b6f-4430-4b92-8a5b-79b8b567bbc1\",\n      \"session_id\": \"b26ae531-cdb3-42a5-8bcf-05355199fe27\",\n      \"trace_count\": 5,\n      \"start_insertion_time\": \"2025-01-06T10:00:00Z\",\n      \"end_insertion_time\": \"2025-01-06T11:00:00Z\",\n      \"start_interval_time\": \"2025-01-06T09:00:00Z\",\n      \"end_interval_time\": \"2025-01-06T10:00:00Z\",\n      \"status\": \"completed\",\n      \"num_failed_send_attempts\": 0,\n      \"transaction_type\": \"type1\",\n      \"organization_id\": \"c5b5f53a-4716-4326-8967-d4f7f7799735\"\n    }\n  ]\n}\n```\n\n**Response:**\n\n```json  theme={null}\n{\n  \"inserted_count\": 1 //Number of transactions successfully ingested\n}\n```\n\n### Telemetry: Operational LangSmith Metrics\n\n**Endpoint:**\n\n`POST beacon.langchain.com/v1/beacon/v1/metrics`\n\n**Request:**\n\n```json  theme={null}\n{\n  \"resourceMetrics\": [\n    {\n      \"resource\": {\n        \"attributes\": [\n          {\n            \"key\": \"resource.name\",\n            \"value\": { \"stringValue\": \"langsmith-metrics\" }\n          },\n          {\n            \"key\": \"env\",\n            \"value\": { \"stringValue\": \"ls_self_hosted\" }\n          }\n        ]\n      },\n      \"scopeMetrics\": [\n        {\n          \"scope\": {\n            \"name\": \"langsmith.metrics\",\n            \"version\": \"0.1.0\"\n          },\n          \"metrics\": [\n            {\n              \"name\": \"langsmith_http_requests_latency\",\n              \"unit\": \"seconds\",\n              \"description\": \"Request latency of LangSmith services\",\n              \"gauge\": {\n                \"dataPoints\": [\n                  {\n                    \"asDouble\": 12.34,\n                    \"startTimeUnixNano\": 1678886400000000000,\n                    \"timeUnixNano\": 1678886400000000000,\n                    \"attributes\": [\n                      {\n                        \"key\": \"endpoint\",\n                        \"value\": { \"stringValue\": \"/sessions\" }\n                      },\n                      { \"key\": \"method\", \"value\": { \"stringValue\": \"GET\" } },\n                      {\n                        \"key\": \"service_name\",\n                        \"value\": { \"stringValue\": \"langsmith_backend\" }\n                      }\n                    ]\n                  }\n                ]\n              }\n            },\n            {\n              \"name\": \"langsmith_http_requests_failed\",\n              \"unit\": \"1\",\n              \"description\": \"Counter of failed requests for LangSmith services\",\n              \"sum\": {\n                \"dataPoints\": [\n                  {\n                    \"asInt\": 456,\n                    \"startTimeUnixNano\": 1678886400000000000,\n                    \"timeUnixNano\": 1678886400000000000,\n                    \"attributes\": [\n                      {\n                        \"key\": \"endpoint\",\n                        \"value\": { \"stringValue\": \"/info\" }\n                      },\n                      { \"key\": \"method\", \"value\": { \"stringValue\": \"POST\" } },\n                      {\n                        \"key\": \"service_name\",\n                        \"value\": { \"stringValue\": \"langsmith_platform_backend\" }\n                      }\n                    ],\n                    \"aggregationTemporality\": 2,\n                    \"isMonotonic\": true\n                  }\n                ]\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n### Telemetry: Operational LangSmith Traces\n\n**Endpoint:**\n\n`POST beacon.langchain.com/v1/beacon/v1/traces`\n\n**Request:**\n\n```json  theme={null}\n{\n  \"resourceSpans\": [\n    {\n      \"resource\": {\n        \"attributes\": [\n          {\n            \"key\": \"env\",\n            \"value\": {\n              \"stringValue\": \"ls_self_hosted\"\n            }\n          },\n          {\n            \"key\": \"service.name\",\n            \"value\": {\n              \"stringValue\": \"langsmith_backend\"\n            }\n          }\n        ]\n      },\n      \"scopeSpans\": [\n        {\n          \"scope\": {},\n          \"spans\": [\n            {\n              \"traceId\": \"71699b6fe85982c7c8995ea3d9c95df2\",\n              \"spanId\": \"3c191d03fa8be0\",\n              \"parentSpanId\": \"\",\n              \"name\": \"receive_request\",\n              \"startTimeUnixNano\": \"1581452772000000321\",\n              \"endTimeUnixNano\": \"1581452773000000789\",\n              \"droppedAttributesCount\": 1,\n              \"events\": [\n                {\n                  \"timeUnixNano\": \"1581452773000000123\",\n                  \"name\": \"parse_request\",\n                  \"attributes\": [\n                    {\n                      \"key\": \"request_size\",\n                      \"value\": {\n                        \"stringValue\": \"100\"\n                      }\n                    }\n                  ],\n                  \"droppedAttributesCount\": 2\n                },\n                {\n                  \"timeUnixNano\": \"1581452773000000123\",\n                  \"name\": \"event\",\n                  \"droppedAttributesCount\": 2\n                }\n              ],\n              \"droppedEventsCount\": 1,\n              \"status\": {\n                \"message\": \"status-cancelled\",\n                \"code\": 2\n              }\n            },\n            {\n              \"traceId\": \"71699b6fe85982c7c8995ea3d9c95df2\",\n              \"spanId\": \"0932ksdka12345\",\n              \"parentSpanId\": \"3c191d03fa8be0\",\n              \"name\": \"process_request\",\n              \"startTimeUnixNano\": \"1581452772000000321\",\n              \"endTimeUnixNano\": \"1581452773000000789\",\n              \"links\": [],\n              \"droppedLinksCount\": 3,\n              \"status\": {}\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n## Our Commitment\n\nLangChain will not store any sensitive information in the Subscription Metrics or Operational Metadata. Any data collected will not be shared with a third party. If you have any concerns about the data being sent, please reach out to your account team.\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/langsmith/self-host-egress.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 9543
}