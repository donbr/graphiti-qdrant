{
  "title": "Generate ClickHouse stats",
  "source_url": "https://docs.langchain.com/langsmith/script-generate-clickhouse-stats",
  "content": "As part of troubleshooting your self-hosted instance of LangSmith, the LangChain team may ask you to generate Clickhouse statistics that will help us understand memory and CPU consumption and connection concurrency.\n\nThis command will generate a CSV that can be shared with the LangChain team.\n\n### Prerequisites\n\nEnsure you have the following tools/items ready.\n\n1. kubectl\n\n   * [https://kubernetes.io/docs/tasks/tools/](https://kubernetes.io/docs/tasks/tools/)\n\n2. Clickhouse database credentials\n\n   * Host\n   * Port\n   * Username\n     * If using the bundled version, this is `default`\n   * Password\n     * If using the bundled version, this is `password`\n   * Database name\n     * If using the bundled version, this is `default`\n\n3. Connectivity to the Clickhouse database from the machine you will be running the `get_clickhouse_stats` script on.\n\n   * If you are using the bundled version, you may need to port forward the clickhouse service to your local machine.\n   * Run `kubectl port-forward svc/langsmith-clickhouse 8123:8123` to port forward the clickhouse service to your local machine.\n\n4. The script to generate ClickHouse stats\n\n   * You can download the script from [here](https://github.com/langchain-ai/helm/blob/main/charts/langsmith/scripts/get_clickhouse_stats.sh)\n\n### Running the clickhouse stats generation script\n\nRun the following command to run the stats generation script:\n\n```bash  theme={null}\nsh get_clickhouse_stats.sh <clickhouse_url> --output path/to/file.csv\n```\n\nFor example, if you are using the bundled version with port-forwarding, the command would look like:\n\n```bash  theme={null}\nsh get_clickhouse_stats.sh \"clickhouse://default:password@localhost:8123/default\" --output clickhouse_stats.csv\n```\n\nand after running this command you should see a file, clickhouse\\_stats.csv, has been created with Clickhouse statistics.\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/langsmith/script-generate-clickhouse-stats.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 2238
}