{
  "title": "LangSmith Observability",
  "source_url": "https://docs.langchain.com/oss/python/langgraph/observability",
  "content": "Traces are a series of steps that your application takes to go from input to output. Each of these individual steps is represented by a run. You can use [LangSmith](https://smith.langchain.com/) to visualize these execution steps. To use it, [enable tracing for your application](/langsmith/trace-with-langgraph). This enables you to do the following:\n\n* [Debug a locally running application](/langsmith/observability-studio#debug-langsmith-traces).\n* [Evaluate the application performance](/oss/python/langchain/evals).\n* [Monitor the application](/langsmith/dashboards).\n\n## Prerequisites\n\nBefore you begin, ensure you have the following:\n\n* **A LangSmith account**: Sign up (for free) or log in at [smith.langchain.com](https://smith.langchain.com).\n* **A LangSmith API key**: Follow the [Create an API key](/langsmith/create-account-api-key#create-an-api-key) guide.\n\n## Enable tracing\n\nTo enable tracing for your application, set the following environment variables:\n\n```python  theme={null}\nexport LANGSMITH_TRACING=true\nexport LANGSMITH_API_KEY=<your-api-key>\n```\n\nBy default, the trace will be logged to the project with the name `default`. To configure a custom project name, see [Log to a project](#log-to-a-project).\n\nFor more information, see [Trace with LangGraph](/langsmith/trace-with-langgraph).\n\n## Trace selectively\n\nYou may opt to trace specific invocations or parts of your application using LangSmith's `tracing_context` context manager:\n\n```python  theme={null}\nimport langsmith as ls\n\n# This WILL be traced\nwith ls.tracing_context(enabled=True):\n    agent.invoke({\"messages\": [{\"role\": \"user\", \"content\": \"Send a test email to alice@example.com\"}]})\n\n# This will NOT be traced (if LANGSMITH_TRACING is not set)\nagent.invoke({\"messages\": [{\"role\": \"user\", \"content\": \"Send another email\"}]})\n```\n\n## Log to a project\n\n<Accordion title=\"Statically\">\n  You can set a custom project name for your entire application by setting the `LANGSMITH_PROJECT` environment variable:\n\n  ```bash  theme={null}\n  export LANGSMITH_PROJECT=my-agent-project\n  ```\n</Accordion>\n\n<Accordion title=\"Dynamically\">\n  You can set the project name programmatically for specific operations:\n\n  ```python  theme={null}\n  import langsmith as ls\n\n  with ls.tracing_context(project_name=\"email-agent-test\", enabled=True):\n      response = agent.invoke({\n          \"messages\": [{\"role\": \"user\", \"content\": \"Send a welcome email\"}]\n      })\n  ```\n</Accordion>\n\n## Add metadata to traces\n\nYou can annotate your traces with custom metadata and tags:\n\n```python  theme={null}\nresponse = agent.invoke(\n    {\"messages\": [{\"role\": \"user\", \"content\": \"Send a welcome email\"}]},\n    config={\n        \"tags\": [\"production\", \"email-assistant\", \"v1.0\"],\n        \"metadata\": {\n            \"user_id\": \"user_123\",\n            \"session_id\": \"session_456\",\n            \"environment\": \"production\"\n        }\n    }\n)\n```\n\n`tracing_context` also accepts tags and metadata for fine-grained control:\n\n```python  theme={null}\nwith ls.tracing_context(\n    project_name=\"email-agent-test\",\n    enabled=True,\n    tags=[\"production\", \"email-assistant\", \"v1.0\"],\n    metadata={\"user_id\": \"user_123\", \"session_id\": \"session_456\", \"environment\": \"production\"}):\n    response = agent.invoke(\n        {\"messages\": [{\"role\": \"user\", \"content\": \"Send a welcome email\"}]}\n    )\n```\n\nThis custom metadata and tags will be attached to the trace in LangSmith.\n\n<Tip>\n  To learn more about how to use traces to debug, evaluate, and monitor your agents, see the [LangSmith documentation](/langsmith/home).\n</Tip>\n\n## Use anonymizers to prevent logging of sensitive data in traces\n\nYou may want to mask sensitive data to prevent it from being logged to LangSmith. You can create [anonymizers](/langsmith/mask-inputs-outputs#rule-based-masking-of-inputs-and-outputs) and apply them to\nyour graph using configuration. This example will redact anything matching the Social Security Number format XXX-XX-XXXX from traces sent to LangSmith.\n\n```python Python theme={null}\nfrom langchain_core.tracers.langchain import LangChainTracer\nfrom langgraph.graph import StateGraph, MessagesState\nfrom langsmith import Client\nfrom langsmith.anonymizer import create_anonymizer\n\nanonymizer = create_anonymizer([\n    # Matches SSNs\n    { \"pattern\": r\"\\b\\d{3}-?\\d{2}-?\\d{4}\\b\", \"replace\": \"<ssn>\" }\n])\n\ntracer_client = Client(anonymizer=anonymizer)\ntracer = LangChainTracer(client=tracer_client)\n# Define the graph\ngraph = (\n    StateGraph(MessagesState)\n    ...\n    .compile()\n    .with_config({'callbacks': [tracer]})\n)\n```\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/oss/langgraph/observability.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 4916
}