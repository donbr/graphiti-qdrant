{
  "title": "Trace with Google ADK",
  "source_url": "https://docs.langchain.com/langsmith/trace-with-google-adk",
  "content": "LangSmith supports tracing Google Agent Development Kit (ADK) applications through the OpenTelemetry integration. This guide shows you how to automatically capture traces from your [Google ADK](https://github.com/google/adk-python) agents and send them to LangSmith for monitoring and analysis.\n\n## Installation\n\nInstall the required packages using your preferred package manager:\n\n<CodeGroup>\n  ```bash pip theme={null}\n  pip install langsmith google-adk\n  ```\n\n  ```bash uv theme={null}\n  uv add langsmith google-adk\n  ```\n</CodeGroup>\n\n<Info>\n  Requires LangSmith Python SDK version `langsmith>=0.4.26` for optimal OpenTelemetry support.\n</Info>\n\n## Setup\n\n### 1. Configure environment variables\n\nSet your LangSmith API key and project name:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  export LANGSMITH_API_KEY=<your_langsmith_api_key>\n  export LANGSMITH_PROJECT=<your_project_name>\n  ```\n</CodeGroup>\n\n### 2. Configure OpenTelemetry integration\n\nIn your Google ADK application, import and configure the LangSmith OpenTelemetry integration. This will automatically instrument Google ADK spans for OpenTelemetry.\n\n```python  theme={null}\nfrom langsmith.integrations.otel import configure\n\n# Configure LangSmith tracing\nconfigure(project_name=\"adk-example\")  # Optional: can also use LANGSMITH_PROJECT and LANGSMITH_API_KEY environment variables\n```\n\nAlternatively, you can use the Openinference GoogleADKInstrumentor:\n\n```python  theme={null}\nfrom langsmith.integrations.otel import configure\nfrom openinference.instrumentation.google_adk import GoogleADKInstrumentor\n\n# Configure LangSmith tracing\nconfigure(project_name=\"adk-example\")\n\n# Instrument Google ADK directly\nGoogleADKInstrumentor().instrument()\n```\n\n<Note>\n  You do not need to set any OpenTelemetry environment variables or configure exporters manuallyâ€”`configure()` handles everything automatically.\n</Note>\n\n### 3. Create and run your ADK agent\n\nOnce configured, your Google ADK application will automatically send traces to LangSmith:\n\nThis example includes a minimal app that sets up an agent, session, and runner, then sends a message and streams events.\n\n```python  theme={null}\nimport asyncio\nfrom langsmith.integrations.otel import configure\nfrom google.adk import Runner\nfrom google.adk.agents import LlmAgent\nfrom google.adk.sessions import InMemorySessionService\nfrom google.genai import types\n\n# Configure LangSmith tracing\nconfigure(project_name=\"travel-assistant\")\n\n# Define your tools\ndef get_flight_info(destination: str, departure_date: str) -> dict:\n    \"\"\"Get flight information for a destination.\"\"\"\n    return {\n        \"destination\": destination,\n        \"departure_date\": departure_date,\n        \"price\": \"$450\",\n        \"duration\": \"5h 30m\",\n        \"airline\": \"Example Airways\"\n    }\n\ndef get_hotel_recommendations(city: str, check_in: str) -> dict:\n    \"\"\"Get hotel recommendations for a city.\"\"\"\n    return {\n        \"city\": city,\n        \"check_in\": check_in,\n        \"hotels\": [\n            {\"name\": \"Grand Plaza Hotel\", \"rating\": 4.5, \"price\": \"$120/night\"},\n            {\"name\": \"City Center Inn\", \"rating\": 4.2, \"price\": \"$95/night\"}\n        ]\n    }\n\nasync def main():\n    # Create your ADK agent\n    agent = LlmAgent(\n        name=\"travel_assistant\",\n        tools=[get_flight_info, get_hotel_recommendations],\n        model=\"gemini-2.5-flash-lite\",\n        instruction=\"You are a helpful travel assistant that can help with flights and hotels.\",\n    )\n\n    # Set up session service and runner\n    session_service = InMemorySessionService()\n    runner = Runner(\n        app_name=\"travel_app\",\n        agent=agent,\n        session_service=session_service\n    )\n\n    # Create a session\n    user_id = \"traveler_456\"\n    session_id = \"session_789\"\n    await session_service.create_session(\n        app_name=\"travel_app\",\n        user_id=user_id,\n        session_id=session_id\n    )\n\n    # Send a message to the agent\n    new_message = types.Content(\n        parts=[types.Part(text=\"I need to book a flight to Paris for March 15th and find a good hotel.\")],\n        role=\"user\",\n    )\n\n    # Run the agent and process events\n    events = runner.run(\n        user_id=user_id,\n        session_id=session_id,\n        new_message=new_message,\n    )\n\n    for event in events:\n        print(event)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\n## View traces in LangSmith\n\n* **Agent conversations**: Complete conversation flows between users and your ADK agents.\n* **Tool calls**: Individual function calls made by your agents.\n* **Model interactions**: LLM requests and responses using Gemini models.\n* **Session information**: User and session context for organizing related traces.\n* **Model interactions**: LLM requests and responses using Gemini models\n\n<img src=\"https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=3495c7838ba7467b905a180fc9ce477b\" alt=\"LangSmith dashboard with raw input from run and trace information.\" data-og-width=\"3022\" width=\"3022\" data-og-height=\"1444\" height=\"1444\" data-path=\"langsmith/images/adk.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?w=280&fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=b6db8e92abed624dc492ee12d217b5d3 280w, https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?w=560&fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=1caecf02d785375c0cae8c97cccf093c 560w, https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?w=840&fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=3b7fe88b62d4c4bffa889bd79fa5fefd 840w, https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?w=1100&fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=d7a152d9255fc6d42f946b3601e79ecc 1100w, https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?w=1650&fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=1eb5ea91226c92628f474254eb177f80 1650w, https://mintcdn.com/langchain-5e9cc07a/OEEzzB__isjPfBRD/langsmith/images/adk.png?w=2500&fit=max&auto=format&n=OEEzzB__isjPfBRD&q=85&s=a98880df67b4dae4c56de2a3d27fefa7 2500w\" />\n\n## Advanced usage\n\n### Custom metadata and tags\n\nYou can add custom metadata to your traces by setting span attributes in your ADK application:\n\n```python  theme={null}\nfrom opentelemetry import trace\n\n# Get the current tracer\ntracer = trace.get_tracer(__name__)\n\nasync def main():\n    with tracer.start_as_current_span(\"travel_booking_session\") as span:\n        # Add custom metadata\n        span.set_attribute(\"langsmith.metadata.user_type\", \"premium\")\n        span.set_attribute(\"langsmith.metadata.booking_source\", \"mobile_app\")\n        span.set_attribute(\"langsmith.span.tags\", \"travel,booking,premium\")\n\n        agent = LlmAgent(\n            name=\"travel_assistant\",\n            tools=[get_flight_info, get_hotel_recommendations],\n            model=\"gemini-2.5-flash-lite\",\n            instruction=\"You are a helpful travel assistant that can help with flights and hotels.\",\n        )\n\n        session_service = InMemorySessionService()\n        runner = Runner(\n            app_name=\"travel_app\",\n            agent=agent,\n            session_service=session_service\n        )\n\n        # Continue with your ADK workflow\n        # ...\n```\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/langsmith/trace-with-google-adk.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 7699
}