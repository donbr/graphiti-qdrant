{
  "title": "Manage your organization using the API",
  "source_url": "https://docs.langchain.com/langsmith/manage-organization-by-api",
  "content": "LangSmith's API supports programmatic access via API key to all of the actions available in the UI, with only a few exceptions that are noted in [User-only endpoints](#user-only-endpoints).\n\n<Check>\n  Before diving into this content, it might be helpful to read the following:\n\n  * [Conceptual guide on organizations and workspaces](/langsmith/administration-overview)\n  * [Organization setup how-to guild](/langsmith/set-up-a-workspace#set-up-an-organization)\n</Check>\n\n<Note>\n  There are a few limitations that will be lifted soon:\n\n  * The LangSmith SDKs do not support these organization management actions yet.\n  * Organization-scoped [service keys](/langsmith/administration-overview#service-keys) with Organization Admin permission may be used for these actions.\n</Note>\n\n<Warning>\n  Use the `X-Tenant-Id` header to specify which workspace to target. If the header is not present, operations will default to the workspace the API key was initially created in if it is not organization-scoped.\n\n  **If `X-Tenant-Id` is not specified when accessing workspace-scoped resources with an organization-scoped API key, the request will fail with `403 Forbidden`.**\n</Warning>\n\nSome commonly-used endpoints and use cases are listed below. For a complete list of available endpoints, see the [API docs](https://api.smith.langchain.com/redoc). **The `X-Organization-Id` header should be present on all requests, and `X-Tenant-Id` header should be present on requests that are scoped to a particular workspace.**\n\n## Workspaces\n\n* [List workspaces](https://api.smith.langchain.com/redoc#tag/workspaces/operation/list_workspaces_api_v1_workspaces_get)\n* [Create workspace](https://api.smith.langchain.com/redoc#tag/workspaces/operation/create_workspace_api_v1_workspaces_post)\n* [Update workspace name](https://api.smith.langchain.com/redoc#tag/workspaces/operation/patch_workspace_api_v1_workspaces__workspace_id__patch)\n\n## User management\n\n### RBAC\n\n* [List roles](https://api.smith.langchain.com/redoc#tag/orgs/operation/list_organization_roles_api_v1_orgs_current_roles_get)\n* [List permissions](https://api.smith.langchain.com/redoc#tag/orgs/operation/update_organization_roles_api_v1_orgs_current_roles__role_id__patch)\n* [Create role](https://api.smith.langchain.com/redoc#tag/orgs/operation/create_organization_roles_api_v1_orgs_current_roles_post)\n* [Update role](https://api.smith.langchain.com/redoc#tag/orgs/operation/update_organization_roles_api_v1_orgs_current_roles__role_id__patch)\n\n### Membership management\n\n`List roles` under [RBAC](#rbac) should be used for retrieving role IDs of these operations. `List [organization|workspace] members` endpoints (below) response `\"id\"`s should be used as `identity_id` in these operations.\n\nOrganization level:\n\n* [List active organization members](https://api.smith.langchain.com/redoc#tag/orgs/operation/get_current_active_org_members_api_v1_orgs_current_members_active_get)\n* [List pending organization members](https://api.smith.langchain.com/redoc#tag/orgs/operation/get_current_pending_org_members_api_v1_orgs_current_members_pending_get)\n* [Invite a user to the organization and one or more workspaces](https://api.smith.langchain.com/redoc#tag/orgs/operation/add_members_to_current_org_batch_api_v1_orgs_current_members_batch_post). This should be used when the user is not already a member in the organization.\n* [Update a user's organization role](https://api.smith.langchain.com/redoc#tag/workspaces/operation/add_member_to_current_workspace_api_v1_workspaces_current_members_post)\n* [Remove someone from the organization](https://api.smith.langchain.com/redoc#tag/orgs/operation/remove_member_from_current_org_api_v1_orgs_current_members__identity_id__delete)\n\nWorkspace level:\n\n* [List workspace members](https://api.smith.langchain.com/redoc#tag/workspaces/operation/get_current_workspace_members_api_v1_workspaces_current_members_get)\n* [Add a member to a workspace that is already part of the organization](https://api.smith.langchain.com/redoc#tag/workspaces/operation/add_member_to_current_workspace_api_v1_workspaces_current_members_post)\n* [Update a user's workspace role](https://api.smith.langchain.com/redoc#tag/workspaces/operation/add_member_to_current_workspace_api_v1_workspaces_current_members_post)\n* [Remove someone from a workspace](https://api.smith.langchain.com/redoc#tag/workspaces/operation/delete_current_workspace_member_api_v1_workspaces_current_members__identity_id__delete)\n\n<Note>\n  These params should be omitted: `read_only` (deprecated), `password` and `full_name` ([basic auth](/langsmith/authentication-methods) only)\n</Note>\n\n## API keys\n\n* [Create a service key](https://api.smith.langchain.com/redoc#tag/api-key/operation/generate_api_key_api_v1_api_key_post)\n* [Delete a service key](https://api.smith.langchain.com/redoc#tag/api-key/operation/delete_api_key_api_v1_api_key__api_key_id__delete)\n\n## Security settings\n\n<Note>\n  Organization Admin permissions are required to make these changes.\n</Note>\n\n<Note>\n  \"Shared resources\" in this context refer to [public prompts](/langsmith/create-a-prompt#save-your-prompt), [shared runs](/langsmith/share-trace), and [shared datasets](/langsmith/manage-datasets#share-a-dataset).\n</Note>\n\n<Warning>\n  Updating these settings affects **all resources in the organization**.\n</Warning>\n\nYou can update these settings under the **Settings > Shared** tab for a workspace, or via API:\n\n* [Update organization sharing settings](https://api.smith.langchain.com/redoc#tag/orgs/operation/update_current_organization_info_api_v1_orgs_current_info_patch)\n  * use `unshare_all` to unshare **ALL** shared resources in the organization - use `disable_public_sharing` to prevent future sharing of resources\n\nThese settings are only editable via API:\n\n* [Disable/enable PAT creation](https://api.smith.langchain.com/redoc#tag/orgs/operation/update_current_organization_info_api_v1_orgs_current_info_patch) (for self-hosted, available in Helm chart version 0.11.25+)\n  * Use `pat_creation_disabled` to disable PAT creation for the entire organization.\n  * See the [admin guide](/langsmith/administration-overview#organization-roles) for information about the Organization Viewer role, which cannot create PATs.\n\n## User-only endpoints\n\nThese endpoints are user-scoped and require a logged-in user's JWT, so they should only be executed through the UI.\n\n* `/api-key/current` endpoints: these are related a user's PATs\n* `/sso/email-verification/send` (Cloud-only): this endpoint is related to [SAML SSO](/langsmith/user-management)\n\n## Sample code\n\nThe sample code below goes through a few common workflows related to organization management. Make sure to make necessary replacements wherever `<replace_me>` is in the code.\n\n```python  theme={null}\nimport os\nimport requests\n\ndef main():\n    api_key = os.environ[\"LANGSMITH_API_KEY\"]\n    # LANGSMITH_ORGANIZATION_ID is not a standard environment variable in the SDK, just used for this example\n    organization_id = os.environ[\"LANGSMITH_ORGANIZATION_ID\"]\n    base_url = os.environ.get(\"LANGSMITH_ENDPOINT\")  # or \"https://api.smith.langchain.com\". Update appropriately for self-hosted installations or the EU region\n    headers = {\n        \"Content-Type\": \"application/json\",\n        \"X-API-Key\": api_key,\n        \"X-Organization-Id\": organization_id,\n    }\n    session = requests.Session()\n    session.headers.update(headers)\n    workspaces_path = f\"{base_url}/api/v1/workspaces\"\n    orgs_path = f\"{base_url}/api/v1/orgs/current\"\n    api_keys_path = f\"{base_url}/api/v1/api-key\"\n\n    # Create a workspace\n    workspace_res = session.post(workspaces_path, json={\"display_name\": \"My Workspace\"})\n    workspace_res.raise_for_status()\n    workspace = workspace_res.json()\n    workspace_id = workspace[\"id\"]\n    new_workspace_headers = {\n        \"X-Tenant-Id\": workspace_id,\n    }\n\n    # Grab roles - this includes both organization and workspace roles\n    roles_res = session.get(f\"{orgs_path}/roles\")\n    roles_res.raise_for_status()\n    roles = roles_res.json()\n    # system org roles are 'Organization Admin', 'Organization User'\n    # system workspace roles are 'Admin', 'Editor', 'Viewer'\n    org_roles_by_name = {role[\"display_name\"]: role for role in roles if role[\"access_scope\"] == \"organization\"}\n    ws_roles_by_name = {role[\"display_name\"]: role for role in roles if role[\"access_scope\"] == \"workspace\"}\n\n    # Invite a user to the org and the new workspace, as an Editor.\n    # workspace_role_id is only allowed if RBAC is enabled (an enterprise feature).\n    new_user_email = \"<replace_me>\"\n    new_user_res = session.post(\n        f\"{orgs_path}/members\",\n        json={\n            \"email\": new_user_email,\n            \"role_id\": org_roles_by_name[\"Organization User\"][\"id\"],\n            \"workspace_ids\": [workspace_id],\n            \"workspace_role_id\": ws_roles_by_name[\"Editor\"][\"id\"],\n        },\n    )\n    new_user_res.raise_for_status()\n\n    # Add a user that already exists in the org to the new workspace, as a Viewer.\n    # workspace_role_id is only allowed if RBAC is enabled (an enterprise feature).\n    existing_user_email = \"<replace_me>\"\n    org_members_res = session.get(f\"{orgs_path}/members\")\n    org_members_res.raise_for_status()\n    org_members = org_members_res.json()\n    existing_org_member = next(\n        (member for member in org_members[\"members\"] if member[\"email\"] == existing_user_email), None\n    )\n    existing_user_res = session.post(\n        f\"{workspaces_path}/current/members\",\n        json={\n            \"user_id\": existing_org_member[\"user_id\"],\n            \"workspace_ids\": [workspace_id],\n            \"workspace_role_id\": ws_roles_by_name[\"Viewer\"][\"id\"],\n        },\n        headers=new_workspace_headers,\n    )\n    existing_user_res.raise_for_status()\n\n    # List all members of the workspace\n    members_res = session.get(f\"{workspaces_path}/current/members\", headers=new_workspace_headers)\n    members_res.raise_for_status()\n    members = members_res.json()\n    workspace_member = next(\n        (member for member in members[\"members\"] if member[\"email\"] == existing_user_email), None\n    )\n\n    # Update the user's workspace role to Admin (enterprise-only)\n    existing_user_id = workspace_member[\"id\"]\n    update_res = session.patch(\n        f\"{workspaces_path}/current/members/{existing_user_id}\",\n        json={\"role_id\": ws_roles_by_name[\"Admin\"][\"id\"]},\n        headers=new_workspace_headers,\n    )\n    update_res.raise_for_status()\n\n    # Update the user's organization role to Organization Admin\n    update_res = session.patch(\n        f\"{orgs_path}/members/{existing_org_member['id']}\",\n        json={\"role_id\": org_roles_by_name[\"Organization Admin\"][\"id\"]},\n    )\n    update_res.raise_for_status()\n\n    # Create a new Service key\n    api_key_res = session.post(\n        api_keys_path,\n        json={\"description\": \"my key\"},\n        headers=new_workspace_headers,\n    )\n    api_key_res.raise_for_status()\n    api_key_json = api_key_res.json()\n    api_key = api_key_json[\"key\"]\n\nif __name__ == \"__main__\":\n    main()\n```\n\n***\n\n<Callout icon=\"pen-to-square\" iconType=\"regular\">\n  [Edit the source of this page on GitHub.](https://github.com/langchain-ai/docs/edit/main/src/langsmith/manage-organization-by-api.mdx)\n</Callout>\n\n<Tip icon=\"terminal\" iconType=\"regular\">\n  [Connect these docs programmatically](/use-these-docs) to Claude, VSCode, and more via MCP for real-time answers.\n</Tip>",
  "content_length": 11433
}