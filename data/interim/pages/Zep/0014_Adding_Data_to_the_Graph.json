{
  "title": "Adding Data to the Graph",
  "source_url": null,
  "content": "## Overview\n\n<Warning>\n  Requests to add data to the same graph are completed sequentially to ensure the graph is built correctly, and processing may be slow for large datasets. Use [batch ingestion](#add-batch-data) when adding large datasets such as backfills or document collections.\n</Warning>\n\nIn addition to incorporating memory through chat history, Zep offers the capability to add data directly to the graph.\nZep supports three distinct data types: message, text, and JSON.\n\nThe message type is ideal for adding data in the form of chat messages that are not directly associated with a Zep [Thread's](/threads) chat history. This encompasses any communication with a designated speaker, such as emails or previous chat logs.\n\nThe text type is designed for raw text data without a specific speaker attribution. This category includes content from internal documents, wiki articles, or company handbooks. It's important to note that Zep does not process text directly from links or files.\n\nThe JSON type may be used to add any JSON document to Zep. This may include REST API responses or JSON-formatted business data.\n\nYou can add data to a graph by specifying a `graph_id`, or to a user graph by providing a `user_id`.\n\n## Adding Message Data\n\nHere's an example demonstrating how to add message data to the graph:\n\n<CodeBlocks>\n  ```python Python\n  from zep_cloud.client import Zep\n\n  client = Zep(\n      api_key=API_KEY,\n  )\n\n  message = \"Paul (user): I went to Eric Clapton concert last night\"\n\n  new_episode = client.graph.add(\n      user_id=\"user123\",    # Optional: You can use graph_id instead of user_id\n      type=\"message\",       # Specify type as \"message\"\n      data=message\n  )\n  ```\n\n  ```typescript TypeScript\n  import { ZepClient } from \"@getzep/zep-cloud\";\n\n  const client = new ZepClient({\n    apiKey: API_KEY,\n  });\n\n  const message = \"User: I really enjoy working with TypeScript and React\";\n\n  const newEpisode = await client.graph.add({\n      userId: \"user123\",  // Optional: You can use graphId instead of userId\n      type: \"message\",\n      data: message\n  });\n  ```\n\n  ```go Go\n  import (\n      \"context\"\n      \"log\"\n\n      \"github.com/getzep/zep-go/v3\"\n      zepclient \"github.com/getzep/zep-go/v3/client\"\n      \"github.com/getzep/zep-go/v3/option\"\n  )\n\n  client := zepclient.NewClient(\n      option.WithAPIKey(apiKey),\n  )\n\n  message := \"Paul (user): I went to Eric Clapton concert last night\"\n  userID := \"user123\"\n\n  newEpisode, err := client.Graph.Add(context.TODO(), &zep.AddDataRequest{\n      UserID: &userID,  // Optional: You can use GraphID instead of UserID\n      Type:   zep.GraphDataTypeMessage,\n      Data:   message,\n  })\n  if err != nil {\n      log.Fatalf(\"Failed to add message data: %v\", err)\n  }\n  ```\n</CodeBlocks>\n\n## Adding Text Data\n\nHere's an example demonstrating how to add text data to the graph:\n\n<CodeBlocks>\n  ```python Python\n  from zep_cloud.client import Zep\n\n  client = Zep(\n      api_key=API_KEY,\n  )\n\n  new_episode = client.graph.add(\n      user_id=\"user123\",  # Optional: You can use graph_id instead of user_id\n      type=\"text\",        # Specify type as \"text\"\n      data=\"The user is an avid fan of Eric Clapton\"\n  )\n  ```\n\n  ```typescript TypeScript\n  import { ZepClient } from \"@getzep/zep-cloud\";\n\n  const client = new ZepClient({\n    apiKey: API_KEY,\n  });\n\n  const newEpisode = await client.graph.add({\n      userId: \"user123\",  // Optional: You can use graphId instead of userId\n      type: \"text\",\n      data: \"The user is interested in machine learning and artificial intelligence\"\n  });\n  ```\n\n  ```go Go\n  import (\n      \"context\"\n      \"log\"\n\n      \"github.com/getzep/zep-go/v3\"\n      zepclient \"github.com/getzep/zep-go/v3/client\"\n      \"github.com/getzep/zep-go/v3/option\"\n  )\n\n  client := zepclient.NewClient(\n      option.WithAPIKey(apiKey),\n  )\n\n  userID := \"user123\"\n\n  newEpisode, err := client.Graph.Add(context.TODO(), &zep.AddDataRequest{\n      UserID: &userID,  // Optional: You can use GraphID instead of UserID\n      Type:   zep.GraphDataTypeText,\n      Data:   \"The user is an avid fan of Eric Clapton\",\n  })\n  if err != nil {\n      log.Fatalf(\"Failed to add text data: %v\", err)\n  }\n  ```\n</CodeBlocks>\n\n## Adding JSON Data\n\nHere's an example demonstrating how to add JSON data to the graph:\n\n<CodeBlocks>\n  ```python Python\n  from zep_cloud.client import Zep\n  import json\n\n  client = Zep(\n      api_key=API_KEY,\n  )\n\n  json_data = {\"name\": \"Eric Clapton\", \"age\": 78, \"genre\": \"Rock\"}\n  json_string = json.dumps(json_data)\n  new_episode = client.graph.add(\n      user_id=user_id,  # Optional: You can use graph_id instead of user_id\n      type=\"json\",\n      data=json_string,\n  )\n  ```\n\n  ```typescript TypeScript\n  import { ZepClient } from \"@getzep/zep-cloud\";\n\n  const client = new ZepClient({\n    apiKey: API_KEY,\n  });\n\n  const jsonString = '{\"name\": \"Eric Clapton\", \"age\": 78, \"genre\": \"Rock\"}';\n  const newEpisode = await client.graph.add({\n      userId: userId,  // Optional: You can use graphId instead of userId\n      type: \"json\",\n      data: jsonString,\n  });\n  ```\n\n  ```go Go\n  import (\n      \"context\"\n      \"encoding/json\"\n      \"log\"\n\n      \"github.com/getzep/zep-go/v3\"\n      zepclient \"github.com/getzep/zep-go/v3/client\"\n      \"github.com/getzep/zep-go/v3/option\"\n  )\n\n  client := zepclient.NewClient(\n      option.WithAPIKey(apiKey),\n  )\n\n  jsonData := map[string]interface{}{\n      \"name\":  \"Eric Clapton\",\n      \"age\":   78,\n      \"genre\": \"Rock\",\n  }\n  jsonBytes, err := json.Marshal(jsonData)\n  if err != nil {\n      log.Fatalf(\"Failed to marshal JSON: %v\", err)\n  }\n  jsonString := string(jsonBytes)\n\n  userID := \"user123\"\n\n  newEpisode, err := client.Graph.Add(context.TODO(), &zep.AddDataRequest{\n      UserID: &userID,  // Optional: You can use GraphID instead of UserID\n      Type:   zep.GraphDataTypeJSON,\n      Data:   jsonString,\n  })\n  if err != nil {\n      log.Fatalf(\"Failed to add JSON data: %v\", err)\n  }\n  ```\n</CodeBlocks>\n\n## Data Size Limit and Chunking\n\nThe `graph.add` endpoint has a data size limit of 10,000 characters when adding data to the graph. If you need to add a document which is more than 10,000 characters, we recommend chunking the document as well as using Anthropic's contextualized retrieval technique. We have an example of this [here](https://blog.getzep.com/building-a-russian-election-interference-knowledge-graph/#:~:text=Chunking%20articles%20into%20multiple%20Episodes%20improved%20our%20results%20compared%20to%20treating%20each%20article%20as%20a%20single%20Episode.%20This%20approach%20generated%20more%20detailed%20knowledge%20graphs%20with%20richer%20node%20and%20edge%20extraction%2C%20while%20single%2DEpisode%20processing%20produced%20only%20high%2Dlevel%2C%20sparse%20graphs.). This example uses Graphiti, but the same patterns apply to Zep as well.\n\nAdditionally, we recommend using relatively small chunk sizes, so that Zep is able to capture all of the entities and relationships within a chunk. Using a larger chunk size may result in some entities and relationships not being captured.\n\n## Adding Custom Fact/Node Triplets\n\nYou can also add manually specified fact/node triplets to the graph. You need only specify the fact, the target node name, and the source node name. Zep will then create a new corresponding edge and nodes, or use an existing edge/nodes if they exist and seem to represent the same nodes or edge you send as input. And if this new fact invalidates an existing fact, it will mark the existing fact as invalid and add the new fact triplet.\n\nThe `add_fact_triple` method returns a `task_id` that can be used to track the processing status of the operation. See the [Check Data Ingestion Status](/cookbook/check-data-ingestion-status#checking-operation-status-with-task-polling) recipe for how to poll task status.\n\n<CodeBlocks>\n  ```python Python\n  from zep_cloud.client import Zep\n\n  client = Zep(\n      api_key=API_KEY,\n  )\n\n  result = client.graph.add_fact_triple(\n      user_id=user_id,  # Optional: You can use graph_id instead of user_id\n      fact=\"Paul met Eric\",\n      fact_name=\"MET\",\n      target_node_name=\"Eric Clapton\",\n      source_node_name=\"Paul\",\n  )\n\n  # The result includes a task_id for tracking processing status\n  task_id = result.task_id\n  print(f\"Fact triple task ID: {task_id}\")\n  ```\n\n  ```typescript TypeScript\n  import { ZepClient } from \"@getzep/zep-cloud\";\n\n  const client = new ZepClient({\n    apiKey: API_KEY,\n  });\n\n  const result = await client.graph.addFactTriple({\n    userId: userId,  // Optional: You can use graphId instead of userId\n    fact: \"Paul met Eric\",\n    factName: \"MET\",\n    targetNodeName: \"Eric Clapton\",\n    sourceNodeName: \"Paul\",\n  });\n\n  // The result includes a task_id for tracking processing status\n  const taskId = result.taskId;\n  console.log(`Fact triple task ID: ${taskId}`);\n  ```\n\n  ```go Go\n  import (\n      \"context\"\n      \"log\"\n\n      \"github.com/getzep/zep-go/v3\"\n      zepclient \"github.com/getzep/zep-go/v3/client\"\n      \"github.com/getzep/zep-go/v3/option\"\n  )\n\n  client := zepclient.NewClient(\n      option.WithAPIKey(apiKey),\n  )\n\n  userID := \"user123\"\n  sourceNodeName := \"Paul\"\n\n  result, err := client.Graph.AddFactTriple(context.TODO(), &v3.AddTripleRequest{\n      UserID:         &userID,  // Optional: You can use GraphID instead of UserID\n      Fact:           \"Paul met Eric\",\n      FactName:       \"MET\",\n      TargetNodeName: \"Eric Clapton\",\n      SourceNodeName: &sourceNodeName,\n  })\n  if err != nil {\n      log.Fatalf(\"Failed to add fact triple: %v\", err)\n  }\n\n  // The result includes a task_id for tracking processing status\n  taskID := result.TaskID\n  log.Printf(\"Fact triple task ID: %s\", *taskID)\n  ```\n</CodeBlocks>\n\nYou can also specify the node summaries, edge temporal data, and UUIDs. See the [associated SDK reference](/sdk-reference/graph/add-fact-triple).\n\n## Add Batch Data\n\nYou can add data in batches for faster processing when working with large datasets. To learn more about batch processing and implementation details, see [Adding Batch Data](adding-batch-data).\n\n## Cloning Graphs\n\nThe `graph.clone` method allows you to create complete copies of graphs with new identifiers. This is useful for scenarios like creating test copies of user data, migrating user graphs to new identifiers, or setting up template graphs for new users.\n\nThe clone operation returns a `task_id` that can be used to track the cloning progress. See the [Check Data Ingestion Status](/cookbook/check-data-ingestion-status#checking-operation-status-with-task-polling) recipe for how to poll task status.\n\n<Note>\n  The target graph must not exist - they will be created as part of the cloning operation. If no target ID is provided, one will be auto-generated and returned in the response.\n</Note>\n\n<Tabs>\n  <Tab title=\"User Graph\">\n    <CodeBlocks>\n      ```python Python\n      from zep_cloud.client import Zep\n\n      client = Zep(\n          api_key=API_KEY,\n      )\n\n      # Clone a user graph to a new user ID\n      result = client.graph.clone(\n          source_user_id=\"user_123\",\n          target_user_id=\"user_123_copy\"  # Optional - will be auto-generated if not provided\n      )\n\n      print(f\"Cloned graph to user: {result.user_id}\")\n      print(f\"Clone task ID: {result.task_id}\")\n      ```\n\n      ```typescript TypeScript\n      import { ZepClient } from \"@getzep/zep-cloud\";\n\n      const client = new ZepClient({\n        apiKey: API_KEY,\n      });\n\n      // Clone a user graph to a new user ID\n      const result = await client.graph.clone({\n          sourceUserId: \"user_123\",\n          targetUserId: \"user_123_copy\"  // Optional - will be auto-generated if not provided\n      });\n\n      console.log(`Cloned graph to user: ${result.userId}`);\n      console.log(`Clone task ID: ${result.taskId}`);\n      ```\n\n      ```go Go\n      import (\n          \"context\"\n          \"fmt\"\n          \"log\"\n\n          \"github.com/getzep/zep-go/v3\"\n          zepclient \"github.com/getzep/zep-go/v3/client\"\n          \"github.com/getzep/zep-go/v3/option\"\n      )\n\n      client := zepclient.NewClient(\n          option.WithAPIKey(apiKey),\n      )\n\n      // Clone a user graph to a new user ID\n      sourceUserID := \"user_123\"\n      targetUserID := \"user_123_copy\"  // Optional - will be auto-generated if not provided\n\n      result, err := client.Graph.Clone(context.TODO(), &v3.CloneGraphRequest{\n          SourceUserID: &sourceUserID,\n          TargetUserID: &targetUserID,\n      })\n      if err != nil {\n          log.Fatalf(\"Failed to clone graph: %v\", err)\n      }\n\n      fmt.Printf(\"Cloned graph to user: %s\\n\", *result.UserID)\n      fmt.Printf(\"Clone task ID: %s\\n\", *result.TaskID)\n      ```\n    </CodeBlocks>\n  </Tab>\n\n  <Tab title=\"Standalone Graph\">\n    <CodeBlocks>\n      ```python Python\n      from zep_cloud.client import Zep\n\n      client = Zep(\n          api_key=API_KEY,\n      )\n\n      # Clone a graph to a new graph ID\n      result = client.graph.clone(\n          source_graph_id=\"graph_456\",\n          target_graph_id=\"graph_456_copy\"  # Optional - will be auto-generated if not provided\n      )\n\n      print(f\"Cloned graph to graph: {result.graph_id}\")\n      print(f\"Clone task ID: {result.task_id}\")\n      ```\n\n      ```typescript TypeScript\n      import { ZepClient } from \"@getzep/zep-cloud\";\n\n      const client = new ZepClient({\n        apiKey: API_KEY,\n      });\n\n      // Clone a graph to a new graph ID\n      const result = await client.graph.clone({\n          sourceGraphId: \"graph_456\",\n          targetGraphId: \"graph_456_copy\"  // Optional - will be auto-generated if not provided\n      });\n\n      console.log(`Cloned graph to graph: ${result.graphId}`);\n      console.log(`Clone task ID: ${result.taskId}`);\n      ```\n\n      ```go Go\n      import (\n          \"context\"\n          \"fmt\"\n          \"log\"\n\n          \"github.com/getzep/zep-go/v3\"\n          zepclient \"github.com/getzep/zep-go/v3/client\"\n          \"github.com/getzep/zep-go/v3/option\"\n      )\n\n      client := zepclient.NewClient(\n          option.WithAPIKey(apiKey),\n      )\n\n      // Clone a graph to a new graph ID\n      sourceGraphID := \"graph_456\"\n      targetGraphID := \"graph_456_copy\"  // Optional - will be auto-generated if not provided\n\n      result, err := client.Graph.Clone(context.TODO(), &v3.CloneGraphRequest{\n          SourceGraphID: &sourceGraphID,\n          TargetGraphID: &targetGraphID,\n      })\n      if err != nil {\n          log.Fatalf(\"Failed to clone graph: %v\", err)\n      }\n\n      fmt.Printf(\"Cloned graph to graph: %s\\n\", *result.GraphID)\n      fmt.Printf(\"Clone task ID: %s\\n\", *result.TaskID)\n      ```\n    </CodeBlocks>\n  </Tab>\n</Tabs>\n\n### Key Behaviors and Limitations\n\n* **Target Requirements**: The target user or graph must not exist and will be created during the cloning operation\n* **Auto-generation**: If no target ID is provided, Zep will auto-generate one and return it in the response\n* **Node Modification**: The central user entity node in the cloned graph is updated with the new user ID, and all references in the node summary are updated accordingly\n\n## Managing Your Data on the Graph\n\nThe `graph.add` method returns the [episode](/graphiti/graphiti/adding-episodes) that was created in the graph from adding that data. You can use this to maintain a mapping between your data and its corresponding episode in the graph and to delete specific data from the graph using the [delete episode](/deleting-data-from-the-graph#delete-an-episode) method.",
  "content_length": 15465
}