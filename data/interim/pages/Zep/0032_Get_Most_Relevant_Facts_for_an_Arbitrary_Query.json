{
  "title": "Get Most Relevant Facts for an Arbitrary Query",
  "source_url": null,
  "content": "In this recipe, we demonstrate how to retrieve the most relevant facts from the knowledge graph using an arbitrary search query.\n\nFirst, we perform a [search](/searching-the-graph) on the knowledge graph using a sample query:\n\n<CodeBlocks>\n  ```python\n  from zep_cloud.client import Zep\n\n  zep_client = Zep(api_key=API_KEY)\n  results = zep_client.graph.search(user_id=\"some user_id\", query=\"Some search query\", scope=\"edges\")\n  ```\n\n  ```typescript\n  import { ZepClient } from \"@getzep/zep-cloud\";\n\n  const client = new ZepClient({ apiKey: process.env.ZEP_API_KEY || \"\" });\n  const results = await client.graph.search({\n      userId: \"some user_id\",\n      query: \"Some search query\",\n      scope: \"edges\"\n  });\n  ```\n\n  ```go\n  package main\n\n  import (\n      \"context\"\n      \"fmt\"\n      \"log\"\n      \"os\"\n\n      \"github.com/getzep/zep-go/v3\"\n      zepclient \"github.com/getzep/zep-go/v3/client\"\n      \"github.com/getzep/zep-go/v3/option\"\n  )\n\n  func main() {\n      ctx := context.Background()\n\n      client := zepclient.NewClient(\n          option.WithAPIKey(os.Getenv(\"ZEP_API_KEY\")),\n      )\n\n      results, err := client.Graph.Search(ctx, &zep.GraphSearchQuery{\n          UserID: zep.String(\"some user_id\"),\n          Query:  \"Some search query\",\n          Scope:  zep.GraphSearchScopeEdges.Ptr(),\n      })\n      if err != nil {\n          log.Fatalf(\"Error: %v\", err)\n      }\n  ```\n</CodeBlocks>\n\nThen, we get the edges from the search results and construct our fact list. We also include the temporal validity data to each fact string:\n\n<CodeBlocks>\n  ```python\n  # Build list of formatted facts\n  relevant_edges = results.edges\n  formatted_facts = []\n  for edge in relevant_edges:\n      valid_at = edge.valid_at if edge.valid_at is not None else \"date unknown\"\n      invalid_at = edge.invalid_at if edge.invalid_at is not None else \"present\"\n      formatted_fact = f\"{edge.fact} (Date range: {valid_at} - {invalid_at})\"\n      formatted_facts.append(formatted_fact)\n\n  # Print the results\n  print(\"\\nFound facts:\")\n  for fact in formatted_facts:\n      print(f\"- {fact}\")\n  ```\n\n  ```typescript\n  // Build list of formatted facts\n  const relevantEdges = results.edges || [];\n  const formattedFacts: string[] = [];\n\n  for (const edge of relevantEdges) {\n      const validAt = edge.validAt ?? \"date unknown\";\n      const invalidAt = edge.invalidAt ?? \"present\";\n      const formattedFact = `${edge.fact} (Date range: ${validAt} - ${invalidAt})`;\n      formattedFacts.push(formattedFact);\n  }\n\n  // Print the results\n  console.log(\"\\nFound facts:\");\n  for (const fact of formattedFacts) {\n      console.log(`- ${fact}`);\n  }\n  ```\n\n  ```go\n      // Build list of formatted facts\n      relevantEdges := results.Edges\n      var formattedFacts []string\n\n      for _, edge := range relevantEdges {\n          validAt := \"date unknown\"\n          if edge.ValidAt != nil {\n              validAt = *edge.ValidAt\n          }\n\n          invalidAt := \"present\"\n          if edge.InvalidAt != nil {\n              invalidAt = *edge.InvalidAt\n          }\n\n          formattedFact := fmt.Sprintf(\"%s (Date range: %s - %s)\", edge.Fact, validAt, invalidAt)\n          formattedFacts = append(formattedFacts, formattedFact)\n      }\n\n      // Print the results\n      fmt.Println(\"\\nFound facts:\")\n      for _, fact := range formattedFacts {\n          fmt.Printf(\"- %s\\n\", fact)\n      }\n  }\n  ```\n</CodeBlocks>\n\nWe demonstrated how to retrieve the most relevant facts for an arbitrary query using the Zep client. Adjust the query and parameters as needed to tailor the search for your specific use case.",
  "content_length": 3580
}