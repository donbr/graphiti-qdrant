{
  "title": "Migrating to Claude 4.5",
  "source_url": "https://docs.claude.com/en/docs/about-claude/models/migrating-to-claude-4",
  "content": "This guide covers two key migration paths to Claude 4.5 models:\n\n* **Claude Sonnet 3.7 → Claude Sonnet 4.5**: Our most intelligent model with best-in-class reasoning, coding, and long-running agent capabilities\n* **Claude Haiku 3.5 → Claude Haiku 4.5**: Our fastest and most intelligent Haiku model with near-frontier performance for real-time applications and high-volume intelligent processing\n\nBoth migrations involve breaking changes that require updates to your implementation. This guide will walk you through each migration path with step-by-step instructions and clearly marked breaking changes.\n\nBefore starting your migration, we recommend reviewing [What's new in Claude 4.5](/en/docs/about-claude/models/whats-new-claude-4-5) to understand the new features and capabilities available in these models, including extended thinking, context awareness, and behavioral improvements.\n\n## Migrating from Claude Sonnet 3.7 to Claude Sonnet 4.5\n\nClaude Sonnet 4.5 is our most intelligent model, offering best-in-class performance for reasoning, coding, and long-running autonomous agents. This migration includes several breaking changes that require updates to your implementation.\n\n### Migration steps\n\n1. **Update your model name:**\n   ```python  theme={null}\n   # Before (Claude Sonnet 3.7)\n   model=\"claude-3-7-sonnet-20250219\"\n\n   # After (Claude Sonnet 4.5)\n   model=\"claude-sonnet-4-5-20250929\"\n   ```\n\n2. **Update sampling parameters**\n\n   <Warning>\n     This is a breaking change from the Claude Sonnet 3.7.\n   </Warning>\n\n   Use only `temperature` OR `top_p`, not both:\n\n   ```python  theme={null}\n   # Before (Claude Sonnet 3.7) - This will error in Sonnet 4.5\n   response = client.messages.create(\n       model=\"claude-3-7-sonnet-20250219\",\n       temperature=0.7,\n       top_p=0.9,  # Cannot use both\n       ...\n   )\n\n   # After (Claude Sonnet 4.5)\n   response = client.messages.create(\n       model=\"claude-sonnet-4-5-20250929\",\n       temperature=0.7,  # Use temperature OR top_p, not both\n       ...\n   )\n   ```\n\n3. **Handle the new `refusal` stop reason**\n\n   Update your application to [handle `refusal` stop reasons](/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals):\n\n   ```python  theme={null}\n   response = client.messages.create(...)\n\n   if response.stop_reason == \"refusal\":\n       # Handle refusal appropriately\n       pass\n   ```\n\n4. **Update text editor tool (if applicable)**\n\n   <Warning>\n     This is a breaking change from the Claude Sonnet 3.7.\n   </Warning>\n\n   Update to `text_editor_20250728` (type) and `str_replace_based_edit_tool` (name). Remove any code using the `undo_edit` command.\n\n   ```python  theme={null}\n   # Before (Claude Sonnet 3.7)\n   tools=[{\"type\": \"text_editor_20250124\", \"name\": \"str_replace_editor\"}]\n\n   # After (Claude Sonnet 4.5)\n   tools=[{\"type\": \"text_editor_20250728\", \"name\": \"str_replace_based_edit_tool\"}]\n   ```\n\n   See [Text editor tool documentation](/en/docs/agents-and-tools/tool-use/text-editor-tool) for details.\n\n5. **Update code execution tool (if applicable)**\n\n   Upgrade to `code_execution_20250825`. The legacy version `code_execution_20250522` still works but is not recommended. See [Code execution tool documentation](/en/docs/agents-and-tools/tool-use/code-execution-tool#upgrade-to-latest-tool-version) for migration instructions.\n\n6. **Remove token-efficient tool use beta header**\n\n   [Token-efficient tool use](/en/docs/agents-and-tools/tool-use/token-efficient-tool-use) is a beta feature that only works with Claude 3.7 Sonnet. All Claude 4 models have built-in token-efficient tool use, so you should no longer include the beta header.\n\n   Remove the `token-efficient-tools-2025-02-19` [beta header](/en/api/beta-headers) from your requests:\n\n   ```python  theme={null}\n   # Before (Claude Sonnet 3.7)\n   client.messages.create(\n       model=\"claude-3-7-sonnet-20250219\",\n       betas=[\"token-efficient-tools-2025-02-19\"],  # Remove this\n       ...\n   )\n\n   # After (Claude Sonnet 4.5)\n   client.messages.create(\n       model=\"claude-sonnet-4-5-20250929\",\n       # No token-efficient-tools beta header\n       ...\n   )\n   ```\n\n7. **Remove extended output beta header**\n\n   The `output-128k-2025-02-19` [beta header](/en/api/beta-headers) for extended output is only available in Claude Sonnet 3.7.\n\n   Remove this header from your requests:\n\n   ```python  theme={null}\n   # Before (Claude Sonnet 3.7)\n   client.messages.create(\n       model=\"claude-3-7-sonnet-20250219\",\n       betas=[\"output-128k-2025-02-19\"],  # Remove this\n       ...\n   )\n\n   # After (Claude Sonnet 4.5)\n   client.messages.create(\n       model=\"claude-sonnet-4-5-20250929\",\n       # No output-128k beta header\n       ...\n   )\n   ```\n\n8. **Update your prompts for behavioral changes**\n\n   Claude Sonnet 4.5 has a more concise, direct communication style and requires explicit direction. Review [Claude 4 prompt engineering best practices](/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices) for optimization guidance.\n\n9. **Consider enabling extended thinking for complex tasks**\n\n   Enable [extended thinking](/en/docs/build-with-claude/extended-thinking) for significant performance improvements on coding and reasoning tasks (disabled by default):\n\n   ```python  theme={null}\n   response = client.messages.create(\n       model=\"claude-sonnet-4-5-20250929\",\n       max_tokens=16000,\n       thinking={\"type\": \"enabled\", \"budget_tokens\": 10000},\n       messages=[...]\n   )\n   ```\n\n   <Note>\n     Extended thinking impacts [prompt caching](/en/docs/build-with-claude/prompt-caching#caching-with-thinking-blocks) efficiency.\n   </Note>\n\n10. **Test your implementation**\n\nTest in a development environment before deploying to production to ensure all breaking changes are properly handled.\n\n### Sonnet 3.7 → 4.5 migration checklist\n\n* [ ] Update model ID to `claude-sonnet-4-5-20250929`\n* [ ] **BREAKING**: Update sampling parameters to use only `temperature` OR `top_p`, not both\n* [ ] Handle new `refusal` stop reason in your application\n* [ ] **BREAKING**: Update text editor tool to `text_editor_20250728` and `str_replace_based_edit_tool` (if applicable)\n* [ ] **BREAKING**: Remove any code using the `undo_edit` command (if applicable)\n* [ ] Update code execution tool to `code_execution_20250825` (if applicable)\n* [ ] Remove `token-efficient-tools-2025-02-19` beta header (if applicable)\n* [ ] Remove `output-128k-2025-02-19` beta header (if applicable)\n* [ ] Review and update prompts following [Claude 4 best practices](/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices)\n* [ ] Consider enabling extended thinking for complex reasoning tasks\n* [ ] Handle `model_context_window_exceeded` stop reason (Sonnet 4.5 specific)\n* [ ] Consider enabling memory tool for long-running agents (beta)\n* [ ] Consider using automatic tool call clearing for context editing (beta)\n* [ ] Test in development environment before production deployment\n\n### Features removed from Claude Sonnet 3.7\n\n* **Token-efficient tool use**: The `token-efficient-tools-2025-02-19` beta header only works with Claude 3.7 Sonnet and is not supported in Claude 4 models (see step 6)\n* **Extended output**: The `output-128k-2025-02-19` beta header is not supported (see step 7)\n\nBoth headers can be included in Claude 4 requests but will have no effect.\n\n## Migrating from Claude Haiku 3.5 to Claude Haiku 4.5\n\nClaude Haiku 4.5 is our fastest and most intelligent Haiku model with near-frontier performance, delivering premium model quality with real-time performance for interactive applications and high-volume intelligent processing. This migration includes several breaking changes that require updates to your implementation.\n\nFor a complete overview of new capabilities, see [What's new in Claude 4.5](/en/docs/about-claude/models/whats-new-claude-4-5#key-improvements-in-haiku-4-5-over-haiku-3-5).\n\n<Note>\n  Haiku 4.5 pricing $1 per million input tokens, $5 per million output tokens. See [Claude pricing](/en/docs/about-claude/pricing) for details.\n</Note>\n\n### Migration steps\n\n1. **Update your model name:**\n   ```python  theme={null}\n   # Before (Haiku 3.5)\n   model=\"claude-3-5-haiku-20241022\"\n\n   # After (Haiku 4.5)\n   model=\"claude-haiku-4-5-20251001\"\n   ```\n\n2. **Update tool versions (if applicable)**\n\n   <Warning>\n     This is a breaking change from the Claude Haiku 3.5.\n   </Warning>\n\n   Haiku 4.5 only supports the latest tool versions:\n\n   ```python  theme={null}\n   # Before (Haiku 3.5)\n   tools=[{\"type\": \"text_editor_20250124\", \"name\": \"str_replace_editor\"}]\n\n   # After (Haiku 4.5)\n   tools=[{\"type\": \"text_editor_20250728\", \"name\": \"str_replace_based_edit_tool\"}]\n   ```\n\n   * **Text editor**: Use `text_editor_20250728` and `str_replace_based_edit_tool`\n   * **Code execution**: Use `code_execution_20250825`\n   * Remove any code using the `undo_edit` command\n\n3. **Update sampling parameters**\n\n   <Warning>\n     This is a breaking change from the Claude Haiku 3.5.\n   </Warning>\n\n   Use only `temperature` OR `top_p`, not both:\n\n   ```python  theme={null}\n   # Before (Haiku 3.5) - This will error in Haiku 4.5\n   response = client.messages.create(\n       model=\"claude-3-5-haiku-20241022\",\n       temperature=0.7,\n       top_p=0.9,  # Cannot use both\n       ...\n   )\n\n   # After (Haiku 4.5)\n   response = client.messages.create(\n       model=\"claude-haiku-4-5-20251001\",\n       temperature=0.7,  # Use temperature OR top_p, not both\n       ...\n   )\n   ```\n\n4. **Review new rate limits**\n\n   Haiku 4.5 has separate rate limits from Haiku 3.5. See [Rate limits documentation](/en/api/rate-limits) for details.\n\n5. **Handle the new `refusal` stop reason**\n\n   Update your application to [handle refusal stop reasons](/en/docs/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals).\n\n6. **Consider enabling extended thinking for complex tasks**\n\n   Enable [extended thinking](/en/docs/build-with-claude/extended-thinking) for significant performance improvements on coding and reasoning tasks (disabled by default):\n\n   ```python  theme={null}\n   response = client.messages.create(\n       model=\"claude-haiku-4-5-20251001\",\n       max_tokens=16000,\n       thinking={\"type\": \"enabled\", \"budget_tokens\": 5000},\n       messages=[...]\n   )\n   ```\n\n   <Note>\n     Extended thinking impacts [prompt caching](/en/docs/build-with-claude/prompt-caching#caching-with-thinking-blocks) efficiency.\n   </Note>\n\n7. **Explore new capabilities**\n\n   See [What's new in Claude 4.5](/en/docs/about-claude/models/whats-new-claude-4-5#key-improvements-in-haiku-4-5-over-haiku-3-5) for details on context awareness, increased output capacity (64K tokens), higher intelligence, and improved speed.\n\n8. **Test your implementation**\n\n   Test in a development environment before deploying to production to ensure all breaking changes are properly handled.\n\n### Haiku 3.5 → 4.5 migration checklist\n\n* [ ] Update model ID to `claude-haiku-4-5-20251001`\n* [ ] **BREAKING**: Update tool versions to latest (e.g., `text_editor_20250728`, `code_execution_20250825`) - legacy versions not supported\n* [ ] **BREAKING**: Remove any code using the `undo_edit` command (if applicable)\n* [ ] **BREAKING**: Update sampling parameters to use only `temperature` OR `top_p`, not both\n* [ ] Review and adjust for new rate limits (separate from Haiku 3.5)\n* [ ] Handle new `refusal` stop reason in your application\n* [ ] Consider enabling extended thinking for complex reasoning tasks (new capability)\n* [ ] Leverage context awareness for better token management in long sessions\n* [ ] Prepare for larger responses (max output increased from 8K to 64K tokens)\n* [ ] Review and update prompts following [Claude 4 best practices](/en/docs/build-with-claude/prompt-engineering/claude-4-best-practices)\n* [ ] Test in development environment before production deployment\n\n## Choosing between Sonnet 4.5 and Haiku 4.5\n\nBoth Claude Sonnet 4.5 and Claude Haiku 4.5 are powerful Claude 4 models with different strengths:\n\n### Choose Claude Sonnet 4.5 (most intelligent) for:\n\n* **Complex reasoning and analysis**: Best-in-class intelligence for sophisticated tasks\n* **Long-running autonomous agents**: Superior performance for agents working independently for extended periods\n* **Advanced coding tasks**: Our strongest coding model with advanced planning and security engineering\n* **Large context workflows**: Enhanced context management with memory tool and context editing capabilities\n* **Tasks requiring maximum capability**: When intelligence and accuracy are the top priorities\n\n### Choose Claude Haiku 4.5 (fastest and most intelligent Haiku) for:\n\n* **Real-time applications**: Fast response times for interactive user experiences with near-frontier performance\n* **High-volume intelligent processing**: Cost-effective intelligence at scale with improved speed\n* **Cost-sensitive deployments**: Near-frontier performance at lower price points\n* **Sub-agent architectures**: Fast, intelligent agents for multi-agent systems\n* **Computer use at scale**: Cost-effective autonomous desktop and browser automation\n* **Tasks requiring speed**: When low latency is critical while maintaining near-frontier intelligence\n\n### Extended thinking recommendations\n\nClaude 4 models, particularly Sonnet and Haiku 4.5, show significant performance improvements when using [extended thinking](/en/docs/build-with-claude/extended-thinking) for coding and complex reasoning tasks. Extended thinking is **disabled by default** but we recommend enabling it for demanding work.\n\n**Important**: Extended thinking impacts [prompt caching](/en/docs/build-with-claude/prompt-caching#caching-with-thinking-blocks) efficiency. When non-tool-result content is added to a conversation, thinking blocks are stripped from cache, which can increase costs in multi-turn conversations. We recommend enabling thinking when the performance benefits outweigh the caching trade-off.\n\n## Other migration scenarios\n\nThe primary migration paths covered above (Sonnet 3.7 → 4.5 and Haiku 3.5 → 4.5) represent the most common upgrades. However, you may be migrating from other Claude models to Claude 4.5. This section covers those scenarios.\n\n### Migrating from Claude Sonnet 4 → Sonnet 4.5\n\n**Breaking change**: Cannot specify both `temperature` and `top_p` in the same request.\n\nAll other API calls will work without modification. Update your model ID and adjust sampling parameters if needed:\n\n```python  theme={null}\n# Before (Claude Sonnet 4)\nmodel=\"claude-sonnet-4-20250514\"\n\n# After (Claude Sonnet 4.5)\nmodel=\"claude-sonnet-4-5-20250929\"\n```\n\n### Migrating from Claude Opus 4.1 → Sonnet 4.5\n\n**No breaking changes.** All API calls will work without modification.\n\nSimply update your model ID:\n\n```python  theme={null}\n# Before (Claude Opus 4.1)\nmodel=\"claude-opus-4-1-20250805\"\n\n# After (Claude Sonnet 4.5)\nmodel=\"claude-sonnet-4-5-20250929\"\n```\n\nClaude Sonnet 4.5 is our most intelligent model with best-in-class reasoning, coding, and long-running agent capabilities. It offers superior performance compared to Opus 4.1 for most use cases.\n\n## Need help?\n\n* Check our [API documentation](/en/api/overview) for detailed specifications\n* Review [model capabilities](/en/docs/about-claude/models/overview) for performance comparisons\n* Review [API release notes](/en/release-notes/api) for API updates\n* Contact support if you encounter any issues during migration",
  "content_length": 15426
}