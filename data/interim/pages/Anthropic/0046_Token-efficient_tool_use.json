{
  "title": "Token-efficient tool use",
  "source_url": "https://docs.claude.com/en/docs/agents-and-tools/tool-use/token-efficient-tool-use",
  "content": "Starting with Claude Sonnet 3.7, Claude is capable of calling tools in a token-efficient manner. Requests save an average of 14% in output tokens, up to 70%, which also reduces latency. Exact token reduction and latency improvements depend on the overall response shape and size.\n\n<Info>\n  Token-efficient tool use is a beta feature that **only works with Claude 3.7 Sonnet**. To use this beta feature, add the beta header `token-efficient-tools-2025-02-19` to a tool use request. This header has no effect on other Claude models.\n\n  All [Claude 4 models](/en/docs/about-claude/models/overview) support token-efficient tool use by default. No beta header is needed.\n</Info>\n\n<Warning>\n  Token-efficient tool use does not currently work with [`disable_parallel_tool_use`](/en/docs/agents-and-tools/tool-use/implement-tool-use).\n</Warning>\n\nHere's an example of how to use token-efficient tools with the API in Claude Sonnet 3.7:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl https://api.anthropic.com/v1/messages \\\n    -H \"content-type: application/json\" \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: token-efficient-tools-2025-02-19\" \\\n    -d '{\n      \"model\": \"claude-3-7-sonnet-20250219\",\n      \"max_tokens\": 1024,\n      \"tools\": [\n        {\n          \"name\": \"get_weather\",\n          \"description\": \"Get the current weather in a given location\",\n          \"input_schema\": {\n            \"type\": \"object\",\n            \"properties\": {\n              \"location\": {\n                \"type\": \"string\",\n                \"description\": \"The city and state, e.g. San Francisco, CA\"\n              }\n            },\n            \"required\": [\n              \"location\"\n            ]\n          }\n        }\n      ],\n      \"messages\": [\n        {\n          \"role\": \"user\",\n          \"content\": \"Tell me the weather in San Francisco.\"\n        }\n      ]\n    }' | jq '.usage'\n  ```\n\n  ```Python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n\n  response = client.beta.messages.create(\n      max_tokens=1024,\n      model=\"claude-3-7-sonnet-20250219\",\n      tools=[{\n        \"name\": \"get_weather\",\n        \"description\": \"Get the current weather in a given location\",\n        \"input_schema\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"location\": {\n              \"type\": \"string\",\n              \"description\": \"The city and state, e.g. San Francisco, CA\"\n            }\n          },\n          \"required\": [\n            \"location\"\n          ]\n        }\n      }],\n      messages=[{\n        \"role\": \"user\",\n        \"content\": \"Tell me the weather in San Francisco.\"\n      }],\n      betas=[\"token-efficient-tools-2025-02-19\"]\n  )\n\n  print(response.usage)\n  ```\n\n  ```TypeScript TypeScript theme={null}\n  import Anthropic from '@anthropic-ai/sdk';\n\n  const anthropic = new Anthropic();\n\n  const message = await anthropic.beta.messages.create({\n    model: \"claude-3-7-sonnet-20250219\",\n    max_tokens: 1024,\n    tools: [{\n      name: \"get_weather\",\n      description: \"Get the current weather in a given location\",\n      input_schema: {\n        type: \"object\",\n        properties: {\n          location: {\n            type: \"string\",\n            description: \"The city and state, e.g. San Francisco, CA\"\n          }\n        },\n        required: [\"location\"]\n      }\n    }],\n    messages: [{ \n      role: \"user\", \n      content: \"Tell me the weather in San Francisco.\" \n    }],\n    betas: [\"token-efficient-tools-2025-02-19\"]\n  });\n\n  console.log(message.usage);\n  ```\n\n  ```Java Java theme={null}\n  import java.util.List;\n  import java.util.Map;\n\n  import com.anthropic.client.AnthropicClient;\n  import com.anthropic.client.okhttp.AnthropicOkHttpClient;\n  import com.anthropic.core.JsonValue;\n  import com.anthropic.models.beta.messages.BetaMessage;\n  import com.anthropic.models.beta.messages.BetaTool;\n  import com.anthropic.models.beta.messages.MessageCreateParams;\n\n  import static com.anthropic.models.beta.AnthropicBeta.TOKEN_EFFICIENT_TOOLS_2025_02_19;\n\n  public class TokenEfficientToolsExample {\n\n      public static void main(String[] args) {\n          AnthropicClient client = AnthropicOkHttpClient.fromEnv();\n\n          BetaTool.InputSchema schema = BetaTool.InputSchema.builder()\n                  .properties(JsonValue.from(Map.of(\n                          \"location\",\n                          Map.of(\n                                  \"type\", \"string\",\n                                  \"description\", \"The city and state, e.g. San Francisco, CA\"\n                          )\n                  )))\n                  .putAdditionalProperty(\"required\", JsonValue.from(List.of(\"location\")))\n                  .build();\n\n          MessageCreateParams params = MessageCreateParams.builder()\n                  .model(\"claude-3-7-sonnet-20250219\")\n                  .maxTokens(1024)\n                  .betas(List.of(TOKEN_EFFICIENT_TOOLS_2025_02_19))\n                  .addTool(BetaTool.builder()\n                          .name(\"get_weather\")\n                          .description(\"Get the current weather in a given location\")\n                          .inputSchema(schema)\n                          .build())\n                  .addUserMessage(\"Tell me the weather in San Francisco.\")\n                  .build();\n\n          BetaMessage message = client.beta().messages().create(params);\n          System.out.println(message.usage());\n      }\n  }\n  ```\n</CodeGroup>\n\nThe above request should, on average, use fewer input and output tokens than a normal request. To confirm this, try making the same request but remove `token-efficient-tools-2025-02-19` from the beta headers list.\n\n<Tip>\n  To keep the benefits of prompt caching, use the beta header consistently for requests you'd like to cache. If you selectively use it, prompt caching will fail.\n</Tip>",
  "content_length": 5853
}