{
  "title": "Files API",
  "source_url": "https://docs.claude.com/en/docs/build-with-claude/files",
  "content": "The Files API lets you upload and manage files to use with the Claude API without re-uploading content with each request. This is particularly useful when using the [code execution tool](/en/docs/agents-and-tools/tool-use/code-execution-tool) to provide inputs (e.g. datasets and documents) and then download outputs (e.g. charts). You can also use the Files API to prevent having to continually re-upload frequently used documents and images across multiple API calls. You can [explore the API reference directly](/en/api/files-create), in addition to this guide.\n\n<Note>\n  The Files API is currently in beta. Please reach out through our [feedback form](https://forms.gle/tisHyierGwgN4DUE9) to share your experience with the Files API.\n</Note>\n\n## Supported models\n\nReferencing a `file_id` in a Messages request is supported in all models that support the given file type. For example, [images](/en/docs/build-with-claude/vision) are supported in all Claude 3+ models, [PDFs](/en/docs/build-with-claude/pdf-support) in all Claude 3.5+ models, and [various other file types](/en/docs/agents-and-tools/tool-use/code-execution-tool#supported-file-types) for the code execution tool in Claude 3.5 Haiku plus all Claude 3.7+ models.\n\nThe Files API is currently not supported on Amazon Bedrock or Google Vertex AI.\n\n## How the Files API works\n\nThe Files API provides a simple create-once, use-many-times approach for working with files:\n\n* **Upload files** to our secure storage and receive a unique `file_id`\n* **Download files** that are created from skills or the code execution tool\n* **Reference files** in [Messages](/en/api/messages) requests using the `file_id` instead of re-uploading content\n* **Manage your files** with list, retrieve, and delete operations\n\n## How to use the Files API\n\n<Note>\n  To use the Files API, you'll need to include the beta feature header: `anthropic-beta: files-api-2025-04-14`.\n</Note>\n\n### Uploading a file\n\nUpload a file to be referenced in future API calls:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl -X POST https://api.anthropic.com/v1/files \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: files-api-2025-04-14\" \\\n    -F \"file=@/path/to/document.pdf\"\n  ```\n\n  ```python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n  client.beta.files.upload(\n    file=(\"document.pdf\", open(\"/path/to/document.pdf\", \"rb\"), \"application/pdf\"),\n  )\n  ```\n\n  ```typescript TypeScript theme={null}\n  import Anthropic, { toFile } from '@anthropic-ai/sdk';\n  import fs from \"fs\";\n\n  const anthropic = new Anthropic();\n\n  await anthropic.beta.files.upload({\n    file: await toFile(fs.createReadStream('/path/to/document.pdf'), undefined, { type: 'application/pdf' })\n  }, {\n    betas: ['files-api-2025-04-14']\n  });\n  ```\n</CodeGroup>\n\nThe response from uploading a file will include:\n\n```json  theme={null}\n{\n  \"id\": \"file_011CNha8iCJcU1wXNR6q4V8w\",\n  \"type\": \"file\",\n  \"filename\": \"document.pdf\",\n  \"mime_type\": \"application/pdf\",\n  \"size_bytes\": 1024000,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"downloadable\": false\n}\n```\n\n### Using a file in messages\n\nOnce uploaded, reference the file using its `file_id`:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl -X POST https://api.anthropic.com/v1/messages \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: files-api-2025-04-14\" \\\n    -H \"content-type: application/json\" \\\n    -d '{\n      \"model\": \"claude-sonnet-4-5\",\n      \"max_tokens\": 1024,\n      \"messages\": [\n        {\n          \"role\": \"user\",\n          \"content\": [\n            {\n              \"type\": \"text\",\n              \"text\": \"Please summarize this document for me.\"          \n            },\n            {\n              \"type\": \"document\",\n              \"source\": {\n                \"type\": \"file\",\n                \"file_id\": \"file_011CNha8iCJcU1wXNR6q4V8w\"\n              }\n            }\n          ]\n        }\n      ]\n    }'\n  ```\n\n  ```python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n\n  response = client.beta.messages.create(\n      model=\"claude-sonnet-4-5\",\n      max_tokens=1024,\n      messages=[\n          {\n              \"role\": \"user\",\n              \"content\": [\n                  {\n                      \"type\": \"text\",\n                      \"text\": \"Please summarize this document for me.\"\n                  },\n                  {\n                      \"type\": \"document\",\n                      \"source\": {\n                          \"type\": \"file\",\n                          \"file_id\": \"file_011CNha8iCJcU1wXNR6q4V8w\"\n                      }\n                  }\n              ]\n          }\n      ],\n      betas=[\"files-api-2025-04-14\"],\n  )\n  print(response)\n  ```\n\n  ```typescript TypeScript theme={null}\n  import { Anthropic } from '@anthropic-ai/sdk';\n\n  const anthropic = new Anthropic();\n\n  const response = await anthropic.beta.messages.create({\n    model: \"claude-sonnet-4-5\",\n    max_tokens: 1024,\n    messages: [\n      {\n        role: \"user\",\n        content: [\n          {\n            type: \"text\",\n            text: \"Please summarize this document for me.\"\n          },\n          {\n            type: \"document\",\n            source: {\n              type: \"file\",\n              file_id: \"file_011CNha8iCJcU1wXNR6q4V8w\"\n            }\n          }\n        ]\n      }\n    ],\n    betas: [\"files-api-2025-04-14\"],\n  });\n\n  console.log(response);\n  ```\n</CodeGroup>\n\n### File types and content blocks\n\nThe Files API supports different file types that correspond to different content block types:\n\n| File Type                                                                                       | MIME Type                                            | Content Block Type | Use Case                            |\n| :---------------------------------------------------------------------------------------------- | :--------------------------------------------------- | :----------------- | :---------------------------------- |\n| PDF                                                                                             | `application/pdf`                                    | `document`         | Text analysis, document processing  |\n| Plain text                                                                                      | `text/plain`                                         | `document`         | Text analysis, processing           |\n| Images                                                                                          | `image/jpeg`, `image/png`, `image/gif`, `image/webp` | `image`            | Image analysis, visual tasks        |\n| [Datasets, others](/en/docs/agents-and-tools/tool-use/code-execution-tool#supported-file-types) | Varies                                               | `container_upload` | Analyze data, create visualizations |\n\n### Working with other file formats\n\nFor file types that are not supported as `document` blocks (.csv, .txt, .md, .docx, .xlsx), convert the files to plain text, and include the content directly in your message:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  # Example: Reading a text file and sending it as plain text\n  # Note: For files with special characters, consider base64 encoding\n  TEXT_CONTENT=$(cat document.txt | jq -Rs .)\n\n  curl https://api.anthropic.com/v1/messages \\\n    -H \"content-type: application/json\" \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -d @- <<EOF\n  {\n    \"model\": \"claude-sonnet-4-5\",\n    \"max_tokens\": 1024,\n    \"messages\": [\n      {\n        \"role\": \"user\",\n        \"content\": [\n          {\n            \"type\": \"text\",\n            \"text\": \"Here's the document content:\\n\\n${TEXT_CONTENT}\\n\\nPlease summarize this document.\"\n          }\n        ]\n      }\n    ]\n  }\n  EOF\n  ```\n\n  ```python Python theme={null}\n  import pandas as pd\n  import anthropic\n\n  client = anthropic.Anthropic()\n\n  # Example: Reading a CSV file\n  df = pd.read_csv('data.csv')\n  csv_content = df.to_string()\n\n  # Send as plain text in the message\n  response = client.messages.create(\n      model=\"claude-sonnet-4-5\",\n      max_tokens=1024,\n      messages=[\n          {\n              \"role\": \"user\",\n              \"content\": [\n                  {\n                      \"type\": \"text\",\n                      \"text\": f\"Here's the CSV data:\\n\\n{csv_content}\\n\\nPlease analyze this data.\"\n                  }\n              ]\n          }\n      ]\n  )\n\n  print(response.content[0].text)\n  ```\n\n  ```typescript TypeScript theme={null}\n  import { Anthropic } from '@anthropic-ai/sdk';\n  import fs from 'fs';\n\n  const anthropic = new Anthropic();\n\n  async function analyzeDocument() {\n    // Example: Reading a text file\n    const textContent = fs.readFileSync('document.txt', 'utf-8');\n\n    // Send as plain text in the message\n    const response = await anthropic.messages.create({\n      model: 'claude-sonnet-4-5',\n      max_tokens: 1024,\n      messages: [\n        {\n          role: 'user',\n          content: [\n            {\n              type: 'text',\n              text: `Here's the document content:\\n\\n${textContent}\\n\\nPlease summarize this document.`\n            }\n          ]\n        }\n      ]\n    });\n\n    console.log(response.content[0].text);\n  }\n\n  analyzeDocument();\n  ```\n</CodeGroup>\n\n<Note>\n  For .docx files containing images, convert them to PDF format first, then use [PDF support](/en/docs/build-with-claude/pdf-support) to take advantage of the built-in image parsing. This allows using citations from the PDF document.\n</Note>\n\n#### Document blocks\n\nFor PDFs and text files, use the `document` content block:\n\n```json  theme={null}\n{\n  \"type\": \"document\",\n  \"source\": {\n    \"type\": \"file\",\n    \"file_id\": \"file_011CNha8iCJcU1wXNR6q4V8w\"\n  },\n  \"title\": \"Document Title\", // Optional\n  \"context\": \"Context about the document\", // Optional  \n  \"citations\": {\"enabled\": true} // Optional, enables citations\n}\n```\n\n#### Image blocks\n\nFor images, use the `image` content block:\n\n```json  theme={null}\n{\n  \"type\": \"image\",\n  \"source\": {\n    \"type\": \"file\",\n    \"file_id\": \"file_011CPMxVD3fHLUhvTqtsQA5w\"\n  }\n}\n```\n\n### Managing files\n\n#### List files\n\nRetrieve a list of your uploaded files:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl https://api.anthropic.com/v1/files \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: files-api-2025-04-14\"\n  ```\n\n  ```python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n  files = client.beta.files.list()\n  ```\n\n  ```typescript TypeScript theme={null}\n  import { Anthropic } from '@anthropic-ai/sdk';\n\n  const anthropic = new Anthropic();\n  const files = await anthropic.beta.files.list({\n    betas: ['files-api-2025-04-14'],\n  });\n  ```\n</CodeGroup>\n\n#### Get file metadata\n\nRetrieve information about a specific file:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl https://api.anthropic.com/v1/files/file_011CNha8iCJcU1wXNR6q4V8w \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: files-api-2025-04-14\"\n  ```\n\n  ```python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n  file = client.beta.files.retrieve_metadata(\"file_011CNha8iCJcU1wXNR6q4V8w\")\n  ```\n\n  ```typescript TypeScript theme={null}\n  import { Anthropic } from '@anthropic-ai/sdk';\n\n  const anthropic = new Anthropic();\n  const file = await anthropic.beta.files.retrieveMetadata(\n    \"file_011CNha8iCJcU1wXNR6q4V8w\",\n    { betas: ['files-api-2025-04-14'] },\n  );\n  ```\n</CodeGroup>\n\n#### Delete a file\n\nRemove a file from your workspace:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl -X DELETE https://api.anthropic.com/v1/files/file_011CNha8iCJcU1wXNR6q4V8w \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: files-api-2025-04-14\"\n  ```\n\n  ```python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n  result = client.beta.files.delete(\"file_011CNha8iCJcU1wXNR6q4V8w\")\n  ```\n\n  ```typescript TypeScript theme={null}\n  import { Anthropic } from '@anthropic-ai/sdk';\n\n  const anthropic = new Anthropic();\n  const result = await anthropic.beta.files.delete(\n    \"file_011CNha8iCJcU1wXNR6q4V8w\",\n    { betas: ['files-api-2025-04-14'] },\n  );\n  ```\n</CodeGroup>\n\n### Downloading a file\n\nDownload files that have been created by skills or the code execution tool:\n\n<CodeGroup>\n  ```bash Shell theme={null}\n  curl -X GET \"https://api.anthropic.com/v1/files/file_011CNha8iCJcU1wXNR6q4V8w/content\" \\\n    -H \"x-api-key: $ANTHROPIC_API_KEY\" \\\n    -H \"anthropic-version: 2023-06-01\" \\\n    -H \"anthropic-beta: files-api-2025-04-14\" \\\n    --output downloaded_file.txt\n  ```\n\n  ```python Python theme={null}\n  import anthropic\n\n  client = anthropic.Anthropic()\n  file_content = client.beta.files.download(\"file_011CNha8iCJcU1wXNR6q4V8w\")\n\n  # Save to file\n  with open(\"downloaded_file.txt\", \"w\") as f:\n      f.write(file_content.decode('utf-8'))\n  ```\n\n  ```typescript TypeScript theme={null}\n  import { Anthropic } from '@anthropic-ai/sdk';\n  import fs from 'fs';\n\n  const anthropic = new Anthropic();\n\n  const fileContent = await anthropic.beta.files.download(\n    \"file_011CNha8iCJcU1wXNR6q4V8w\",\n    { betas: ['files-api-2025-04-14'] },\n  );\n\n  // Save to file\n  fs.writeFileSync(\"downloaded_file.txt\", fileContent);\n  ```\n</CodeGroup>\n\n<Note>\n  You can only download files that were created by [skills](/en/docs/build-with-claude/skills-guide) or the [code execution tool](/en/docs/agents-and-tools/tool-use/code-execution-tool). Files that you uploaded cannot be downloaded.\n</Note>\n\n***\n\n## File storage and limits\n\n### Storage limits\n\n* **Maximum file size:** 500 MB per file\n* **Total storage:** 100 GB per organization\n\n### File lifecycle\n\n* Files are scoped to the workspace of the API key. Other API keys can use files created by any other API key associated with the same workspace\n* Files persist until you delete them\n* Deleted files cannot be recovered\n* Files are inaccessible via the API shortly after deletion, but they may persist in active `Messages` API calls and associated tool uses\n* Files that users delete will be deleted in accordance with our [data retention policy](https://privacy.claude.com/en/articles/7996866-how-long-do-you-store-my-organization-s-data).\n\n***\n\n## Error handling\n\nCommon errors when using the Files API include:\n\n* **File not found (404):** The specified `file_id` doesn't exist or you don't have access to it\n* **Invalid file type (400):** The file type doesn't match the content block type (e.g., using an image file in a document block)\n* **Exceeds context window size (400):** The file is larger than the context window size (e.g. using a 500 MB plaintext file in a `/v1/messages` request)\n* **Invalid filename (400):** Filename doesn't meet the length requirements (1-255 characters) or contains forbidden characters (`<`, `>`, `:`, `\"`, `|`, `?`, `*`, `\\`, `/`, or unicode characters 0-31)\n* **File too large (413):** File exceeds the 500 MB limit\n* **Storage limit exceeded (403):** Your organization has reached the 100 GB storage limit\n\n```json  theme={null}\n{\n  \"type\": \"error\",\n  \"error\": {\n    \"type\": \"invalid_request_error\",\n    \"message\": \"File not found: file_011CNha8iCJcU1wXNR6q4V8w\"\n  }\n}\n```\n\n## Usage and billing\n\nFile API operations are **free**:\n\n* Uploading files\n* Downloading files\n* Listing files\n* Getting file metadata\n* Deleting files\n\nFile content used in `Messages` requests are priced as input tokens. You can only download files created by [skills](/en/docs/build-with-claude/skills-guide) or the [code execution tool](/en/docs/agents-and-tools/tool-use/code-execution-tool).\n\n### Rate limits\n\nDuring the beta period:\n\n* File-related API calls are limited to approximately 100 requests per minute\n* [Contact us](mailto:sales@anthropic.com) if you need higher limits for your use case",
  "content_length": 15974
}