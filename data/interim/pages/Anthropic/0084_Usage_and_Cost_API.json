{
  "title": "Usage and Cost API",
  "source_url": "https://docs.claude.com/en/docs/build-with-claude/usage-cost-api",
  "content": "Programmatically access your organization's API usage and cost data with the Usage & Cost Admin API.\n\n<Tip>\n  **The Admin API is unavailable for individual accounts.** To collaborate with teammates and add members, set up your organization in **Console → Settings → Organization**.\n</Tip>\n\nThe Usage & Cost Admin API provides programmatic and granular access to historical API usage and cost data for your organization. This data is similar to the information available in the [Usage](https://console.anthropic.com/usage) and [Cost](https://console.anthropic.com/cost) pages of the Claude Console.\n\nThis API enables you to better monitor, analyze, and optimize your Claude implementations:\n\n* **Accurate Usage Tracking:** Get precise token counts and usage patterns instead of relying solely on response token counting\n* **Cost Reconciliation:** Match internal records with Anthropic billing for finance and accounting teams\n* **Product performance and improvement:** Monitor product performance while measuring if changes to the system have improved it, or setup alerting\n* **[Rate limit](/en/api/rate-limits) and [Priority Tier](/en/api/service-tiers#get-started-with-priority-tier) optimization:** Optimize features like [prompt caching](/en/docs/build-with-claude/prompt-caching) or specific prompts to make the most of one’s allocated capacity, or purchase dedicated capacity.\n* **Advanced Analysis:** Perform deeper data analysis than what's available in Console\n\n<Check>\n  **Admin API key required**\n\n  This API is part of the [Admin API](/en/docs/build-with-claude/administration-api). These endpoints require an Admin API key (starting with `sk-ant-admin...`) that differs from standard API keys. Only organization members with the admin role can provision Admin API keys through the [Claude Console](https://console.anthropic.com/settings/admin-keys).\n</Check>\n\n## Partner solutions\n\nLeading observability platforms offer ready-to-use integrations for monitoring your Claude API usage and cost, without writing custom code. These integrations provide dashboards, alerting, and analytics to help you manage your API usage effectively.\n\n<CardGroup cols={3}>\n  <Card title=\"Datadog\" icon=\"chart-line\" href=\"https://docs.datadoghq.com/integrations/anthropic/\">\n    LLM Observability with automatic tracing and monitoring\n  </Card>\n\n  <Card title=\"Grafana Cloud\" icon=\"chart-area\" href=\"https://grafana.com/docs/grafana-cloud/monitor-infrastructure/integrations/integration-reference/integration-anthropic/\">\n    Agentless integration for easy LLM observability with out-of-the-box dashboards and alerts\n  </Card>\n\n  <Card title=\"Honeycomb\" icon=\"hexagon\" href=\"https://docs.honeycomb.io/integrations/anthropic-usage-monitoring/\">\n    Advanced querying and visualization through OpenTelemetry\n  </Card>\n</CardGroup>\n\n## Quick start\n\nGet your organization's daily usage for the last 7 days:\n\n```bash  theme={null}\ncurl \"https://api.anthropic.com/v1/organizations/usage_report/messages?\\\nstarting_at=2025-01-08T00:00:00Z&\\\nending_at=2025-01-15T00:00:00Z&\\\nbucket_width=1d\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n```\n\n<Tip>\n  **Set a User-Agent header for integrations**\n\n  If you're building an integration, set your User-Agent header to help us understand usage patterns:\n\n  ```\n  User-Agent: YourApp/1.0.0 (https://yourapp.com)\n  ```\n</Tip>\n\n## Usage API\n\nTrack token consumption across your organization with detailed breakdowns by model, workspace, and service tier with the `/v1/organizations/usage_report/messages` endpoint.\n\n### Key concepts\n\n* **Time buckets**: Aggregate usage data in fixed intervals (`1m`, `1h`, or `1d`)\n* **Token tracking**: Measure uncached input, cached input, cache creation, and output tokens\n* **Filtering & grouping**: Filter by API key, workspace, model, service tier, or context window, and group results by these dimensions\n* **Server tool usage**: Track usage of server-side tools like web search\n\nFor complete parameter details and response schemas, see the [Usage API reference](/en/api/admin-api/usage-cost/get-messages-usage-report).\n\n### Basic examples\n\n#### Daily usage by model\n\n```bash  theme={null}\ncurl \"https://api.anthropic.com/v1/organizations/usage_report/messages?\\\nstarting_at=2025-01-01T00:00:00Z&\\\nending_at=2025-01-08T00:00:00Z&\\\ngroup_by[]=model&\\\nbucket_width=1d\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n```\n\n#### Hourly usage with filtering\n\n```bash  theme={null}\ncurl \"https://api.anthropic.com/v1/organizations/usage_report/messages?\\\nstarting_at=2025-01-15T00:00:00Z&\\\nending_at=2025-01-15T23:59:59Z&\\\nmodels[]=claude-sonnet-4-5-20250929&\\\nservice_tiers[]=batch&\\\ncontext_window[]=0-200k&\\\nbucket_width=1h\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n```\n\n#### Filter usage by API keys and workspaces\n\n```bash  theme={null}\ncurl \"https://api.anthropic.com/v1/organizations/usage_report/messages?\\\nstarting_at=2025-01-01T00:00:00Z&\\\nending_at=2025-01-08T00:00:00Z&\\\napi_key_ids[]=apikey_01Rj2N8SVvo6BePZj99NhmiT&\\\napi_key_ids[]=apikey_01ABC123DEF456GHI789JKL&\\\nworkspace_ids[]=wrkspc_01JwQvzr7rXLA5AGx3HKfFUJ&\\\nworkspace_ids[]=wrkspc_01XYZ789ABC123DEF456MNO&\\\nbucket_width=1d\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n```\n\n<Tip>\n  To retrieve your organization's API key IDs, use the [List API Keys](/en/api/admin-api/apikeys/list-api-keys) endpoint.\n\n  To retrieve your organization's workspace IDs, use the [List Workspaces](/en/api/admin-api/workspaces/list-workspaces) endpoint, or find your organization's workspace IDs in the Anthropic Console.\n</Tip>\n\n### Time granularity limits\n\n| Granularity | Default Limit | Maximum Limit | Use Case               |\n| ----------- | ------------- | ------------- | ---------------------- |\n| `1m`        | 60 buckets    | 1440 buckets  | Real-time monitoring   |\n| `1h`        | 24 buckets    | 168 buckets   | Daily patterns         |\n| `1d`        | 7 buckets     | 31 buckets    | Weekly/monthly reports |\n\n## Cost API\n\nRetrieve service-level cost breakdowns in USD with the `/v1/organizations/cost_report` endpoint.\n\n### Key concepts\n\n* **Currency**: All costs in USD, reported as decimal strings in lowest units (cents)\n* **Cost types**: Track token usage, web search, and code execution costs\n* **Grouping**: Group costs by workspace or description for detailed breakdowns\n* **Time buckets**: Daily granularity only (`1d`)\n\nFor complete parameter details and response schemas, see the [Cost API reference](/en/api/admin-api/usage-cost/get-cost-report).\n\n<Warning>\n  Priority Tier costs use a different billing model and are not included in the cost endpoint. Track Priority Tier usage through the usage endpoint instead.\n</Warning>\n\n### Basic example\n\n```bash  theme={null}\ncurl \"https://api.anthropic.com/v1/organizations/cost_report?\\\nstarting_at=2025-01-01T00:00:00Z&\\\nending_at=2025-01-31T00:00:00Z&\\\ngroup_by[]=workspace_id&\\\ngroup_by[]=description\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n```\n\n## Pagination\n\nBoth endpoints support pagination for large datasets:\n\n1. Make your initial request\n2. If `has_more` is `true`, use the `next_page` value in your next request\n3. Continue until `has_more` is `false`\n\n```bash  theme={null}\n# First request\ncurl \"https://api.anthropic.com/v1/organizations/usage_report/messages?\\\nstarting_at=2025-01-01T00:00:00Z&\\\nending_at=2025-01-31T00:00:00Z&\\\nlimit=7\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n\n# Response includes: \"has_more\": true, \"next_page\": \"page_xyz...\"\n\n# Next request with pagination\ncurl \"https://api.anthropic.com/v1/organizations/usage_report/messages?\\\nstarting_at=2025-01-01T00:00:00Z&\\\nending_at=2025-01-31T00:00:00Z&\\\nlimit=7&\\\npage=page_xyz...\" \\\n  --header \"anthropic-version: 2023-06-01\" \\\n  --header \"x-api-key: $ADMIN_API_KEY\"\n```\n\n## Common use cases\n\nExplore detailed implementations in [anthropic-cookbook](https://github.com/anthropics/anthropic-cookbook):\n\n* **Daily usage reports**: Track token consumption trends\n* **Cost attribution**: Allocate expenses by workspace for chargebacks\n* **Cache efficiency**: Measure and optimize prompt caching\n* **Budget monitoring**: Set up alerts for spending thresholds\n* **CSV export**: Generate reports for finance teams\n\n## Frequently asked questions\n\n### How fresh is the data?\n\nUsage and cost data typically appears within 5 minutes of API request completion, though delays may occasionally be longer.\n\n### What's the recommended polling frequency?\n\nThe API supports polling once per minute for sustained use. For short bursts (e.g., downloading paginated data), more frequent polling is acceptable. Cache results for dashboards that need frequent updates.\n\n### How do I track code execution usage?\n\nCode execution costs appear in the cost endpoint grouped under `Code Execution Usage` in the description field. Code execution is not included in the usage endpoint.\n\n### How do I track Priority Tier usage?\n\nFilter or group by `service_tier` in the usage endpoint and look for the `priority` value. Priority Tier costs are not available in the cost endpoint.\n\n### What happens with Workbench usage?\n\nAPI usage from the Workbench is not associated with an API key, so `api_key_id` will be `null` even when grouping by that dimension.\n\n### How is the default workspace represented?\n\nUsage and costs attributed to the default workspace have a `null` value for `workspace_id`.\n\n### How do I get per-user cost breakdowns for Claude Code?\n\nUse the [Claude Code Analytics API](/en/docs/build-with-claude/claude-code-analytics-api), which provides per-user estimated costs and productivity metrics without the performance limitations of breaking down costs by many API keys. For general API usage with many keys, use the [Usage API](#usage-api) to track token consumption as a cost proxy.\n\n## See also\n\nThe Usage and Cost APIs can be used to help you deliver a better experience for your users, help you manage costs, and preserve your rate limit. Learn more about some of these other features:\n\n* [Admin API overview](/en/docs/build-with-claude/administration-api)\n* [Admin API reference](/en/api/admin-api)\n* [Pricing](/en/docs/about-claude/pricing)\n* [Prompt caching](/en/docs/build-with-claude/prompt-caching) - Optimize costs with caching\n* [Batch processing](/en/docs/build-with-claude/batch-processing) - 50% discount on batch requests\n* [Rate limits](/en/api/rate-limits) - Understand usage tiers",
  "content_length": 10603
}