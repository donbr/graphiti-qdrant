{
  "title": "Google OAuth ðŸ¤ FastMCP",
  "source_url": "https://gofastmcp.com/integrations/google",
  "content": "Secure your FastMCP server with Google OAuth\n\nexport const VersionBadge = ({version}) => {\n  return <code className=\"version-badge-container\">\n            <p className=\"version-badge\">\n                <span className=\"version-badge-label\">New in version:</span>Â \n                <code className=\"version-badge-version\">{version}</code>\n            </p>\n        </code>;\n};\n\n<VersionBadge version=\"2.12.0\" />\n\nThis guide shows you how to secure your FastMCP server using **Google OAuth**. Since Google doesn't support Dynamic Client Registration, this integration uses the [**OAuth Proxy**](/servers/auth/oauth-proxy) pattern to bridge Google's traditional OAuth with MCP's authentication requirements.\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n\n1. A **[Google Cloud Account](https://console.cloud.google.com/)** with access to create OAuth 2.0 Client IDs\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create a Google OAuth 2.0 Client ID\n\nCreate an OAuth 2.0 Client ID in your Google Cloud Console to get the credentials needed for authentication:\n\n<Steps>\n  <Step title=\"Navigate to OAuth Consent Screen\">\n    Go to the [Google Cloud Console](https://console.cloud.google.com/apis/credentials) and select your project (or create a new one).\n\n    First, configure the OAuth consent screen by navigating to **APIs & Services â†’ OAuth consent screen**. Choose \"External\" for testing or \"Internal\" for G Suite organizations.\n  </Step>\n\n  <Step title=\"Create OAuth 2.0 Client ID\">\n    Navigate to **APIs & Services â†’ Credentials** and click **\"+ CREATE CREDENTIALS\"** â†’ **\"OAuth client ID\"**.\n\n    Configure your OAuth client:\n\n    * **Application type**: Web application\n    * **Name**: Choose a descriptive name (e.g., \"FastMCP Server\")\n    * **Authorized JavaScript origins**: Add your server's base URL (e.g., `http://localhost:8000`)\n    * **Authorized redirect URIs**: Add your server URL + `/auth/callback` (e.g., `http://localhost:8000/auth/callback`)\n\n    <Warning>\n      The redirect URI must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter. For local development, Google allows `http://localhost` URLs with various ports. For production, you must use HTTPS.\n    </Warning>\n\n    <Tip>\n      If you want to use a custom callback path (e.g., `/auth/google/callback`), make sure to set the same path in both your Google OAuth Client settings and the `redirect_path` parameter when configuring the GoogleProvider.\n    </Tip>\n  </Step>\n\n  <Step title=\"Save Your Credentials\">\n    After creating the client, you'll receive:\n\n    * **Client ID**: A string ending in `.apps.googleusercontent.com`\n    * **Client Secret**: A string starting with `GOCSPX-`\n\n    Download the JSON credentials or copy these values securely.\n\n    <Tip>\n      Store these credentials securely. Never commit them to version control. Use environment variables or a secrets manager in production.\n    </Tip>\n  </Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `GoogleProvider`, which handles Google's OAuth flow automatically:\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.google import GoogleProvider\n\n# The GoogleProvider handles Google's token format and validation\nauth_provider = GoogleProvider(\n    client_id=\"123456789.apps.googleusercontent.com\",  # Your Google OAuth Client ID\n    client_secret=\"GOCSPX-abc123...\",                  # Your Google OAuth Client Secret\n    base_url=\"http://localhost:8000\",                  # Must match your OAuth configuration\n    required_scopes=[                                  # Request user information\n        \"openid\",\n        \"https://www.googleapis.com/auth/userinfo.email\",\n    ],\n    # redirect_path=\"/auth/callback\"                  # Default value, customize if needed\n)\n\nmcp = FastMCP(name=\"Google Secured App\", auth=auth_provider)\n\n# Add a protected tool to test authentication\n@mcp.tool\nasync def get_user_info() -> dict:\n    \"\"\"Returns information about the authenticated Google user.\"\"\"\n    from fastmcp.server.dependencies import get_access_token\n    \n    token = get_access_token()\n    # The GoogleProvider stores user data in token claims\n    return {\n        \"google_id\": token.claims.get(\"sub\"),\n        \"email\": token.claims.get(\"email\"),\n        \"name\": token.claims.get(\"name\"),\n        \"picture\": token.claims.get(\"picture\"),\n        \"locale\": token.claims.get(\"locale\")\n    }\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by Google OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your Google-protected server:\n\n```python test_client.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():\n    # The client will automatically handle Google OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open Google login in your browser\n        print(\"âœ“ Authenticated with Google!\")\n        \n        # Test the protected tool\n        result = await client.call_tool(\"get_user_info\")\n        print(f\"Google user: {result['email']}\")\n        print(f\"Name: {result['name']}\")\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n\n1. Your browser will open to Google's authorization page\n2. Sign in with your Google account and grant the requested permissions\n3. After authorization, you'll be redirected back\n4. The client receives the token and can make authenticated requests\n\n<Info>\n  The client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key` and `client_storage`:\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.google import GoogleProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth_provider = GoogleProvider(\n    client_id=\"123456789.apps.googleusercontent.com\",\n    client_secret=\"GOCSPX-abc123...\",\n    base_url=\"https://your-production-domain.com\",\n    required_scopes=[\"openid\", \"https://www.googleapis.com/auth/userinfo.email\"],\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production Google App\", auth=auth_provider)\n```\n\n<Note>\n  Parameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\n  For complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the Google provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n  <ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\n    Set to `fastmcp.server.auth.providers.google.GoogleProvider` to use Google authentication.\n  </ParamField>\n</Card>\n\n### Google-Specific Configuration\n\nThese environment variables provide default values for the Google provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID\" required>\n    Your Google OAuth 2.0 Client ID (e.g., `123456789.apps.googleusercontent.com`)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET\" required>\n    Your Google OAuth 2.0 Client Secret (e.g., `GOCSPX-abc123...`)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_BASE_URL\" default=\"http://localhost:8000\">\n    Public URL where OAuth endpoints will be accessible (includes any mount path)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_ISSUER_URL\" default=\"Uses BASE_URL\">\n    Issuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_REDIRECT_PATH\" default=\"/auth/callback\">\n    Redirect path configured in your Google OAuth Client\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_REQUIRED_SCOPES\" default=\"[]\">\n    Comma-, space-, or JSON-separated list of required Google scopes (e.g., `\"openid,https://www.googleapis.com/auth/userinfo.email\"` or `[\"openid\", \"https://www.googleapis.com/auth/userinfo.email\"]`)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_GOOGLE_TIMEOUT_SECONDS\" default=\"10\">\n    HTTP request timeout for Google API calls\n  </ParamField>\n</Card>\n\nExample `.env` file:\n\n```bash  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\n# Use the Google provider\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.google.GoogleProvider\n\n# Google OAuth credentials\nFASTMCP_SERVER_AUTH_GOOGLE_CLIENT_ID=123456789.apps.googleusercontent.com\nFASTMCP_SERVER_AUTH_GOOGLE_CLIENT_SECRET=GOCSPX-abc123...\nFASTMCP_SERVER_AUTH_GOOGLE_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_GOOGLE_REQUIRED_SCOPES=openid,https://www.googleapis.com/auth/userinfo.email\n```\n\nWith environment variables set, your server code simplifies to:\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\n\n# Authentication is automatically configured from environment\nmcp = FastMCP(name=\"Google Secured App\")\n\n@mcp.tool\nasync def protected_tool(query: str) -> str:\n    \"\"\"A tool that requires Google authentication to access.\"\"\"\n    # Your tool implementation here\n    return f\"Processing authenticated request: {query}\"\n```",
  "content_length": 11064
}