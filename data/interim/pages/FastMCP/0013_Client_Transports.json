{
  "title": "Client Transports",
  "source_url": "https://gofastmcp.com/clients/transports",
  "content": "Configure how FastMCP Clients connect to and communicate with servers.\n\nexport const VersionBadge = ({version}) => {\n  return <code className=\"version-badge-container\">\n            <p className=\"version-badge\">\n                <span className=\"version-badge-label\">New in version:</span> \n                <code className=\"version-badge-version\">{version}</code>\n            </p>\n        </code>;\n};\n\n<VersionBadge version=\"2.0.0\" />\n\nThe FastMCP `Client` communicates with MCP servers through transport objects that handle the underlying connection mechanics. While the client can automatically select a transport based on what you pass to it, instantiating transports explicitly gives you full control over configuration—environment variables, authentication, session management, and more.\n\nThink of transports as configurable adapters between your client code and MCP servers. Each transport type handles a different communication pattern: subprocesses with pipes, HTTP connections, or direct in-memory calls.\n\n## Choosing the Right Transport\n\n* **Use [STDIO Transport](#stdio-transport)** when you need to run local MCP servers with full control over their environment and lifecycle\n* **Use [Remote Transports](#remote-transports)** when connecting to production services or shared MCP servers running independently\n* **Use [In-Memory Transport](#in-memory-transport)** for testing FastMCP servers without subprocess or network overhead\n* **Use [MCP JSON Configuration](#mcp-json-configuration-transport)** when you need to connect to multiple servers defined in configuration files\n\n## STDIO Transport\n\nSTDIO (Standard Input/Output) transport communicates with MCP servers through subprocess pipes. This is the standard mechanism used by desktop clients like Claude Desktop and is the primary way to run local MCP servers.\n\n### The Client Runs the Server\n\n<Warning>\n  **Critical Concept**: When using STDIO transport, your client actually launches and manages the server process. This is fundamentally different from network transports where you connect to an already-running server. Understanding this relationship is key to using STDIO effectively.\n</Warning>\n\nWith STDIO transport, your client:\n\n* Starts the server as a subprocess when you connect\n* Manages the server's lifecycle (start, stop, restart)\n* Controls the server's environment and configuration\n* Communicates through stdin/stdout pipes\n\nThis architecture enables powerful local integrations but requires understanding environment isolation and process management.\n\n### Environment Isolation\n\nSTDIO servers run in isolated environments by default. This is a security feature enforced by the MCP protocol to prevent accidental exposure of sensitive data.\n\nWhen your client launches an MCP server:\n\n* The server does NOT inherit your shell's environment variables\n* API keys, paths, and other configuration must be explicitly passed\n* The working directory and system paths may differ from your shell\n\nTo pass environment variables to your server, use the `env` parameter:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import Client\n\n# If your server needs environment variables (like API keys),\n# you must explicitly pass them:\nclient = Client(\n    \"my_server.py\",\n    env={\"API_KEY\": \"secret\", \"DEBUG\": \"true\"}\n)\n\n# This won't work - the server runs in isolation:\n# export API_KEY=\"secret\"  # in your shell\n# client = Client(\"my_server.py\")  # server can't see API_KEY\n```\n\n### Basic Usage\n\nTo use STDIO transport, you create a transport instance with the command and arguments needed to run your server:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp.client.transports import StdioTransport\n\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"my_server.py\"]\n)\nclient = Client(transport)\n```\n\nYou can configure additional settings like environment variables, working directory, or command arguments:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"my_server.py\", \"--verbose\"],\n    env={\"LOG_LEVEL\": \"DEBUG\"},\n    cwd=\"/path/to/server\"\n)\nclient = Client(transport)\n```\n\nFor convenience, the client can also infer STDIO transport from file paths, but this doesn't allow configuration:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import Client\n\nclient = Client(\"my_server.py\")  # Limited - no configuration options\n```\n\n### Environment Variables\n\nSince STDIO servers don't inherit your environment, you need strategies for passing configuration. Here are two common approaches:\n\n**Selective forwarding** passes only the variables your server actually needs:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nimport os\nfrom fastmcp.client.transports import StdioTransport\n\nrequired_vars = [\"API_KEY\", \"DATABASE_URL\", \"REDIS_HOST\"]\nenv = {\n    var: os.environ[var] \n    for var in required_vars \n    if var in os.environ\n}\n\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"],\n    env=env\n)\nclient = Client(transport)\n```\n\n**Loading from .env files** keeps configuration separate from code:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom dotenv import dotenv_values\nfrom fastmcp.client.transports import StdioTransport\n\nenv = dotenv_values(\".env\")\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"],\n    env=env\n)\nclient = Client(transport)\n```\n\n### Session Persistence\n\nSTDIO transports maintain sessions across multiple client contexts by default (`keep_alive=True`). This improves performance by reusing the same subprocess for multiple connections, but can be controlled when you need isolation.\n\nBy default, the subprocess persists between connections:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp.client.transports import StdioTransport\n\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"]\n)\nclient = Client(transport)\n\nasync def efficient_multiple_operations():\n    async with client:\n        await client.ping()\n    \n    async with client:  # Reuses the same subprocess\n        await client.call_tool(\"process_data\", {\"file\": \"data.csv\"})\n```\n\nFor complete isolation between connections, disable session persistence:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\ntransport = StdioTransport(\n    command=\"python\",\n    args=[\"server.py\"],\n    keep_alive=False\n)\nclient = Client(transport)\n```\n\nUse `keep_alive=False` when you need complete isolation (e.g., in test suites) or when server state could cause issues between connections.\n\n### Specialized STDIO Transports\n\nFastMCP provides convenience transports that are thin wrappers around `StdioTransport` with pre-configured commands:\n\n* **`PythonStdioTransport`** - Uses `python` command for `.py` files\n* **`NodeStdioTransport`** - Uses `node` command for `.js` files\n* **`UvStdioTransport`** - Uses `uv` for Python packages (uses `env_vars` parameter)\n* **`UvxStdioTransport`** - Uses `uvx` for Python packages (uses `env_vars` parameter)\n* **`NpxStdioTransport`** - Uses `npx` for Node packages (uses `env_vars` parameter)\n\nFor most use cases, instantiate `StdioTransport` directly with your desired command. These specialized transports are primarily useful for client inference shortcuts.\n\n## Remote Transports\n\nRemote transports connect to MCP servers running as web services. This is a fundamentally different model from STDIO transports—instead of your client launching and managing a server process, you connect to an already-running service that manages its own environment and lifecycle.\n\n### Streamable HTTP Transport\n\n<VersionBadge version=\"2.3.0\" />\n\nStreamable HTTP is the recommended transport for production deployments, providing efficient bidirectional streaming over HTTP connections.\n\n* **Class:** `StreamableHttpTransport`\n* **Server compatibility:** FastMCP servers running with `mcp run --transport http`\n\nThe transport requires a URL and optionally supports custom headers for authentication and configuration:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp.client.transports import StreamableHttpTransport\n\n# Basic connection\ntransport = StreamableHttpTransport(url=\"https://api.example.com/mcp\")\nclient = Client(transport)\n\n# With custom headers for authentication\ntransport = StreamableHttpTransport(\n    url=\"https://api.example.com/mcp\",\n    headers={\n        \"Authorization\": \"Bearer your-token-here\",\n        \"X-Custom-Header\": \"value\"\n    }\n)\nclient = Client(transport)\n```\n\nFor convenience, FastMCP also provides authentication helpers:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp.client.auth import BearerAuth\n\nclient = Client(\n    \"https://api.example.com/mcp\",\n    auth=BearerAuth(\"your-token-here\")\n)\n```\n\n### SSE Transport (Legacy)\n\nServer-Sent Events transport is maintained for backward compatibility but is superseded by Streamable HTTP for new deployments.\n\n* **Class:** `SSETransport`\n* **Server compatibility:** FastMCP servers running with `mcp run --transport sse`\n\nSSE transport supports the same configuration options as Streamable HTTP:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp.client.transports import SSETransport\n\ntransport = SSETransport(\n    url=\"https://api.example.com/sse\",\n    headers={\"Authorization\": \"Bearer token\"}\n)\nclient = Client(transport)\n```\n\nUse Streamable HTTP for new deployments unless you have specific infrastructure requirements for SSE.\n\n## In-Memory Transport\n\nIn-memory transport connects directly to a FastMCP server instance within the same Python process. This eliminates both subprocess management and network overhead, making it ideal for testing and development.\n\n* **Class:** `FastMCPTransport`\n\n<Note>\n  Unlike STDIO transports, in-memory servers have full access to your Python process's environment. They share the same memory space and environment variables as your client code—no isolation or explicit environment passing required.\n</Note>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP, Client\nimport os\n\nmcp = FastMCP(\"TestServer\")\n\n@mcp.tool\ndef greet(name: str) -> str:\n    prefix = os.environ.get(\"GREETING_PREFIX\", \"Hello\")\n    return f\"{prefix}, {name}!\"\n\nclient = Client(mcp)\n\nasync with client:\n    result = await client.call_tool(\"greet\", {\"name\": \"World\"})\n```\n\n## MCP JSON Configuration Transport\n\n<VersionBadge version=\"2.4.0\" />\n\nThis transport supports the emerging MCP JSON configuration standard for defining multiple servers:\n\n* **Class:** `MCPConfigTransport`\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\"\n        },\n        \"assistant\": {\n            \"command\": \"python\",\n            \"args\": [\"./assistant.py\"],\n            \"env\": {\"LOG_LEVEL\": \"INFO\"}\n        }\n    }\n}\n\nclient = Client(config)\n\nasync with client:\n    # Tools are namespaced by server\n    weather = await client.call_tool(\"weather_get_forecast\", {\"city\": \"NYC\"})\n    answer = await client.call_tool(\"assistant_ask\", {\"question\": \"What?\"})\n```\n\n### Tool Transformation with FastMCP and MCPConfig\n\nFastMCP supports basic tool transformations to be defined alongside the MCP Servers in the MCPConfig file.\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": { }   #  <--- This is the tool transformation section\n        }\n    }\n}\n```\n\nWith these transformations, you can transform (change) the name, title, description, tags, enablement, and arguments of a tool.\n\nFor each argument the tool takes, you can transform (change) the name, description, default, visibility, whether it's required, and you can provide example values.\n\nIn the following example, we're transforming the `weather_get_forecast` tool to only retrieve the weather for `Miami` and hiding the `city` argument from the client.\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\ntool_transformations = {\n    \"weather_get_forecast\": {\n        \"name\": \"miami_weather\",\n        \"description\": \"Get the weather for Miami\",\n        \"arguments\": {\n            \"city\": {\n                \"name\": \"city\",\n                \"default\": \"Miami\",\n                \"hide\": True,\n            }\n        }\n    }\n}\n\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": tool_transformations\n        }\n    }\n}\n```\n\n#### Allowlisting and Blocklisting Tools\n\nTools can be allowlisted or blocklisted from the client by applying `tags` to the tools on the server. In the following example, we're allowlisting only tools marked with the `forecast` tag, all other tools will be unavailable to the client.\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\ntool_transformations = {\n    \"weather_get_forecast\": {\n        \"enabled\": True,\n        \"tags\": [\"forecast\"]\n    }\n}\n\n\nconfig = {\n    \"mcpServers\": {\n        \"weather\": {\n            \"url\": \"https://weather.example.com/mcp\",\n            \"transport\": \"http\",\n            \"tools\": tool_transformations,\n            \"include_tags\": [\"forecast\"]\n        }\n    }\n}\n```",
  "content_length": 13621
}