{
  "title": "WorkOS ðŸ¤ FastMCP",
  "source_url": "https://gofastmcp.com/integrations/workos",
  "content": "Authenticate FastMCP servers with WorkOS Connect\n\nexport const VersionBadge = ({version}) => {\n  return <code className=\"version-badge-container\">\n            <p className=\"version-badge\">\n                <span className=\"version-badge-label\">New in version:</span>Â \n                <code className=\"version-badge-version\">{version}</code>\n            </p>\n        </code>;\n};\n\n<VersionBadge version=\"2.12.0\" />\n\nSecure your FastMCP server with WorkOS Connect authentication. This integration uses the OAuth Proxy pattern to handle authentication through WorkOS Connect while maintaining compatibility with MCP clients.\n\n<Note>\n  This guide covers WorkOS Connect applications. For Dynamic Client Registration (DCR) with AuthKit, see the [AuthKit integration](/integrations/authkit) instead.\n</Note>\n\n## Configuration\n\n### Prerequisites\n\nBefore you begin, you will need:\n\n1. A **[WorkOS Account](https://workos.com/)** with access to create OAuth Apps\n2. Your FastMCP server's URL (can be localhost for development, e.g., `http://localhost:8000`)\n\n### Step 1: Create a WorkOS OAuth App\n\nCreate an OAuth App in your WorkOS dashboard to get the credentials needed for authentication:\n\n<Steps>\n  <Step title=\"Create OAuth Application\">\n    In your WorkOS dashboard:\n\n    1. Navigate to **Applications**\n    2. Click **Create Application**\n    3. Select **OAuth Application**\n    4. Name your application\n  </Step>\n\n  <Step title=\"Get Credentials\">\n    In your OAuth application settings:\n\n    1. Copy your **Client ID** (starts with `client_`)\n    2. Click **Generate Client Secret** and save it securely\n    3. Copy your **AuthKit Domain** (e.g., `https://your-app.authkit.app`)\n  </Step>\n\n  <Step title=\"Configure Redirect URI\">\n    In the **Redirect URIs** section:\n\n    * Add: `http://localhost:8000/auth/callback` (for development)\n    * For production, add your server's public URL + `/auth/callback`\n\n    <Warning>\n      The callback URL must match exactly. The default path is `/auth/callback`, but you can customize it using the `redirect_path` parameter.\n    </Warning>\n  </Step>\n</Steps>\n\n### Step 2: FastMCP Configuration\n\nCreate your FastMCP server using the `WorkOSProvider`:\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import WorkOSProvider\n\n# Configure WorkOS OAuth\nauth = WorkOSProvider(\n    client_id=\"client_YOUR_CLIENT_ID\",\n    client_secret=\"YOUR_CLIENT_SECRET\",\n    authkit_domain=\"https://your-app.authkit.app\",\n    base_url=\"http://localhost:8000\",\n    required_scopes=[\"openid\", \"profile\", \"email\"]\n)\n\nmcp = FastMCP(\"WorkOS Protected Server\", auth=auth)\n\n@mcp.tool\ndef protected_tool(message: str) -> str:\n    \"\"\"This tool requires authentication.\"\"\"\n    return f\"Authenticated user says: {message}\"\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n## Testing\n\n### Running the Server\n\nStart your FastMCP server with HTTP transport to enable OAuth flows:\n\n```bash  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfastmcp run server.py --transport http --port 8000\n```\n\nYour server is now running and protected by WorkOS OAuth authentication.\n\n### Testing with a Client\n\nCreate a test client that authenticates with your WorkOS-protected server:\n\n```python client.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import Client\nimport asyncio\n\nasync def main():    \n    # The client will automatically handle WorkOS OAuth\n    async with Client(\"http://localhost:8000/mcp\", auth=\"oauth\") as client:\n        # First-time connection will open WorkOS login in your browser\n        print(\"âœ“ Authenticated with WorkOS!\")\n        \n        # Test the protected tool\n        result = await client.call_tool(\"protected_tool\", {\"message\": \"Hello!\"})\n        print(result)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n```\n\nWhen you run the client for the first time:\n\n1. Your browser will open to WorkOS's authorization page\n2. After you authorize the app, you'll be redirected back\n3. The client receives the token and can make authenticated requests\n\n<Info>\n  The client caches tokens locally, so you won't need to re-authenticate for subsequent runs unless the token expires or you explicitly clear the cache.\n</Info>\n\n## Production Configuration\n\n<VersionBadge version=\"2.13.0\" />\n\nFor production deployments with persistent token management across server restarts, configure `jwt_signing_key`, and `client_storage`:\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nimport os\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import WorkOSProvider\nfrom key_value.aio.stores.redis import RedisStore\nfrom key_value.aio.wrappers.encryption import FernetEncryptionWrapper\nfrom cryptography.fernet import Fernet\n\n# Production setup with encrypted persistent token storage\nauth = WorkOSProvider(\n    client_id=\"client_YOUR_CLIENT_ID\",\n    client_secret=\"YOUR_CLIENT_SECRET\",\n    authkit_domain=\"https://your-app.authkit.app\",\n    base_url=\"https://your-production-domain.com\",\n    required_scopes=[\"openid\", \"profile\", \"email\"],\n\n    # Production token management\n    jwt_signing_key=os.environ[\"JWT_SIGNING_KEY\"],\n    client_storage=FernetEncryptionWrapper(\n        key_value=RedisStore(\n            host=os.environ[\"REDIS_HOST\"],\n            port=int(os.environ[\"REDIS_PORT\"])\n        ),\n        fernet=Fernet(os.environ[\"STORAGE_ENCRYPTION_KEY\"])\n    )\n)\n\nmcp = FastMCP(name=\"Production WorkOS App\", auth=auth)\n```\n\n<Note>\n  Parameters (`jwt_signing_key` and `client_storage`) work together to ensure tokens and client registrations survive server restarts. **Wrap your storage in `FernetEncryptionWrapper` to encrypt sensitive OAuth tokens at rest** - without it, tokens are stored in plaintext. Store secrets in environment variables and use a persistent storage backend like Redis for distributed deployments.\n\n  For complete details on these parameters, see the [OAuth Proxy documentation](/servers/auth/oauth-proxy#configuration-parameters).\n</Note>\n\n## Environment Variables\n\n<VersionBadge version=\"2.12.1\" />\n\nFor production deployments, use environment variables instead of hardcoding credentials.\n\n### Provider Selection\n\nSetting this environment variable allows the WorkOS provider to be used automatically without explicitly instantiating it in code.\n\n<Card>\n  <ParamField path=\"FASTMCP_SERVER_AUTH\" default=\"Not set\">\n    Set to `fastmcp.server.auth.providers.workos.WorkOSProvider` to use WorkOS authentication.\n  </ParamField>\n</Card>\n\n### WorkOS-Specific Configuration\n\nThese environment variables provide default values for the WorkOS provider, whether it's instantiated manually or configured via `FASTMCP_SERVER_AUTH`.\n\n<Card>\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID\" required>\n    Your WorkOS OAuth App Client ID (e.g., `client_01K33Y6GGS7T3AWMPJWKW42Y3Q`)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET\" required>\n    Your WorkOS OAuth App Client Secret\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_AUTHKIT_DOMAIN\" required>\n    Your WorkOS AuthKit domain (e.g., `https://your-app.authkit.app`)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_BASE_URL\" default=\"http://localhost:8000\">\n    Public URL where OAuth endpoints will be accessible (includes any mount path)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_ISSUER_URL\" default=\"Uses BASE_URL\">\n    Issuer URL for OAuth metadata (defaults to `BASE_URL`). Set to root-level URL when mounting under a path prefix to avoid 404 logs. See [HTTP Deployment guide](/deployment/http#mounting-authenticated-servers) for details.\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_REDIRECT_PATH\" default=\"/auth/callback\">\n    Redirect path configured in your WorkOS OAuth App\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_REQUIRED_SCOPES\" default=\"[]\">\n    Comma-, space-, or JSON-separated list of required OAuth scopes (e.g., `openid profile email` or `[\"openid\",\"profile\",\"email\"]`)\n  </ParamField>\n\n  <ParamField path=\"FASTMCP_SERVER_AUTH_WORKOS_TIMEOUT_SECONDS\" default=\"10\">\n    HTTP request timeout for WorkOS API calls\n  </ParamField>\n</Card>\n\nExample `.env` file:\n\n```bash  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\n# WorkOS OAuth credentials (always used as defaults)\nFASTMCP_SERVER_AUTH_WORKOS_CLIENT_ID=client_01K33Y6GGS7T3AWMPJWKW42Y3Q\nFASTMCP_SERVER_AUTH_WORKOS_CLIENT_SECRET=your_client_secret\nFASTMCP_SERVER_AUTH_WORKOS_AUTHKIT_DOMAIN=https://your-app.authkit.app\nFASTMCP_SERVER_AUTH_WORKOS_BASE_URL=https://your-server.com\nFASTMCP_SERVER_AUTH_WORKOS_REQUIRED_SCOPES=[\"openid\",\"profile\",\"email\"]\n\n# Optional: Automatically provision WorkOS auth for all servers\nFASTMCP_SERVER_AUTH=fastmcp.server.auth.providers.workos.WorkOSProvider\n```\n\nWith environment variables set, you can either:\n\n**Option 1: Manual instantiation (env vars provide defaults)**\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth.providers.workos import WorkOSProvider\n\n# Env vars provide default values for WorkOSProvider()\nauth = WorkOSProvider()  # Uses env var defaults\nmcp = FastMCP(name=\"WorkOS Protected Server\", auth=auth)\n```\n\n**Option 2: Automatic provisioning (requires FASTMCP\\_SERVER\\_AUTH=fastmcp.server.auth.providers.workos.WorkOSProvider)**\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\n\n# Auth is automatically provisioned from FASTMCP_SERVER_AUTH\nmcp = FastMCP(name=\"WorkOS Protected Server\")\n```\n\n## Configuration Options\n\n<Card>\n  <ParamField path=\"client_id\" required>\n    WorkOS OAuth application client ID\n  </ParamField>\n\n  <ParamField path=\"client_secret\" required>\n    WorkOS OAuth application client secret\n  </ParamField>\n\n  <ParamField path=\"authkit_domain\" required>\n    Your WorkOS AuthKit domain URL (e.g., `https://your-app.authkit.app`)\n  </ParamField>\n\n  <ParamField path=\"base_url\" required>\n    Your FastMCP server's public URL\n  </ParamField>\n\n  <ParamField path=\"required_scopes\" default=\"[]\">\n    OAuth scopes to request\n  </ParamField>\n\n  <ParamField path=\"redirect_path\" default=\"/auth/callback\">\n    OAuth callback path\n  </ParamField>\n\n  <ParamField path=\"timeout_seconds\" default=\"10\">\n    API request timeout\n  </ParamField>\n</Card>",
  "content_length": 10465
}