{
  "title": "OpenAI API ðŸ¤ FastMCP",
  "source_url": "https://gofastmcp.com/integrations/openai",
  "content": "Connect FastMCP servers to the OpenAI API\n\nexport const VersionBadge = ({version}) => {\n  return <code className=\"version-badge-container\">\n            <p className=\"version-badge\">\n                <span className=\"version-badge-label\">New in version:</span>Â \n                <code className=\"version-badge-version\">{version}</code>\n            </p>\n        </code>;\n};\n\n## Responses API\n\nOpenAI's [Responses API](https://platform.openai.com/docs/api-reference/responses) supports [MCP servers](https://platform.openai.com/docs/guides/tools-remote-mcp) as remote tool sources, allowing you to extend AI capabilities with custom functions.\n\n<Note>\n  The Responses API is a distinct API from OpenAI's Completions API or Assistants API. At this time, only the Responses API supports MCP.\n</Note>\n\n<Tip>\n  Currently, the Responses API only accesses **tools** from MCP serversâ€”it queries the `list_tools` endpoint and exposes those functions to the AI agent. Other MCP features like resources and prompts are not currently supported.\n</Tip>\n\n### Create a Server\n\nFirst, create a FastMCP server with the tools you want to expose. For this example, we'll create a server with a single tool that rolls dice.\n\n```python server.py theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nimport random\nfrom fastmcp import FastMCP\n\nmcp = FastMCP(name=\"Dice Roller\")\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    mcp.run(transport=\"http\", port=8000)\n```\n\n### Deploy the Server\n\nYour server must be deployed to a public URL in order for OpenAI to access it.\n\nFor development, you can use tools like `ngrok` to temporarily expose a locally-running server to the internet. We'll do that for this example (you may need to install `ngrok` and create a free account), but you can use any other method to deploy your server.\n\nAssuming you saved the above code as `server.py`, you can run the following two commands in two separate terminals to deploy your server and expose it to the internet:\n\n<CodeGroup>\n  ```bash FastMCP server theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\n  python server.py\n  ```\n\n  ```bash ngrok theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\n  ngrok http 8000\n  ```\n</CodeGroup>\n\n<Warning>\n  This exposes your unauthenticated server to the internet. Only run this command in a safe environment if you understand the risks.\n</Warning>\n\n### Call the Server\n\nTo use the Responses API, you'll need to install the OpenAI Python SDK (not included with FastMCP):\n\n```bash  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\npip install openai\n```\n\nYou'll also need to authenticate with OpenAI. You can do this by setting the `OPENAI_API_KEY` environment variable. Consult the OpenAI SDK documentation for more information.\n\n```bash  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nexport OPENAI_API_KEY=\"your-api-key\"\n```\n\nHere is an example of how to call your server from Python. Note that you'll need to replace `https://your-server-url.com` with the actual URL of your server. In addition, we use `/mcp/` as the endpoint because we deployed a streamable-HTTP server with the default path; you may need to use a different endpoint if you customized your server's deployment.\n\n```python {4, 11-16} theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom openai import OpenAI\n\n# Your server URL (replace with your actual URL)\nurl = 'https://your-server-url.com'\n\nclient = OpenAI()\n\nresp = client.responses.create(\n    model=\"gpt-4.1\",\n    tools=[\n        {\n            \"type\": \"mcp\",\n            \"server_label\": \"dice_server\",\n            \"server_url\": f\"{url}/mcp/\",\n            \"require_approval\": \"never\",\n        },\n    ],\n    input=\"Roll a few dice!\",\n)\n\nprint(resp.output_text)\n```\n\nIf you run this code, you'll see something like the following output:\n\n```text  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nYou rolled 3 dice and got the following results: 6, 4, and 2!\n```\n\n### Authentication\n\n<VersionBadge version=\"2.6.0\" />\n\nThe Responses API can include headers to authenticate the request, which means you don't have to worry about your server being publicly accessible.\n\n#### Server Authentication\n\nThe simplest way to add authentication to the server is to use a bearer token scheme.\n\nFor this example, we'll quickly generate our own tokens with FastMCP's `RSAKeyPair` utility, but this may not be appropriate for production use. For more details, see the complete server-side [Token Verification](/servers/auth/token-verification) documentation.\n\nWe'll start by creating an RSA key pair to sign and verify tokens.\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp.server.auth.providers.jwt import RSAKeyPair\n\nkey_pair = RSAKeyPair.generate()\naccess_token = key_pair.create_token(audience=\"dice-server\")\n```\n\n<Warning>\n  FastMCP's `RSAKeyPair` utility is for development and testing only.\n</Warning>\n\nNext, we'll create a `JWTVerifier` to authenticate the server.\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import JWTVerifier\n\nauth = JWTVerifier(\n    public_key=key_pair.public_key,\n    audience=\"dice-server\",\n)\n\nmcp = FastMCP(name=\"Dice Roller\", auth=auth)\n```\n\nHere is a complete example that you can copy/paste. For simplicity and the purposes of this example only, it will print the token to the console. **Do NOT do this in production!**\n\n```python server.py [expandable] theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom fastmcp import FastMCP\nfrom fastmcp.server.auth import JWTVerifier\nfrom fastmcp.server.auth.providers.jwt import RSAKeyPair\nimport random\n\nkey_pair = RSAKeyPair.generate()\naccess_token = key_pair.create_token(audience=\"dice-server\")\n\nauth = JWTVerifier(\n    public_key=key_pair.public_key,\n    audience=\"dice-server\",\n)\n\nmcp = FastMCP(name=\"Dice Roller\", auth=auth)\n\n@mcp.tool\ndef roll_dice(n_dice: int) -> list[int]:\n    \"\"\"Roll `n_dice` 6-sided dice and return the results.\"\"\"\n    return [random.randint(1, 6) for _ in range(n_dice)]\n\nif __name__ == \"__main__\":\n    print(f\"\\n---\\n\\nðŸ”‘ Dice Roller access token:\\n\\n{access_token}\\n\\n---\\n\")\n    mcp.run(transport=\"http\", port=8000)\n```\n\n#### Client Authentication\n\nIf you try to call the authenticated server with the same OpenAI code we wrote earlier, you'll get an error like this:\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\npythonAPIStatusError: Error code: 424 - {\n    \"error\": {\n        \"message\": \"Error retrieving tool list from MCP server: 'dice_server'. Http status code: 401 (Unauthorized)\",\n        \"type\": \"external_connector_error\",\n        \"param\": \"tools\",\n        \"code\": \"http_error\"\n    }\n}\n```\n\nAs expected, the server is rejecting the request because it's not authenticated.\n\nTo authenticate the client, you can pass the token in the `Authorization` header with the `Bearer` scheme:\n\n```python {4, 7, 19-21} [expandable] theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nfrom openai import OpenAI\n\n# Your server URL (replace with your actual URL)\nurl = 'https://your-server-url.com'\n\n# Your access token (replace with your actual token)\naccess_token = 'your-access-token'\n\nclient = OpenAI()\n\nresp = client.responses.create(\n    model=\"gpt-4.1\",\n    tools=[\n        {\n            \"type\": \"mcp\",\n            \"server_label\": \"dice_server\",\n            \"server_url\": f\"{url}/mcp/\",\n            \"require_approval\": \"never\",\n            \"headers\": {\n                \"Authorization\": f\"Bearer {access_token}\"\n            }\n        },\n    ],\n    input=\"Roll a few dice!\",\n)\n\nprint(resp.output_text)\n```\n\nYou should now see the dice roll results in the output.",
  "content_length": 7866
}