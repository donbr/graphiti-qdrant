{
  "title": "jwt",
  "source_url": "https://gofastmcp.com/python-sdk/fastmcp-server-auth-providers-jwt",
  "content": "# `fastmcp.server.auth.providers.jwt`\n\nTokenVerifier implementations for FastMCP.\n\n## Classes\n\n### `JWKData` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L27\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nJSON Web Key data structure.\n\n### `JWKSData` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L40\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nJSON Web Key Set data structure.\n\n### `RSAKeyPair` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L47\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nRSA key pair for JWT testing.\n\n**Methods:**\n\n#### `generate` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L54\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\ngenerate(cls) -> RSAKeyPair\n```\n\nGenerate an RSA key pair for testing.\n\n**Returns:**\n\n* Generated key pair\n\n#### `create_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L89\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\ncreate_token(self, subject: str = 'fastmcp-user', issuer: str = 'https://fastmcp.example.com', audience: str | list[str] | None = None, scopes: list[str] | None = None, expires_in_seconds: int = 3600, additional_claims: dict[str, Any] | None = None, kid: str | None = None) -> str\n```\n\nGenerate a test JWT token for testing purposes.\n\n**Args:**\n\n* `subject`: Subject claim (usually user ID)\n* `issuer`: Issuer claim\n* `audience`: Audience claim - can be a string or list of strings (optional)\n* `scopes`: List of scopes to include\n* `expires_in_seconds`: Token expiration time in seconds\n* `additional_claims`: Any additional claims to include\n* `kid`: Key ID to include in header\n\n### `JWTVerifierSettings` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L142\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nSettings for JWT token verification.\n\n### `JWTVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L165\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nJWT token verifier supporting both asymmetric (RSA/ECDSA) and symmetric (HMAC) algorithms.\n\nThis verifier validates JWT tokens using various signing algorithms:\n\n* **Asymmetric algorithms** (RS256/384/512, ES256/384/512, PS256/384/512):\n  Uses public/private key pairs. Ideal for external clients and services where\n  only the authorization server has the private key.\n* **Symmetric algorithms** (HS256/384/512): Uses a shared secret for both\n  signing and verification. Perfect for internal microservices and trusted\n  environments where the secret can be securely shared.\n\nUse this when:\n\n* You have JWT tokens issued by an external service (asymmetric)\n* You need JWKS support for automatic key rotation (asymmetric)\n* You have internal microservices sharing a secret key (symmetric)\n* Your tokens contain standard OAuth scopes and claims\n\n**Methods:**\n\n#### `load_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L367\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nload_access_token(self, token: str) -> AccessToken | None\n```\n\nValidate a JWT bearer token and return an AccessToken when the token is valid.\n\n**Args:**\n\n* `token`: The JWT bearer token string to validate.\n\n**Returns:**\n\n* AccessToken | None: An AccessToken populated from token claims if the token is valid; `None` if the token is expired, has an invalid signature or format, fails issuer/audience/scope validation, or any other validation error occurs.\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L485\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify a bearer token and return access info if valid.\n\nThis method implements the TokenVerifier protocol by delegating\nto our existing load\\_access\\_token method.\n\n**Args:**\n\n* `token`: The JWT token string to validate\n\n**Returns:**\n\n* AccessToken object if valid, None if invalid or expired\n\n### `StaticTokenVerifier` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L501\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nSimple static token verifier for testing and development.\n\nThis verifier validates tokens against a predefined dictionary of valid token\nstrings and their associated claims. When a token string matches a key in the\ndictionary, the verifier returns the corresponding claims as if the token was\nvalidated by a real authorization server.\n\nUse this when:\n\n* You're developing or testing locally without a real OAuth server\n* You need predictable tokens for automated testing\n* You want to simulate different users/scopes without complex setup\n* You're prototyping and need simple API key-style authentication\n\nWARNING: Never use this in production - tokens are stored in plain text!\n\n**Methods:**\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/providers/jwt.py#L535\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nverify_token(self, token: str) -> AccessToken | None\n```\n\nVerify token against static token dictionary.",
  "content_length": 6151
}