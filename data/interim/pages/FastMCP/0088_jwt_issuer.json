{
  "title": "jwt_issuer",
  "source_url": "https://gofastmcp.com/python-sdk/fastmcp-server-auth-jwt_issuer",
  "content": "# `fastmcp.server.auth.jwt_issuer`\n\nJWT token issuance and verification for FastMCP OAuth Proxy.\n\nThis module implements the token factory pattern for OAuth proxies, where the proxy\nissues its own JWT tokens to clients instead of forwarding upstream provider tokens.\nThis maintains proper OAuth 2.0 token audience boundaries.\n\n## Functions\n\n### `derive_jwt_key` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L37\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nderive_jwt_key() -> bytes\n```\n\nDerive JWT signing key from a high-entropy or low-entropy key material and server salt.\n\n## Classes\n\n### `JWTIssuer` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L74\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nIssues and validates FastMCP-signed JWT tokens using HS256.\n\nThis issuer creates JWT tokens for MCP clients with proper audience claims,\nmaintaining OAuth 2.0 token boundaries. Tokens are signed with HS256 using\na key derived from the upstream client secret.\n\n**Methods:**\n\n#### `issue_access_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L100\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nissue_access_token(self, client_id: str, scopes: list[str], jti: str, expires_in: int = 3600) -> str\n```\n\nIssue a minimal FastMCP access token.\n\nFastMCP tokens are reference tokens containing only the minimal claims\nneeded for validation and lookup. The JTI maps to the upstream token\nwhich contains actual user identity and authorization data.\n\n**Args:**\n\n* `client_id`: MCP client ID\n* `scopes`: Token scopes\n* `jti`: Unique token identifier (maps to upstream token)\n* `expires_in`: Token lifetime in seconds\n\n**Returns:**\n\n* Signed JWT token\n\n#### `issue_refresh_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L147\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nissue_refresh_token(self, client_id: str, scopes: list[str], jti: str, expires_in: int) -> str\n```\n\nIssue a minimal FastMCP refresh token.\n\nFastMCP refresh tokens are reference tokens containing only the minimal\nclaims needed for validation and lookup. The JTI maps to the upstream\ntoken which contains actual user identity and authorization data.\n\n**Args:**\n\n* `client_id`: MCP client ID\n* `scopes`: Token scopes\n* `jti`: Unique token identifier (maps to upstream token)\n* `expires_in`: Token lifetime in seconds (should match upstream refresh expiry)\n\n**Returns:**\n\n* Signed JWT token\n\n#### `verify_token` <sup><a href=\"https://github.com/jlowin/fastmcp/blob/main/src/fastmcp/server/auth/jwt_issuer.py#L195\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={\"theme\":{\"light\":\"snazzy-light\",\"dark\":\"dark-plus\"}}\nverify_token(self, token: str) -> dict[str, Any]\n```\n\nVerify and decode a FastMCP token.\n\nValidates JWT signature, expiration, issuer, and audience.\n\n**Args:**\n\n* `token`: JWT token to verify\n\n**Returns:**\n\n* Decoded token payload\n\n**Raises:**\n\n* `JoseError`: If token is invalid, expired, or has wrong claims",
  "content_length": 3517
}