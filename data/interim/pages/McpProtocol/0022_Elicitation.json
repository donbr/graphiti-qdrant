{
  "title": "Elicitation",
  "source_url": "https://modelcontextprotocol.io/specification/2025-11-25/client/elicitation",
  "content": "<div id=\"enable-section-numbers\" />\n\n<Info>**Protocol Revision**: 2025-11-25</Info>\n\nThe Model Context Protocol (MCP) provides a standardized way for servers to request additional\ninformation from users through the client during interactions. This flow allows clients to\nmaintain control over user interactions and data sharing while enabling servers to gather\nnecessary information dynamically.\n\nElicitation supports two modes:\n\n* **Form mode**: Servers can request structured data from users with optional JSON schemas to validate responses\n* **URL mode**: Servers can direct users to external URLs for sensitive interactions that must *not* pass through the MCP client\n\n## User Interaction Model\n\nElicitation in MCP allows servers to implement interactive workflows by enabling user input\nrequests to occur *nested* inside other MCP server features.\n\nImplementations are free to expose elicitation through any interface pattern that suits\ntheir needsâ€”the protocol itself does not mandate any specific user interaction\nmodel.\n\n<Warning>\n  For trust & safety and security:\n\n  * Servers **MUST NOT** use form mode elicitation to request sensitive information\n  * Servers **MUST** use URL mode for interactions involving sensitive information, such as credentials\n\n  MCP clients **MUST**:\n\n  * Provide UI that makes it clear which server is requesting information\n  * Respect user privacy and provide clear decline and cancel options\n  * For form mode, allow users to review and modify their responses before sending\n  * For URL mode, clearly display the target domain/host and gather user consent before navigation to the target URL\n</Warning>\n\n## Capabilities\n\nClients that support elicitation **MUST** declare the `elicitation` capability during\n[initialization](../basic/lifecycle#initialization):\n\n```json  theme={null}\n{\n  \"capabilities\": {\n    \"elicitation\": {\n      \"form\": {},\n      \"url\": {}\n    }\n  }\n}\n```\n\nFor backwards compatibility, an empty capabilities object is equivalent to declaring support for `form` mode only:\n\n```jsonc  theme={null}\n{\n  \"capabilities\": {\n    \"elicitation\": {}, // Equivalent to { \"form\": {} }\n  },\n}\n```\n\nClients declaring the `elicitation` capability **MUST** support at least one mode (`form` or `url`).\n\nServers **MUST NOT** send elicitation requests with modes that are not supported by the client.\n\n## Protocol Messages\n\n### Elicitation Requests\n\nTo request information from a user, servers send an `elicitation/create` request.\n\nAll elicitation requests **MUST** include the following parameters:\n\n| Name      | Type   | Options       | Description                                                                            |\n| --------- | ------ | ------------- | -------------------------------------------------------------------------------------- |\n| `mode`    | string | `form`, `url` | The mode of the elicitation. Optional for form mode (defaults to `\"form\"` if omitted). |\n| `message` | string |               | A human-readable message explaining why the interaction is needed.                     |\n\nThe `mode` parameter specifies the type of elicitation:\n\n* `\"form\"`: In-band structured data collection with optional schema validation. Data is exposed to the client.\n* `\"url\"`: Out-of-band interaction via URL navigation. Data (other than the URL itself) is **not** exposed to the client.\n\nFor backwards compatibility, servers **MAY** omit the `mode` field for form mode elicitation requests. Clients **MUST** treat requests without a `mode` field as form mode.\n\n### Form Mode Elicitation Requests\n\nForm mode elicitation allows servers to collect structured data directly through the MCP client.\n\nForm mode elicitation requests **MUST** either specify `mode: \"form\"` or omit the `mode` field, and include these additional parameters:\n\n| Name              | Type   | Description                                                    |\n| ----------------- | ------ | -------------------------------------------------------------- |\n| `requestedSchema` | object | A JSON Schema defining the structure of the expected response. |\n\n#### Requested Schema\n\nThe `requestedSchema` parameter allows servers to define the structure of the expected\nresponse using a restricted subset of JSON Schema.\n\nTo simplify client user experience, form mode elicitation schemas are limited to flat objects\nwith primitive properties only.\n\nThe schema is restricted to these primitive types:\n\n1. **String Schema**\n\n   ```json  theme={null}\n   {\n     \"type\": \"string\",\n     \"title\": \"Display Name\",\n     \"description\": \"Description text\",\n     \"minLength\": 3,\n     \"maxLength\": 50,\n     \"pattern\": \"^[A-Za-z]+$\",\n     \"format\": \"email\",\n     \"default\": \"user@example.com\"\n   }\n   ```\n\n   Supported formats: `email`, `uri`, `date`, `date-time`\n\n2. **Number Schema**\n\n   ```json  theme={null}\n   {\n     \"type\": \"number\", // or \"integer\"\n     \"title\": \"Display Name\",\n     \"description\": \"Description text\",\n     \"minimum\": 0,\n     \"maximum\": 100,\n     \"default\": 50\n   }\n   ```\n\n3. **Boolean Schema**\n\n   ```json  theme={null}\n   {\n     \"type\": \"boolean\",\n     \"title\": \"Display Name\",\n     \"description\": \"Description text\",\n     \"default\": false\n   }\n   ```\n\n4. **Enum Schema**\n\n   Single-select enum (without titles):\n\n   ```json  theme={null}\n   {\n     \"type\": \"string\",\n     \"title\": \"Color Selection\",\n     \"description\": \"Choose your favorite color\",\n     \"enum\": [\"Red\", \"Green\", \"Blue\"],\n     \"default\": \"Red\"\n   }\n   ```\n\n   Single-select enum (with titles):\n\n   ```json  theme={null}\n   {\n     \"type\": \"string\",\n     \"title\": \"Color Selection\",\n     \"description\": \"Choose your favorite color\",\n     \"oneOf\": [\n       { \"const\": \"#FF0000\", \"title\": \"Red\" },\n       { \"const\": \"#00FF00\", \"title\": \"Green\" },\n       { \"const\": \"#0000FF\", \"title\": \"Blue\" }\n     ],\n     \"default\": \"#FF0000\"\n   }\n   ```\n\n   Multi-select enum (without titles):\n\n   ```json  theme={null}\n   {\n     \"type\": \"array\",\n     \"title\": \"Color Selection\",\n     \"description\": \"Choose your favorite colors\",\n     \"minItems\": 1,\n     \"maxItems\": 2,\n     \"items\": {\n       \"type\": \"string\",\n       \"enum\": [\"Red\", \"Green\", \"Blue\"]\n     },\n     \"default\": [\"Red\", \"Green\"]\n   }\n   ```\n\n   Multi-select enum (with titles):\n\n   ```json  theme={null}\n   {\n     \"type\": \"array\",\n     \"title\": \"Color Selection\",\n     \"description\": \"Choose your favorite colors\",\n     \"minItems\": 1,\n     \"maxItems\": 2,\n     \"items\": {\n       \"anyOf\": [\n         { \"const\": \"#FF0000\", \"title\": \"Red\" },\n         { \"const\": \"#00FF00\", \"title\": \"Green\" },\n         { \"const\": \"#0000FF\", \"title\": \"Blue\" }\n       ]\n     },\n     \"default\": [\"#FF0000\", \"#00FF00\"]\n   }\n   ```\n\nClients can use this schema to:\n\n1. Generate appropriate input forms\n2. Validate user input before sending\n3. Provide better guidance to users\n\nAll primitive types support optional default values to provide sensible starting points. Clients that support defaults SHOULD pre-populate form fields with these values.\n\nNote that complex nested structures, arrays of objects (beyond enums), and other advanced JSON Schema features are intentionally not supported to simplify client user experience.\n\n#### Example: Simple Text Request\n\n**Request:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"method\": \"elicitation/create\",\n  \"params\": {\n    \"mode\": \"form\",\n    \"message\": \"Please provide your GitHub username\",\n    \"requestedSchema\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        }\n      },\n      \"required\": [\"name\"]\n    }\n  }\n}\n```\n\n**Response:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"result\": {\n    \"action\": \"accept\",\n    \"content\": {\n      \"name\": \"octocat\"\n    }\n  }\n}\n```\n\n#### Example: Structured Data Request\n\n**Request:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 2,\n  \"method\": \"elicitation/create\",\n  \"params\": {\n    \"mode\": \"form\",\n    \"message\": \"Please provide your contact information\",\n    \"requestedSchema\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"description\": \"Your full name\"\n        },\n        \"email\": {\n          \"type\": \"string\",\n          \"format\": \"email\",\n          \"description\": \"Your email address\"\n        },\n        \"age\": {\n          \"type\": \"number\",\n          \"minimum\": 18,\n          \"description\": \"Your age\"\n        }\n      },\n      \"required\": [\"name\", \"email\"]\n    }\n  }\n}\n```\n\n**Response:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 2,\n  \"result\": {\n    \"action\": \"accept\",\n    \"content\": {\n      \"name\": \"Monalisa Octocat\",\n      \"email\": \"octocat@github.com\",\n      \"age\": 30\n    }\n  }\n}\n```\n\n### URL Mode Elicitation Requests\n\n<Note>\n  **New feature:** URL mode elicitation is introduced in the `2025-11-25` version of the MCP specification. Its design and implementation may change in future protocol revisions.\n</Note>\n\nURL mode elicitation enables servers to direct users to external URLs for out-of-band interactions that must not pass through the MCP client. This is essential for auth flows, payment processing, and other sensitive or secure operations.\n\nURL mode elicitation requests **MUST** specify `mode: \"url\"`, a `message`, and include these additional parameters:\n\n| Name            | Type   | Description                               |\n| --------------- | ------ | ----------------------------------------- |\n| `url`           | string | The URL that the user should navigate to. |\n| `elicitationId` | string | A unique identifier for the elicitation.  |\n\nThe `url` parameter **MUST** contain a valid URL.\n\n<Note>\n  **Important**: URL mode elicitation is *not* for authorizing the MCP client's\n  access to the MCP server (that's handled by [MCP\n  authorization](../basic/authorization)). Instead, it's used when the MCP\n  server needs to obtain sensitive information or third-party authorization on\n  behalf of the user. The MCP client's bearer token remains unchanged. The\n  client's only responsibility is to provide the user with context about the\n  elicitation URL the server wants them to open.\n</Note>\n\n#### Example: Request Sensitive Data\n\nThis example shows a URL mode elicitation request directing the user to a secure URL where they can provide sensitive information (an API key, for example).\nThe same request could direct the user into an OAuth authorization flow, or a payment flow. The only difference is the URL and the message.\n\n**Request:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 3,\n  \"method\": \"elicitation/create\",\n  \"params\": {\n    \"mode\": \"url\",\n    \"elicitationId\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"url\": \"https://mcp.example.com/ui/set_api_key\",\n    \"message\": \"Please provide your API key to continue.\"\n  }\n}\n```\n\n**Response:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 3,\n  \"result\": {\n    \"action\": \"accept\"\n  }\n}\n```\n\nThe response with `action: \"accept\"` indicates that the user has consented to the\ninteraction. It does not mean that the interaction is complete. The interaction occurs out\nof band and the client is not aware of the outcome until and unless the server sends a notification indicating completion.\n\n### Completion Notifications for URL Mode Elicitation\n\nServers **MAY** send a `notifications/elicitation/complete` notification when an\nout-of-band interaction started by URL mode elicitation is completed. This allows clients to react programmatically if appropriate.\n\nServers sending notifications:\n\n* **MUST** only send the notification to the client that initiated the elicitation request.\n* **MUST** include the `elicitationId` established in the original `elicitation/create` request.\n\nClients:\n\n* **MUST** ignore notifications referencing unknown or already-completed IDs.\n* **MAY** wait for this notification to automatically retry requests that received a [URLElicitationRequiredError](#error-handling), update the user interface, or otherwise continue an interaction.\n* **SHOULD** still provide manual controls that let the user retry or cancel the original request (or otherwise resume interacting with the client) if the notification never arrives.\n\n#### Example\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"notifications/elicitation/complete\",\n  \"params\": {\n    \"elicitationId\": \"550e8400-e29b-41d4-a716-446655440000\"\n  }\n}\n```\n\n### URL Elicitation Required Error\n\nWhen a request cannot be processed until an elicitation is completed, the server **MAY** return a [`URLElicitationRequiredError`](#error-handling) (code `-32042`) to indicate to the client that a URL mode elicitation is required. The server **MUST NOT** return this error except when URL mode elicitation is required.\n\nThe error **MUST** include a list of elicitations that are required to complete before the original can be retried.\n\nAny elicitations returned in the error **MUST** be URL mode elicitations and have an `elicitationId` property.\n\n**Error Response:**\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 2,\n  \"error\": {\n    \"code\": -32042, // URL_ELICITATION_REQUIRED\n    \"message\": \"This request requires more information.\",\n    \"data\": {\n      \"elicitations\": [\n        {\n          \"mode\": \"url\",\n          \"elicitationId\": \"550e8400-e29b-41d4-a716-446655440000\",\n          \"url\": \"https://mcp.example.com/connect?elicitationId=550e8400-e29b-41d4-a716-446655440000\",\n          \"message\": \"Authorization is required to access your Example Co files.\"\n        }\n      ]\n    }\n  }\n}\n```\n\n## Message Flow\n\n### Form Mode Flow\n\n```mermaid  theme={null}\nsequenceDiagram\n    participant User\n    participant Client\n    participant Server\n\n    Note over Server: Server initiates elicitation\n    Server->>Client: elicitation/create (mode: form)\n\n    Note over User,Client: Present elicitation UI\n    User-->>Client: Provide requested information\n\n    Note over Server,Client: Complete request\n    Client->>Server: Return user response\n\n    Note over Server: Continue processing with new information\n```\n\n### URL Mode Flow\n\n```mermaid  theme={null}\nsequenceDiagram\n    participant UserAgent as User Agent (Browser)\n    participant User\n    participant Client\n    participant Server\n\n    Note over Server: Server initiates elicitation\n    Server->>Client: elicitation/create (mode: url)\n\n    Client->>User: Present consent to open URL\n    User-->>Client: Provide consent\n\n    Client->>UserAgent: Open URL\n    Client->>Server: Accept response\n\n    Note over User,UserAgent: User interaction\n    UserAgent-->>Server: Interaction complete\n    Server-->>Client: notifications/elicitation/complete (optional)\n\n    Note over Server: Continue processing with new information\n```\n\n### URL Mode With Elicitation Required Error Flow\n\n```mermaid  theme={null}\nsequenceDiagram\n    participant UserAgent as User Agent (Browser)\n    participant User\n    participant Client\n    participant Server\n\n    Client->>Server: tools/call\n\n    Note over Server: Server needs authorization\n    Server->>Client: URLElicitationRequiredError\n    Note over Client: Client notes the original request can be retried after elicitation\n\n    Client->>User: Present consent to open URL\n    User-->>Client: Provide consent\n\n    Client->>UserAgent: Open URL\n\n    Note over User,UserAgent: User interaction\n\n    UserAgent-->>Server: Interaction complete\n    Server-->>Client: notifications/elicitation/complete (optional)\n\n    Client->>Server: Retry tools/call (optional)\n```\n\n## Response Actions\n\nElicitation responses use a three-action model to clearly distinguish between different user actions. These actions apply to both form and URL elicitation modes.\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"result\": {\n    \"action\": \"accept\", // or \"decline\" or \"cancel\"\n    \"content\": {\n      \"propertyName\": \"value\",\n      \"anotherProperty\": 42\n    }\n  }\n}\n```\n\nThe three response actions are:\n\n1. **Accept** (`action: \"accept\"`): User explicitly approved and submitted with data\n   * For form mode: The `content` field contains the submitted data matching the requested schema\n   * For URL mode: The `content` field is omitted\n   * Example: User clicked \"Submit\", \"OK\", \"Confirm\", etc.\n\n2. **Decline** (`action: \"decline\"`): User explicitly declined the request\n   * The `content` field is typically omitted\n   * Example: User clicked \"Reject\", \"Decline\", \"No\", etc.\n\n3. **Cancel** (`action: \"cancel\"`): User dismissed without making an explicit choice\n   * The `content` field is typically omitted\n   * Example: User closed the dialog, clicked outside, pressed Escape, browser failed to load, etc.\n\nServers should handle each state appropriately:\n\n* **Accept**: Process the submitted data\n* **Decline**: Handle explicit decline (e.g., offer alternatives)\n* **Cancel**: Handle dismissal (e.g., prompt again later)\n\n## Implementation Considerations\n\n### Statefulness\n\nMost practical uses of elicitation require that the server maintain state about users:\n\n* Whether required information has been collected (e.g., the user's display name via form mode elicitation)\n* Status of resource access (e.g., API keys or a payment flow via URL mode elicitation)\n\nServers implementing elicitation **MUST** securely associate this state with individual users following the guidelines in the [security best practices](../basic/security_best_practices) document. Specifically:\n\n* State **MUST NOT** be associated with session IDs alone\n* State storage **MUST** be protected against unauthorized access\n* For remote MCP servers, user identification **MUST** be derived from credentials acquired via [MCP authorization](../basic/authorization) when possible (e.g. `sub` claim)\n\n<Note>\n  The examples in this section are non-normative and illustrate potential uses\n  of elicitation. Implementers should adapt these patterns to their specific\n  requirements while maintaining security best practices.\n</Note>\n\n### URL Mode Elicitation for Sensitive Data\n\nFor servers that interact with external APIs requiring sensitive information (e.g., credentials, payment information), URL mode elicitation provides a secure mechanism for users to provide this information without exposing it to the MCP client.\n\nIn this pattern:\n\n1. The server directs users to a secure web page (served over HTTPS)\n2. The page presents a branded form UI on a domain the user trusts\n3. Users enter sensitive credentials directly into the secure form\n4. The server stores credentials securely, bound to the user's identity\n5. Subsequent MCP requests use these stored credentials for API access\n\nThis approach ensures that sensitive credentials never pass through the LLM context, MCP client or any intermediate MCP servers, reducing the risk of exposure through client-side logging or other attack vectors.\n\n### URL Mode Elicitation for OAuth Flows\n\nURL mode elicitation enables a pattern where MCP servers act as OAuth clients to third-party resource servers.\nAuthorization with external APIs enabled by URL mode elicitation is separate from [MCP authorization](../basic/authorization). MCP servers **MUST NOT** rely on URL mode elicitation to authorize users for themselves.\n\n#### Understanding the Distinction\n\n* **MCP Authorization**: Required OAuth flow between the MCP client and MCP server (covered in the [authorization specification](../basic/authorization))\n* **External (third-party) Authorization**: Optional authorization between the MCP server and a third-party resource server, initiated via URL mode elicitation\n\nIn external authorization, the server acts as both:\n\n* An OAuth resource server (to the MCP client)\n* An OAuth client (to the third-party resource server)\n\nExample scenario:\n\n* An MCP client connects to an MCP server\n* The MCP server integrates with various different third-party services\n* When the MCP client calls a tool that requires access to a third-party service, the MCP server needs credentials for that service\n\nThe critical security requirements are:\n\n1. **The third-party credentials MUST NOT transit through the MCP client**: The client must never see third-party credentials to protect the security boundary\n2. **The MCP server MUST NOT use the client's credentials for the third-party service**: That would be [token passthrough](../basic/security_best_practices#token-passthrough), which is forbidden\n3. **The user MUST authorize the MCP server directly**: The interaction happens outside the MCP protocol, without involving the MCP client\n4. **The MCP server is responsible for tokens**: The MCP server is responsible for storing and managing the third-party tokens obtained through the URL mode elicitation (in other words, the MCP server must be stateful).\n\nCredentials obtained via URL mode elicitation are distinct from the MCP server credentials used by the MCP client. The MCP server **MUST NOT** transmit credentials obtained through URL mode elicitation to the MCP client.\n\n<Note>\n  For additional background, refer to the [token passthrough\n  section](../basic/security_best_practices#token-passthrough) of the Security\n  Best Practices document to understand why MCP servers cannot act as\n  pass-through proxies.\n</Note>\n\n#### Implementation Pattern\n\nWhen implementing external authorization via URL mode elicitation:\n\n1. The MCP server generates an authorization URL, acting as an OAuth client to the third-party service\n2. The MCP server stores internal state that associates (binds) the elicitation request with the user's identity.\n3. The MCP server sends a URL mode elicitation request to the client with a URL that can start the authorization flow.\n4. The user completes the OAuth flow directly with the third-party authorization server\n5. The third-party authorization server redirects back to the MCP server\n6. The MCP server securely stores the third-party tokens, bound to the user's identity\n7. Future MCP requests can leverage these stored tokens for API access to the third-party resource server\n\nThe following is a non-normative example of how this pattern could be implemented:\n\n```mermaid  theme={null}\nsequenceDiagram\n    participant User\n    participant UserAgent as User Agent (Browser)\n    participant 3AS as 3rd Party AS\n    participant 3RS as 3rd Party RS\n    participant Client as MCP Client\n    participant Server as MCP Server\n\n    Client->>Server: tools/call\n    Note over Server: Needs 3rd-party authorization for user\n    Note over Server: Store state (bind the elicitation request to the user)\n    Server->>Client: URLElicitationRequiredError<br> (mode: \"url\", url: \"https://mcp.example.com/connect?...\")\n    Note over Client: Client notes the tools/call request can be retried later\n    Client->>User: Present consent to open URL\n    User->>Client: Provide consent\n    Client->>UserAgent: Open URL\n    Client->>Server: Accept response\n    UserAgent->>Server: Load connect route\n    Note over Server: Confirm: user is logged into MCP Server or MCP AS<br>Confirm: elicitation user matches session user\n    Server->>UserAgent: Redirect to third-party authorization endpoint\n    UserAgent->>3AS: Load authorize route\n    Note over 3AS,User: User interaction (OAuth flow):<br>User consents to scoped MCP Server access\n    3AS->>UserAgent: redirect to MCP Server's redirect_uri\n    UserAgent->>Server: load redirect_uri page\n    Note over Server: Confirm: redirect_uri belongs to MCP Server\n    Server->>3AS: Exchange authorization code for  OAuth tokens\n    3AS->>Server: Grants tokens\n    Note over Server: Bind tokens to MCP user identity\n    Server-->>Client: notifications/elicitation/complete (optional)\n    Client->>Server: Retry tools/call\n    Note over Server: Retrieve token bound to user identity\n    Server->>3RS: Call 3rd-party API\n```\n\nThis pattern maintains clear security boundaries while enabling rich integrations with third-party services that require user authorization.\n\n## Error Handling\n\nServers **MUST** return standard JSON-RPC errors for common failure cases:\n\n* When a request cannot be processed until an elicitation is completed: `-32042` (`URLElicitationRequiredError`)\n\nClients **MUST** return standard JSON-RPC errors for common failure cases:\n\n* Server sends an `elicitation/create` request with a mode not declared in client capabilities: `-32602` (Invalid params)\n\n## Security Considerations\n\n1. Servers **MUST** bind elicitation requests to the client and user identity\n2. Clients **MUST** provide clear indication of which server is requesting information\n3. Clients **SHOULD** implement user approval controls\n4. Clients **SHOULD** allow users to decline elicitation requests at any time\n5. Clients **SHOULD** implement rate limiting\n6. Clients **SHOULD** present elicitation requests in a way that makes it clear what information is being requested and why\n\n### Safe URL Handling\n\nMCP servers requesting elicitation:\n\n1. **MUST NOT** include sensitive information about the end-user, including credentials, personal identifiable information, etc., in the URL sent to the client in a URL elicitation request.\n2. **MUST NOT** provide a URL which is pre-authenticated to access a protected resource, as the URL could be used to impersonate the user by a malicious client.\n3. **SHOULD NOT** include URLs intended to be clickable in any field of a form mode elicitation request.\n4. **SHOULD** use HTTPS URLs for non-development environments.\n\nThese server requirements ensure that client implementations have clear rules about when to present a URL to the user, so that the client-side rules (below) can be consistently applied.\n\nClients implementing URL mode elicitation **MUST** handle URLs carefully to prevent users from unknowingly clicking malicious links.\n\nWhen handling URL mode elicitation requests, MCP clients:\n\n1. **MUST NOT** automatically pre-fetch the URL or any of its metadata.\n2. **MUST NOT** open the URL without explicit consent from the user.\n3. **MUST** show the full URL to the user for examination before consent.\n4. **MUST** open the URL provided by the server in a secure manner that does not enable the client or LLM to inspect the content or user inputs.\n   For example, on iOS, [SFSafariViewController](https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller) is good, but [WkWebView](https://developer.apple.com/documentation/webkit/wkwebview) is not.\n5. **SHOULD** highlight the domain of the URL to mitigate subdomain spoofing.\n6. **SHOULD** have warnings for ambiguous/suspicious URIs (i.e., containing Punycode).\n7. **SHOULD NOT** render URLs as clickable in any field of an elicitation request, except for the `url` field in a URL elicitation request (with the restrictions detailed above).\n\n### Identifying the User\n\nServers **MUST NOT** rely on client-provided user identification without server verification, as this can be forged.\nInstead, servers **SHOULD** follow [security best practices](../basic/security_best_practices).\n\nNon-normative examples:\n\n* Incorrect: Treat user input like \"I am [joe@example.com](mailto:joe@example.com)\" as authoritative\n* Correct: Rely on [authorization](../basic/authorization) to identify the user\n\n### Form Mode Security\n\n1. Servers **MUST NOT** request sensitive information (passwords, API keys, etc.) via form mode\n2. Clients **SHOULD** validate all responses against the provided schema\n3. Servers **SHOULD** validate received data matches the requested schema\n\n#### Phishing\n\nURL mode elicitation returns a URL that an attacker can use to send to a victim. The MCP Server **MUST** verify the identity of the user who opens the URL before accepting information.\n\nTypically identity verification is done by leveraging the [MCP authorization server](../basic/authorization) to identify the user, through a session cookie or equivalent in the browser.\n\nFor example, URL mode elicitation may be used to perform OAuth flows where the server acts as an OAuth client of another resource server. Without proper mitigation, the following phishing attack is possible:\n\n1. A malicious user (Alice) connected to a benign server triggers an elicitation request\n2. The benign server generates an authorization URL, acting as an OAuth client of a third-party authorization server\n3. Alice's client displays the URL and asks for consent\n4. Instead of clicking on the link, Alice tricks a victim user (Bob) of the same benign server into clicking it\n5. Bob opens the link and completes the authorization, thinking they are authorizing their own connection to the benign server\n6. The benign server receives a callback/redirect form the third-party authorization server, and assumes it's Alice's request\n7. The tokens for the third-party server are bound to Alice's session and identity, instead of Bob's, resulting in an account takeover\n\nTo prevent this attack, the server **MUST** ensure that the user who started the elicitation request (the end-user who is accessing the server via the MCP client) is the same user who completes the authorization flow.\n\nThere are many ways to achieve this and the best way will depend on the specific implementation.\n\nAs a common, non-normative example, consider a case where the MCP server is accessible via the web and desires to perform a third-party authorization code flow.\nTo prevent the phishing attack, the server would create a URL mode elicitation to `https://mcp.example.com/connect?elicitationId=...` rather than the third-party authorization endpoint.\nThis \"connect URL\" must ensure the user who opened the page is the same user who the elicitation was generated for.\nIt would, for example, check that the user has a valid session cookie and that the session cookie is for the same user who was using the MCP client to generate the URL mode elicitation.\nThis could be done by comparing the authoritative subject (`sub` claim) from the MCP server's authorization server to the subject from the session cookie.\nOnce that page ensures the same user, it can send the user to the third-party authorization server at `https://example.com/authorize?...` where a normal OAuth flow can be completed.\n\nIn other cases, the server may not be accessible via the web and may not be able to use a session cookie to identify the user.\nIn this case, the server must use a different mechanism to identify the user who opens the elicitation URL is the same user who the elicitation was generated for.\n\nIn all implementations, the server **MUST** ensure that the mechanism to determine the user's identity is resilient to attacks where an attacker can modify the elicitation URL.",
  "content_length": 30403
}