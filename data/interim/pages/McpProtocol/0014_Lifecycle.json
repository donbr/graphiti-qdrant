{
  "title": "Lifecycle",
  "source_url": "https://modelcontextprotocol.io/specification/2025-11-25/basic/lifecycle",
  "content": "<div id=\"enable-section-numbers\" />\n\n<Info>**Protocol Revision**: 2025-11-25</Info>\n\nThe Model Context Protocol (MCP) defines a rigorous lifecycle for client-server\nconnections that ensures proper capability negotiation and state management.\n\n1. **Initialization**: Capability negotiation and protocol version agreement\n2. **Operation**: Normal protocol communication\n3. **Shutdown**: Graceful termination of the connection\n\n```mermaid  theme={null}\nsequenceDiagram\n    participant Client\n    participant Server\n\n    Note over Client,Server: Initialization Phase\n    activate Client\n    Client->>+Server: initialize request\n    Server-->>Client: initialize response\n    Client--)Server: initialized notification\n\n    Note over Client,Server: Operation Phase\n    rect rgb(200, 220, 250)\n        note over Client,Server: Normal protocol operations\n    end\n\n    Note over Client,Server: Shutdown\n    Client--)-Server: Disconnect\n    deactivate Server\n    Note over Client,Server: Connection closed\n```\n\n## Lifecycle Phases\n\n### Initialization\n\nThe initialization phase **MUST** be the first interaction between client and server.\nDuring this phase, the client and server:\n\n* Establish protocol version compatibility\n* Exchange and negotiate capabilities\n* Share implementation details\n\nThe client **MUST** initiate this phase by sending an `initialize` request containing:\n\n* Protocol version supported\n* Client capabilities\n* Client implementation information\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"method\": \"initialize\",\n  \"params\": {\n    \"protocolVersion\": \"2024-11-05\",\n    \"capabilities\": {\n      \"roots\": {\n        \"listChanged\": true\n      },\n      \"sampling\": {},\n      \"elicitation\": {\n        \"form\": {},\n        \"url\": {}\n      },\n      \"tasks\": {\n        \"requests\": {\n          \"elicitation\": {\n            \"create\": {}\n          },\n          \"sampling\": {\n            \"createMessage\": {}\n          }\n        }\n      }\n    },\n    \"clientInfo\": {\n      \"name\": \"ExampleClient\",\n      \"title\": \"Example Client Display Name\",\n      \"version\": \"1.0.0\",\n      \"description\": \"An example MCP client application\",\n      \"icons\": [\n        {\n          \"src\": \"https://example.com/icon.png\",\n          \"mimeType\": \"image/png\",\n          \"sizes\": [\"48x48\"]\n        }\n      ],\n      \"websiteUrl\": \"https://example.com\"\n    }\n  }\n}\n```\n\nThe server **MUST** respond with its own capabilities and information:\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"result\": {\n    \"protocolVersion\": \"2024-11-05\",\n    \"capabilities\": {\n      \"logging\": {},\n      \"prompts\": {\n        \"listChanged\": true\n      },\n      \"resources\": {\n        \"subscribe\": true,\n        \"listChanged\": true\n      },\n      \"tools\": {\n        \"listChanged\": true\n      },\n      \"tasks\": {\n        \"list\": {},\n        \"cancel\": {},\n        \"requests\": {\n          \"tools\": {\n            \"call\": {}\n          }\n        }\n      }\n    },\n    \"serverInfo\": {\n      \"name\": \"ExampleServer\",\n      \"title\": \"Example Server Display Name\",\n      \"version\": \"1.0.0\",\n      \"description\": \"An example MCP server providing tools and resources\",\n      \"icons\": [\n        {\n          \"src\": \"https://example.com/server-icon.svg\",\n          \"mimeType\": \"image/svg+xml\",\n          \"sizes\": [\"any\"]\n        }\n      ],\n      \"websiteUrl\": \"https://example.com/server\"\n    },\n    \"instructions\": \"Optional instructions for the client\"\n  }\n}\n```\n\nAfter successful initialization, the client **MUST** send an `initialized` notification\nto indicate it is ready to begin normal operations:\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"notifications/initialized\"\n}\n```\n\n* The client **SHOULD NOT** send requests other than\n  [pings](/specification/2025-11-25/basic/utilities/ping) before the server has responded to the\n  `initialize` request.\n* The server **SHOULD NOT** send requests other than\n  [pings](/specification/2025-11-25/basic/utilities/ping) and\n  [logging](/specification/2025-11-25/server/utilities/logging) before receiving the `initialized`\n  notification.\n\n#### Version Negotiation\n\nIn the `initialize` request, the client **MUST** send a protocol version it supports.\nThis **SHOULD** be the *latest* version supported by the client.\n\nIf the server supports the requested protocol version, it **MUST** respond with the same\nversion. Otherwise, the server **MUST** respond with another protocol version it\nsupports. This **SHOULD** be the *latest* version supported by the server.\n\nIf the client does not support the version in the server's response, it **SHOULD**\ndisconnect.\n\n<Note>\n  If using HTTP, the client **MUST** include the `MCP-Protocol-Version: <protocol-version>` HTTP header on all subsequent requests to the MCP\n  server.\n  For details, see [the Protocol Version Header section in Transports](/specification/2025-11-25/basic/transports#protocol-version-header).\n</Note>\n\n#### Capability Negotiation\n\nClient and server capabilities establish which optional protocol features will be\navailable during the session.\n\nKey capabilities include:\n\n| Category | Capability     | Description                                                                                   |\n| -------- | -------------- | --------------------------------------------------------------------------------------------- |\n| Client   | `roots`        | Ability to provide filesystem [roots](/specification/2025-11-25/client/roots)                 |\n| Client   | `sampling`     | Support for LLM [sampling](/specification/2025-11-25/client/sampling) requests                |\n| Client   | `elicitation`  | Support for server [elicitation](/specification/2025-11-25/client/elicitation) requests       |\n| Client   | `tasks`        | Support for [task-augmented](/specification/2025-11-25/basic/utilities/tasks) client requests |\n| Client   | `experimental` | Describes support for non-standard experimental features                                      |\n| Server   | `prompts`      | Offers [prompt templates](/specification/2025-11-25/server/prompts)                           |\n| Server   | `resources`    | Provides readable [resources](/specification/2025-11-25/server/resources)                     |\n| Server   | `tools`        | Exposes callable [tools](/specification/2025-11-25/server/tools)                              |\n| Server   | `logging`      | Emits structured [log messages](/specification/2025-11-25/server/utilities/logging)           |\n| Server   | `completions`  | Supports argument [autocompletion](/specification/2025-11-25/server/utilities/completion)     |\n| Server   | `tasks`        | Support for [task-augmented](/specification/2025-11-25/basic/utilities/tasks) server requests |\n| Server   | `experimental` | Describes support for non-standard experimental features                                      |\n\nCapability objects can describe sub-capabilities like:\n\n* `listChanged`: Support for list change notifications (for prompts, resources, and\n  tools)\n* `subscribe`: Support for subscribing to individual items' changes (resources only)\n\n### Operation\n\nDuring the operation phase, the client and server exchange messages according to the\nnegotiated capabilities.\n\nBoth parties **MUST**:\n\n* Respect the negotiated protocol version\n* Only use capabilities that were successfully negotiated\n\n### Shutdown\n\nDuring the shutdown phase, one side (usually the client) cleanly terminates the protocol\nconnection. No specific shutdown messages are definedâ€”instead, the underlying transport\nmechanism should be used to signal connection termination:\n\n#### stdio\n\nFor the stdio [transport](/specification/2025-11-25/basic/transports), the client **SHOULD** initiate\nshutdown by:\n\n1. First, closing the input stream to the child process (the server)\n2. Waiting for the server to exit, or sending `SIGTERM` if the server does not exit\n   within a reasonable time\n3. Sending `SIGKILL` if the server does not exit within a reasonable time after `SIGTERM`\n\nThe server **MAY** initiate shutdown by closing its output stream to the client and\nexiting.\n\n#### HTTP\n\nFor HTTP [transports](/specification/2025-11-25/basic/transports), shutdown is indicated by closing the\nassociated HTTP connection(s).\n\n## Timeouts\n\nImplementations **SHOULD** establish timeouts for all sent requests, to prevent hung\nconnections and resource exhaustion. When the request has not received a success or error\nresponse within the timeout period, the sender **SHOULD** issue a [cancellation\nnotification](/specification/2025-11-25/basic/utilities/cancellation) for that request and stop waiting for\na response.\n\nSDKs and other middleware **SHOULD** allow these timeouts to be configured on a\nper-request basis.\n\nImplementations **MAY** choose to reset the timeout clock when receiving a [progress\nnotification](/specification/2025-11-25/basic/utilities/progress) corresponding to the request, as this\nimplies that work is actually happening. However, implementations **SHOULD** always\nenforce a maximum timeout, regardless of progress notifications, to limit the impact of a\nmisbehaving client or server.\n\n## Error Handling\n\nImplementations **SHOULD** be prepared to handle these error cases:\n\n* Protocol version mismatch\n* Failure to negotiate required capabilities\n* Request [timeouts](#timeouts)\n\nExample initialization error:\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"error\": {\n    \"code\": -32602,\n    \"message\": \"Unsupported protocol version\",\n    \"data\": {\n      \"supported\": [\"2024-11-05\"],\n      \"requested\": \"1.0.0\"\n    }\n  }\n}\n```",
  "content_length": 9537
}