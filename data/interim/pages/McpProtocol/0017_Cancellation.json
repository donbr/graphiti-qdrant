{
  "title": "Cancellation",
  "source_url": "https://modelcontextprotocol.io/specification/2025-11-25/basic/utilities/cancellation",
  "content": "<div id=\"enable-section-numbers\" />\n\n<Info>**Protocol Revision**: 2025-11-25</Info>\n\nThe Model Context Protocol (MCP) supports optional cancellation of in-progress requests\nthrough notification messages. Either side can send a cancellation notification to\nindicate that a previously-issued request should be terminated.\n\n## Cancellation Flow\n\nWhen a party wants to cancel an in-progress request, it sends a `notifications/cancelled`\nnotification containing:\n\n* The ID of the request to cancel\n* An optional reason string that can be logged or displayed\n\n```json  theme={null}\n{\n  \"jsonrpc\": \"2.0\",\n  \"method\": \"notifications/cancelled\",\n  \"params\": {\n    \"requestId\": \"123\",\n    \"reason\": \"User requested cancellation\"\n  }\n}\n```\n\n## Behavior Requirements\n\n1. Cancellation notifications **MUST** only reference requests that:\n   * Were previously issued in the same direction\n   * Are believed to still be in-progress\n2. The `initialize` request **MUST NOT** be cancelled by clients\n3. For [task-augmented requests](./tasks), the `tasks/cancel` request **MUST** be used instead of the `notifications/cancelled` notification. Tasks have their own dedicated cancellation mechanism that returns the final task state.\n4. Receivers of cancellation notifications **SHOULD**:\n   * Stop processing the cancelled request\n   * Free associated resources\n   * Not send a response for the cancelled request\n5. Receivers **MAY** ignore cancellation notifications if:\n   * The referenced request is unknown\n   * Processing has already completed\n   * The request cannot be cancelled\n6. The sender of the cancellation notification **SHOULD** ignore any response to the\n   request that arrives afterward\n\n## Timing Considerations\n\nDue to network latency, cancellation notifications may arrive after request processing\nhas completed, and potentially after a response has already been sent.\n\nBoth parties **MUST** handle these race conditions gracefully:\n\n```mermaid  theme={null}\nsequenceDiagram\n   participant Client\n   participant Server\n\n   Client->>Server: Request (ID: 123)\n   Note over Server: Processing starts\n   Client--)Server: notifications/cancelled (ID: 123)\n   alt\n      Note over Server: Processing may have<br/>completed before<br/>cancellation arrives\n   else If not completed\n      Note over Server: Stop processing\n   end\n```\n\n## Implementation Notes\n\n* Both parties **SHOULD** log cancellation reasons for debugging\n* Application UIs **SHOULD** indicate when cancellation is requested\n\n## Error Handling\n\nInvalid cancellation notifications **SHOULD** be ignored:\n\n* Unknown request IDs\n* Already completed requests\n* Malformed notifications\n\nThis maintains the \"fire and forget\" nature of notifications while allowing for race\nconditions in asynchronous communication.",
  "content_length": 2768
}