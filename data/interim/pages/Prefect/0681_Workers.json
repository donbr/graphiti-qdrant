{
  "title": "Workers",
  "source_url": "https://docs-3.prefect.io/v3/concepts/workers",
  "content": "Workers poll work pools for new runs to execute.\n\nexport const workers = {\n  helm: \"https://github.com/PrefectHQ/prefect-helm/tree/main/charts/prefect-server\"\n};\n\nexport const HELM = ({name, href}) => <p>You can manage {name} with the <a href={href}>Prefect Helm charts</a>.</p>;\n\nWorkers are lightweight polling services that retrieve scheduled runs from a work pool and execute them.\n\nWorkers each have a type corresponding to the execution environment to submit flow runs to.\nWorkers can only poll work pools that match their type.\nAs a result, when deployments are assigned to a work pool, you know in which execution environment scheduled flow runs for that deployment will run.\n\nThe following diagram summarizes the architecture of a worker-based work pool deployment:\n\n```mermaid  theme={null}\n%%{\n  init: {\n    'theme': 'neutral',\n    'themeVariables': {\n      'margin': '10px'\n    }\n  }\n}%%\n\nflowchart TD\n    subgraph your_infra[\"Your Execution Environment\"]\n        worker[\"Worker\"]\n        subgraph flow_run_infra[Infrastructure]\n            flow_run_a((\"Flow Run A\"))\n        end\n        subgraph flow_run_infra_2[Infrastructure]\n            flow_run_b((\"Flow Run B\"))\n        end      \n    end\n\n    subgraph api[\"Prefect API\"]\n    Deployment --> |assigned to| work_pool\n        work_pool([\"Work Pool\"])\n    end\n\n    worker --> |polls| work_pool\n    worker --> |creates| flow_run_infra\n    worker --> |creates| flow_run_infra_2\n```\n\nThe worker is in charge of provisioning the *flow run infrastructure*.\n\n### Worker types\n\nBelow is a list of available worker types. Most worker types require installation of an additional package.\n\n| Worker Type                                                                                          | Description                                       | Required Package     |\n| ---------------------------------------------------------------------------------------------------- | ------------------------------------------------- | -------------------- |\n| [`process`](https://reference.prefect.io/prefect/workers/process/)                                   | Executes flow runs in subprocesses                |                      |\n| [`kubernetes`](https://reference.prefect.io/prefect_kubernetes/worker/)                              | Executes flow runs as Kubernetes jobs             | `prefect-kubernetes` |\n| [`docker`](https://reference.prefect.io/prefect_docker/worker/)                                      | Executes flow runs within Docker containers       | `prefect-docker`     |\n| [`ecs`](https://reference.prefect.io/prefect_aws/workers/ecs_worker/)                                | Executes flow runs as ECS tasks                   | `prefect-aws`        |\n| [`cloud-run-v2`](https://reference.prefect.io/prefect_gcp/workers/cloud_run_v2/)                     | Executes flow runs as Google Cloud Run jobs       | `prefect-gcp`        |\n| [`vertex-ai`](https://reference.prefect.io/prefect_gcp/workers/vertex/)                              | Executes flow runs as Google Cloud Vertex AI jobs | `prefect-gcp`        |\n| [`azure-container-instance`](https://reference.prefect.io/prefect_azure/workers/container_instance/) | Execute flow runs in ACI containers               | `prefect-azure`      |\n| [`coiled`](https://github.com/coiled/prefect-worker/blob/main/example/README.md)                     | Execute flow runs in your cloud with Coiled       | `prefect-coiled`     |\n\nIf you don't see a worker type that meets your needs, consider\n[developing a new worker type](/contribute/develop-a-new-worker-type/).\n\n### Worker options\n\nWorkers poll for work from one or more queues within a work pool. If the worker references a work queue that doesn't exist, it is created automatically.\nThe worker CLI infers the worker type from the work pool.\nAlternatively, you can specify the worker type explicitly.\nIf you supply the worker type to the worker CLI, a work pool is created automatically if it doesn't exist (using default job settings).\n\nConfiguration parameters you can specify when starting a worker include:\n\n| Option                                            | Description                                                                                                                                 |\n| ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |\n| `--name`, `-n`                                    | The name to give to the started worker. If not provided, a unique name will be generated.                                                   |\n| `--pool`, `-p`                                    | The work pool the started worker should poll.                                                                                               |\n| `--work-queue`, `-q`                              | One or more work queue names for the worker to pull from. If not provided, the worker pulls from all work queues in the work pool.          |\n| `--type`, `-t`                                    | The type of worker to start. If not provided, the worker type is inferred from the work pool.                                               |\n| <span class=\"no-wrap\">`--prefetch-seconds`</span> | The amount of time before a flow run's scheduled start time to begin submission. Default is the value of `PREFECT_WORKER_PREFETCH_SECONDS`. |\n| `--run-once`                                      | Only run worker polling once. By default, the worker runs forever.                                                                          |\n| `--limit`, `-l`                                   | The maximum number of flow runs to execute concurrently.                                                                                    |\n| `--with-healthcheck`                              | Start a healthcheck server for the worker.                                                                                                  |\n| `--install-policy`                                | Install policy to use workers from Prefect integration packages.                                                                            |\n\nYou must start a worker within an environment to access or create the required infrastructure to execute flow runs.\nThe worker will deploy flow runs to the infrastructure corresponding to the worker type. For example, if you start a worker with\ntype `kubernetes`, the worker deploys flow runs to a Kubernetes cluster.\n\nPrefect must be installed in any environment (for example, virtual environment, Docker container) where you intend to run the worker or\nexecute a flow run.\n\n<Tip>\n  **`PREFECT_API_URL` and `PREFECT_API_KEY`settings for workers**\n\n  `PREFECT_API_URL` must be set for the environment where your worker is running. When using Prefect Cloud, you must also have a user or service account\n  with the `Worker` role, which you can configure by setting the `PREFECT_API_KEY`.\n</Tip>\n\n### Worker status\n\nWorkers have two statuses: `ONLINE` and `OFFLINE`. A worker is online if it sends regular heartbeat messages to the Prefect API.\nIf a worker misses three heartbeats, it is considered offline. By default, a worker is considered offline a maximum of 90 seconds\nafter it stopped sending heartbeats, but you can configure the threshold with the `PREFECT_WORKER_HEARTBEAT_SECONDS` setting.\n\n### Worker logs\n\n<span class=\"badge cloud\" /> Workers send logs to the Prefect Cloud API if you're connected to Prefect Cloud.\n\n* All worker logs are automatically sent to the Prefect Cloud API\n* Logs are accessible through both the Prefect Cloud UI and API\n* Each flow run will include a link to its associated worker's logs\n\n### Worker details\n\n<span class=\"badge cloud\" /> The **Worker Details** page shows you three key areas of information:\n\n* Worker status\n* Installed Prefect version\n* Installed Prefect integrations (e.g., `prefect-aws`, `prefect-gcp`)\n* Live worker logs (if worker logging is enabled)\n\nAccess a worker's details by clicking on the worker's name in the Work Pool list.\n\n### Start a worker\n\nUse the `prefect worker start` CLI command to start a worker. You must pass at least the work pool name.\nIf the work pool does not exist, it will be created if the `--type` flag is used.\n\n```bash  theme={null}\nprefect worker start -p [work pool name]\n```\n\nFor example:\n\n```bash  theme={null}\nprefect worker start -p \"my-pool\"\n```\n\nResults in output like this:\n\n```bash  theme={null}\nDiscovered worker type 'process' for work pool 'my-pool'.\nWorker 'ProcessWorker 65716280-96f8-420b-9300-7e94417f2673' started!\n```\n\nIn this case, Prefect automatically discovered the worker type from the work pool.\nTo create a work pool and start a worker in one command, use the `--type` flag:\n\n```bash  theme={null}\nprefect worker start -p \"my-pool\" --type \"process\"\n```\n\n```bash  theme={null}\nWorker 'ProcessWorker d24f3768-62a9-4141-9480-a056b9539a25' started!\n06:57:53.289 | INFO    | prefect.worker.process.processworker d24f3768-62a9-4141-9480-a056b9539a25 - Worker pool 'my-pool' created.\n```\n\nIn addition, workers can limit the number of flow runs to start simultaneously with the `--limit` flag.\nFor example, to limit a worker to five concurrent flow runs:\n\n```bash  theme={null}\nprefect worker start --pool \"my-pool\" --limit 5\n```\n\n<HELM name=\"workers\" href={workers.helm} />\n\n### Configure prefetch\n\nBy default, the worker submits flow runs 10 seconds before they are scheduled to run.\nThis allows time for the infrastructure to be created so the flow run can start on time.\n\nIn some cases, infrastructure takes longer than 10 seconds to start the flow run. You can increase the prefetch time with the\n`--prefetch-seconds` option or the `PREFECT_WORKER_PREFETCH_SECONDS` setting.\n\nIf this value is *more* than the amount of time it takes for the infrastructure to start, the flow run will *wait* until its\nscheduled start time.\n\n### Polling for work\n\nWorkers poll for work every 15 seconds by default. You can configure this interval in your [profile settings](/v3/develop/settings-and-profiles/)\nwith the\n`PREFECT_WORKER_QUERY_SECONDS` setting.\n\n### Install policy\n\nThe Prefect CLI can install the required package for Prefect-maintained worker types automatically. Configure this behavior\nwith the `--install-policy` option. The following are valid install policies:\n\n| Install Policy                                                                                               | Description                                                                                                        |\n| ------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------ |\n| `always`                                                                                                     | Always install the required package. Updates the required package to the most recent version if already installed. |\n| `if-not-present`                                                                                             | Install the required package if it is not already installed.                                                       |\n| `never`                                                                                                      | Never install the required package.                                                                                |\n| `prompt`                                                                                                     | Prompt the user to choose whether to install the required package. This is the default install policy.             |\n| If `prefect worker start` is run non-interactively, the `prompt` install policy behaves the same as `never`. |                                                                                                                    |\n\n### Further reading\n\n* See how to [daemonize a Prefect worker](/v3/advanced/daemonize-processes/).\n\n* See more information on [overriding a work pool's job variables](/v3/deploy/infrastructure-concepts/customize).\n\n***",
  "content_length": 12247
}