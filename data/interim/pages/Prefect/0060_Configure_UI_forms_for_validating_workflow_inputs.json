{
  "title": "Configure UI forms for validating workflow inputs",
  "source_url": "https://docs-3.prefect.io/v3/advanced/form-building",
  "content": "Learn how to craft validated and user-friendly input forms for workflows.\n\nParameterizing workflows is a critical part of orchestration. It allows you to create contracts between modular workflows in your organization and empower less-technical users to interact with your workflows intuitively.\n\n[Pydantic](https://docs.pydantic.dev/) is a powerful library for data validation using Python type annotations, which is used by Prefect to build a parameter schema for your workflow.\n\nThis allows you to:\n\n* check runtime parameter values against the schema (from the UI or the SDK)\n* build a user-friendly form in the Prefect UI\n* easily reuse parameter types in similar workflows\n\nIn this tutorial, we'll craft a workflow signature that the Prefect UI will render as a self-documenting form.\n\n## Motivation\n\nLet's say you have a workflow that triggers a marketing email blast which looks like:\n\n```python  theme={null}\n@flow\ndef send_marketing_email(\n    mailing_lists: list[str],\n    subject: str,\n    body: str,\n    test_mode: bool = False,\n    attachments: list[str] | None = None\n):\n    \"\"\"\n    Send a marketing email blast to the given lists.\n\n    Args:\n        mailing_lists: A list of lists to email.\n        subject: The subject of the email.\n        body: The body of the email.\n        test_mode: Whether to send a test email.\n        attachments: A list of attachments to include in the email.\n    \"\"\"\n    ...\n```\n\nWhen you deploy this flow, Prefect will automatically inspect your function signature and generate a form for you:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=7c92fd96cd09e30e1b850f6522ef98b6\" alt=\"initial form\" data-og-width=\"686\" width=\"686\" data-og-height=\"862\" height=\"862\" data-path=\"v3/img/tutorials/parameters/0.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?w=280&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=f66a8062b45f16b3ef0a7ce041031660 280w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?w=560&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=181a0878ab32e7d4cb763e43565a2749 560w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?w=840&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=a51b4de930926c80d1cbc362f7fa006a 840w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?w=1100&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=87099b7096fd0406808866cc7e18043a 1100w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?w=1650&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=b73f65eb8fe717846b55bc66fafabeaa 1650w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/0.png?w=2500&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=2dce889c924085aa91f0b0ebc1ecf0e0 2500w\" />\n\nThis is good enough for many cases, but consider these additional constraints that could arise from business needs or tech stack restrictions:\n\n* there are only a few valid values for `mailing_lists`\n* the `subject` must not exceed 30 characters\n* no more than 5 `attachments` are allowed\n\nYou *can* simply check these constraints in the body of your flow function:\n\n```python  theme={null}\n@flow\ndef send_marketing_email(...):\n    if len(subject) > 30:\n        raise ValueError(\"Subject must be less than 30 characters\")\n    if mailing_lists not in [\"newsletter\", \"customers\", \"beta-testers\"]:\n        raise ValueError(\"Invalid list to email\")\n    if len(attachments) > 5:\n        raise ValueError(\"Too many attachments\")\n    \n    # etc...\n```\n\nbut there are several downsides to this:\n\n* you have to spin up the infrastructure associated with your flow in order to check the constraints, which is wasteful if it turns out that bad parameters were provided\n* this might get duplicative, especially if you have similarly constrained parameters for different workflows\n\nTo improve on this, we will use `pydantic` to build a convenient, self-documenting, and reusable flow signature that the Prefect UI can build a better form from.\n\n## Building a convenient flow signature\n\nLet's address the constraints on `mailing_lists`, `subject`, and `attachments`.\n\n### Using `Literal` to restrict valid values\n\n> there are only a few valid values for `mailing_lists`\n\nSay our valid mailing lists are: `[\"newsletter\", \"customers\", \"beta-testers\"]`\n\nWe can define a `Literal` to specify the valid values for the `mailing_lists` parameter.\n\n```python  theme={null}\nfrom typing import Literal\n\nMailingList = Literal[\"newsletter\", \"customers\", \"beta-testers\"]\n```\n\n<Tip>\n  You can use an `Enum` to achieve the same effect.\n\n  ```python  theme={null}\n  from enum import Enum\n\n  class MailingList(Enum):\n      NEWSLETTER = \"newsletter\"\n      CUSTOMERS = \"customers\"\n      BETA_TESTERS = \"beta-testers\"\n  ```\n</Tip>\n\n### Using a `BaseModel` subclass to group and constrain parameters\n\nBoth the `subject` and `attachments` parameters have constraints that we want to enforce.\n\n> the `subject` must not exceed 30 characters\n\n> the `attachments` must not exceed 5 items\n\nAdditionally, the `subject`, `body`, and `attachments` parameters are all related to the same thing: the content of the email.\n\nWe can define a `BaseModel` subclass to group these parameters together and apply these constraints.\n\n```python  theme={null}\nfrom pydantic import BaseModel, Field\n\nclass EmailContent(BaseModel):\n    subject: str = Field(max_length=30)\n    body: str = Field(default=...)\n    attachments: list[str] = Field(default_factory=list, max_length=5)\n```\n\n<Tip>\n  `pydantic.Field` accepts a `description` kwarg that is displayed in the form above the field input.\n\n  ```python  theme={null}\n  subject: str = Field(description=\"The subject of the email\", max_length=30)\n  ```\n\n    <img src=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=4f6dd6381c3b6914c345b705f018ccee\" alt=\"field description\" data-og-width=\"744\" width=\"744\" data-og-height=\"508\" height=\"508\" data-path=\"v3/img/tutorials/parameters/4.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?w=280&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=393616922fdb4aebb093a799372afe77 280w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?w=560&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=bf6ed5373ea36473262dcf3e9c2c2684 560w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?w=840&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=20af37a0e21acbb60546e1c7d3b06291 840w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?w=1100&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=d84a0066995d61fb4b95145adc0c009e 1100w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?w=1650&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=bbb632cba04fac9550e4585872819884 1650w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/4.png?w=2500&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=aab7efd9db8c8973aeb4b03265463810 2500w\" />\n\n  Similarly, you can:\n\n  * pass `title` to `Field` to override the field name in the form\n  * define a docstring for `EmailContent` to add a description to this group of parameters in the form\n</Tip>\n\n### Rewriting the flow signature\n\nNow that we have defined the `MailingList` and `EmailContent` types, we can use them in our flow signature:\n\n```python  theme={null}\n@flow\ndef send_marketing_email(\n    mailing_lists: list[MailingList],\n    content: EmailContent,\n    test_mode: bool = False,\n):\n    ...\n```\n\nThe resulting form looks like this:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=7378d09271c35786333c540982e903b5\" alt=\"improved form\" data-og-width=\"722\" width=\"722\" data-og-height=\"822\" height=\"822\" data-path=\"v3/img/tutorials/parameters/1.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?w=280&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=5c65107ac68ff1ab202c2aa6776399d2 280w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?w=560&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=2a197afcd11913e979e6cbf50ea3c719 560w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?w=840&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=4f1a69addb8672c14fa7f977694a3daa 840w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?w=1100&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=1f0412200e0700343565b18559ef32ef 1100w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?w=1650&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=558bb80a173d464234e408de15493460 1650w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/1.png?w=2500&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=cdf4e81a66ebf6ea1a01600d798a4373 2500w\" />\n\nwhere the `mailing_lists` parameter renders as a multi-select dropdown that only allows the `Literal` values from our `MailingList` type.\n\n<img src=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=cf9e0c0a7e4e6818411efaa114da5adb\" alt=\"multi-select\" data-og-width=\"693\" width=\"693\" data-og-height=\"253\" height=\"253\" data-path=\"v3/img/tutorials/parameters/2.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?w=280&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=1a2337550ede880b171ee6c519bb8485 280w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?w=560&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=981bd31a831eec31fbb18edaedae9c7a 560w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?w=840&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=5c47b06c87dfaf20ea942eae9bfcf24b 840w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?w=1100&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=0c0a88c1cfcc6a6a6b1ff30c72a966a9 1100w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?w=1650&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=b9cfca6d8bc00b004a5f685f80bd9725 1650w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/2.png?w=2500&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=dd100bfa60e163fccedee7af8f32dda7 2500w\" />\n\nand any constraints you've defined on the `EmailContent` fields will be enforced before the run is submitted.\n\n<img src=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=619992061424d3e38d65d109833228b0\" alt=\"early validation failure toast\" data-og-width=\"802\" width=\"802\" data-og-height=\"723\" height=\"723\" data-path=\"v3/img/tutorials/parameters/3.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?w=280&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=c57abee81485808772fe109716bac888 280w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?w=560&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=c434b7a4b9a3de27845a0d3c97e56f79 560w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?w=840&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=235a862eed24addf855bd60a8d6bfa98 840w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?w=1100&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=40aa62dcf5463963501131c023743c9e 1100w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?w=1650&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=9a7e8c8b3cbd26809cb8ec016fc58f2c 1650w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/3.png?w=2500&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=2d7bfe3d6e25cc46c598a2a4c098c071 2500w\" />\n\n<Accordion title=\"Full example code so far\">\n  ```python  theme={null}\n  from typing import Literal\n\n  from prefect import flow\n  from pydantic import BaseModel, Field\n\n  MailingList = Literal[\"newsletter\", \"customers\", \"beta-testers\"]\n\n\n  class EmailContent(BaseModel):\n      subject: str = Field(max_length=30)\n      body: str = Field(default=...)\n      attachments: list[str] = Field(default_factory=list, max_length=5)\n\n\n  @flow\n  def send_marketing_email(\n      mailing_list: list[MailingList],\n      content: EmailContent,\n      test_mode: bool = False,\n  ):\n      pass\n\n\n  if __name__ == \"__main__\":\n      send_marketing_email.serve()\n  ```\n</Accordion>\n\n### Using `json_schema_extra` to order fields in the form\n\nBy default, your flow parameters are rendered in the order defined by your `@flow` function signature.\n\nWithin a given `BaseModel` subclass, parameters are rendered in the following order:\n\n* parameters with a `default` value are rendered first, alphabetically\n* parameters without a `default` value are rendered next, alphabetically\n\nYou can control the order of the parameters within a `BaseModel` subclass by passing `json_schema_extra` to the `Field` constructor with a `position` key.\n\nTaking our `EmailContent` model from the previous example, let's enforce that `subject` should be displayed first, then `body`, then `attachments`.\n\n```python  theme={null}\nclass EmailContent(BaseModel):\n    subject: str = Field(\n        max_length=30,\n        description=\"The subject of the email\",\n        json_schema_extra=dict(position=0),\n    )\n    body: str = Field(default=..., json_schema_extra=dict(position=1))\n    attachments: list[str] = Field(\n        default_factory=list,\n        max_length=5,\n        json_schema_extra=dict(position=2),\n    )\n```\n\nThe resulting form looks like this:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=08276130d5cb26e10a7db49f63585fa3\" alt=\"custom form layout\" data-og-width=\"1179\" width=\"1179\" data-og-height=\"798\" height=\"798\" data-path=\"v3/img/tutorials/parameters/5.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?w=280&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=12bbe57439e7b0400f5adbd1fef20e01 280w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?w=560&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=887f879ef153536b31491736a5001f8b 560w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?w=840&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=12418d45fbf6e940c228f636763a7dbd 840w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?w=1100&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=f1481962f15706a545a18a20228feb5d 1100w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?w=1650&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=b6efba36727a53956136757507cbf219 1650w, https://mintcdn.com/prefect-bd373955/ZU4EjeonScNdwFxn/v3/img/tutorials/parameters/5.png?w=2500&fit=max&auto=format&n=ZU4EjeonScNdwFxn&q=85&s=edb9490edaf9d072dd8abce587cb7cc5 2500w\" />\n\n## Recap\n\nWe have now embedded the constraints on our parameters in the types that describe our flow signature, which means:\n\n* the UI can enforce these constraints before the run is submitted - **less wasted infra cycles**\n* workflow inputs are **self-documenting**, both in the UI and in the code defining your workflow\n* the types used in this signature can be **easily reused** for other similar workflows\n\n## Debugging and related resources\n\nAs you craft a schema for your flow signature, you may want to inspect the raw OpenAPI schema that `pydantic` generates, as it is what the Prefect UI uses to build the form.\n\nCall `model_json_schema()` on your `BaseModel` subclass to inspect the raw schema.\n\n```python  theme={null}\nfrom rich import print as pprint\nfrom pydantic import BaseModel, Field\n\nclass EmailContent(BaseModel):\n    subject: str = Field(max_length=30)\n    body: str = Field(default=...)\n    attachments: list[str] = Field(default_factory=list, max_length=5)\n\npprint(EmailContent.model_json_schema())\n```\n\n```\n{\n    'properties': {\n        'subject': {'maxLength': 30, 'title': 'Subject', 'type': 'string'},\n        'body': {'title': 'Body', 'type': 'string'},\n        'attachments': {'items': {'type': 'string'}, 'maxItems': 5, 'title': 'Attachments', 'type': 'array'}\n    },\n    'required': ['subject', 'body'],\n    'title': 'EmailContent',\n    'type': 'object'\n}\n```\n\nFor more on constrained types and validation features available in `pydantic`, see their documentation on [models](https://docs.pydantic.dev/latest/concepts/models/) and [types](https://docs.pydantic.dev/latest/concepts/types/).",
  "content_length": 17361
}