{
  "title": "container_instance",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-infrastructure-provisioners-container_instance",
  "content": "# `prefect.infrastructure.provisioners.container_instance`\n\nThis module defines the ContainerInstancePushProvisioner class, which is responsible for provisioning\ninfrastructure using Azure Container Instances for Prefect work pools.\n\nThe ContainerInstancePushProvisioner class provides methods for provisioning infrastructure and\ninteracting with Azure Container Instances.\n\nClasses:\nAzureCLI: A class to handle Azure CLI commands.\nContainerInstancePushProvisioner: A class for provisioning infrastructure using Azure Container Instances.\n\n## Classes\n\n### `AzureCLI` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L46\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nA class for executing Azure CLI commands and handling their output.\n\n**Args:**\n\n* `console`: A Rich console object for displaying messages.\n\n**Methods:**\n\n#### `run_command` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L61\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_command(self, command: str, success_message: Optional[str] = None, failure_message: Optional[str] = None, ignore_if_exists: bool = False, return_json: bool = False) -> str | dict[str, Any] | None\n```\n\nRuns an Azure CLI command and processes the output.\n\n**Args:**\n\n* `command`: The Azure CLI command to execute.\n* `success_message`: Message to print on success.\n* `failure_message`: Message to print on failure.\n* `ignore_if_exists`: Whether to ignore errors if a resource already exists.\n* `return_json`: Whether to return the output as JSON.\n\n**Returns:**\n\n* A tuple with two elements:\n* str: Status, either 'created', 'exists', or 'error'.\n* str or dict or None: The command output or None if an error occurs (depends on return\\_json).\n\n**Raises:**\n\n* `subprocess.CalledProcessError`: If the command execution fails.\n* `json.JSONDecodeError`: If output cannot be decoded as JSON when return\\_json is True.\n\n### `ContainerInstancePushProvisioner` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L129\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nA class responsible for provisioning Azure resources and setting up a push work pool.\n\n**Methods:**\n\n#### `console` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L167\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nconsole(self) -> Console\n```\n\n#### `console` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L171\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nconsole(self, value: Console) -> None\n```\n\n#### `provision` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L860\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nprovision(self, work_pool_name: str, base_job_template: Dict[str, Any], client: Optional['PrefectClient'] = None) -> Dict[str, Any]\n```\n\nOrchestrates the provisioning of Azure resources and setup for the push work pool.\n\n**Args:**\n\n* `work_pool_name`: The name of the work pool.\n* `base_job_template`: The base template for job creation.\n* `client`: An instance of PrefectClient. If None, it will be injected.\n\n**Returns:**\n\n* Dict\\[str, Any]: The updated job template with necessary references and configurations.\n\n**Raises:**\n\n* `RuntimeError`: If client injection fails or the Azure CLI command execution fails.\n\n#### `set_location` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/infrastructure/provisioners/container_instance.py#L174\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nset_location(self) -> None\n```\n\nSet the Azure resource deployment location to the default or 'eastus' on failure.\n\n**Raises:**\n\n* `RuntimeError`: If unable to execute the Azure CLI command.",
  "content_length": 4356
}