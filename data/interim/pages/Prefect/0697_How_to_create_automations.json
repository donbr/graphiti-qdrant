{
  "title": "How to create automations",
  "source_url": "https://docs-3.prefect.io/v3/how-to-guides/automations/creating-automations",
  "content": "Learn how to define automations that trigger actions based on events.\n\nexport const automations = {\n  cli: \"https://docs.prefect.io/v3/api-ref/cli/automation\",\n  api: \"https://app.prefect.cloud/api/docs#tag/Automations\",\n  tf: \"https://registry.terraform.io/providers/PrefectHQ/prefect/latest/docs/resources/automation\"\n};\n\nexport const COMBINED = ({name, hrefTF, hrefAPI, hrefCLI}) => <p>You can manage {name} with the <a href={hrefCLI}>Prefect CLI</a>, <a href={hrefTF}>Terraform provider</a>, or <a href={hrefAPI}>Prefect API</a>.</p>;\n\n## Create an automation\n\nOn the **Automations** page, select the **+** icon to create a new automation. You'll be prompted to configure:\n\n* A [trigger](#triggers) condition that causes the automation to execute.\n* One or more [actions](#actions) carried out by the automation.\n* [Details](#details) about the automation, such as a name and description.\n\n<COMBINED name=\"automations\" hrefTF={automations.tf} hrefAPI={automations.api} hrefCLI={automations.cli} />\n\n### Create automations with the CLI\n\nYou can create automations from YAML or JSON files using the Prefect CLI:\n\n```bash  theme={null}\n# Create from a YAML file\nprefect automation create --from-file automation.yaml\n# or use the short form\nprefect automation create -f automation.yaml\n\n# Create from a JSON file  \nprefect automation create --from-file automation.json\n\n# Create from a JSON string\nprefect automation create --from-json '{\"name\": \"my-automation\", \"trigger\": {...}, \"actions\": [...]}'\n# or use the short form\nprefect automation create -j '{\"name\": \"my-automation\", \"trigger\": {...}, \"actions\": [...]}'\n```\n\n#### Single automation example\n\nHere's an example YAML file that creates an automation to cancel long-running flows:\n\n```yaml  theme={null}\nname: Cancel Long Running Flows\ndescription: Cancels flows running longer than 5 minutes\nenabled: true\ntrigger:\n  type: event\n  posture: Proactive\n  expect:\n    - prefect.flow-run.Completed\n  threshold: 1\n  within: 300  # 5 minutes\n  for_each:\n    - prefect.resource.id\nactions:\n  - type: cancel-flow-run\n```\n\n#### Multiple automations example\n\nYou can also create multiple automations at once by using the `automations:` key. If any automation fails to create, the command will continue with the remaining automations and report both successes and failures:\n\n```yaml  theme={null}\nautomations:\n  - name: Cancel Long Running Flows\n    description: Cancels flows running longer than 30 minutes\n    enabled: true\n    trigger:\n      type: event\n      posture: Reactive\n      expect:\n        - prefect.flow-run.Running\n      threshold: 1\n      for_each:\n        - prefect.resource.id\n    actions:\n      - type: cancel-flow-run\n        \n  - name: Notify on Flow Failure\n    description: Send notification when flows fail\n    enabled: true\n    trigger:\n      type: event\n      posture: Reactive\n      expect:\n        - prefect.flow-run.Failed\n      threshold: 1\n    actions:\n      - type: send-notification\n        subject: \"Flow Failed: {{ event.resource.name }}\"\n        body: \"Flow run {{ event.resource.name }} has failed.\"\n```\n\nOr as a JSON array:\n\n```json  theme={null}\n[\n  {\n    \"name\": \"First Automation\",\n    \"trigger\": {...},\n    \"actions\": [...]\n  },\n  {\n    \"name\": \"Second Automation\", \n    \"trigger\": {...},\n    \"actions\": [...]\n  }\n]\n```\n\n### Create automations with the Python SDK\n\nYou can create and access any automation with the Python SDK's `Automation` class and its methods.\n\n```python  theme={null}\nfrom prefect.automations import Automation\nfrom prefect.events.schemas.automations import EventTrigger\nfrom prefect.events.actions import CancelFlowRun\n\n# creating an automation\nautomation = Automation(\n    name=\"woodchonk\",\n    trigger=EventTrigger(\n        expect={\"animal.walked\"},\n        match={\n            \"genus\": \"Marmota\",\n            \"species\": \"monax\",\n        },\n        posture=\"Reactive\",\n        threshold=3,\n    ),\n    actions=[CancelFlowRun()],\n).create()\n\n# reading the automation\nautomation = Automation.read(id=automation.id)\n# or by name\nautomation = Automation.read(name=\"woodchonk\")\n```",
  "content_length": 4088
}