{
  "title": "flow_runs",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-server-models-flow_runs",
  "content": "# `prefect.server.models.flow_runs`\n\nFunctions for interacting with flow run ORM objects.\nIntended for internal use by the Prefect REST API.\n\n## Functions\n\n### `create_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L63\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_flow_run(db: PrefectDBInterface, session: AsyncSession, flow_run: schemas.core.FlowRun, orchestration_parameters: Optional[dict[str, Any]] = None) -> orm_models.FlowRun\n```\n\nCreates a new flow run.\n\nIf the provided flow run has a state attached, it will also be created.\n\n**Args:**\n\n* `session`: a database session\n* `flow_run`: a flow run model\n\n**Returns:**\n\n* orm\\_models.FlowRun: the newly-created flow run\n\n### `update_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L149\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nupdate_flow_run(db: PrefectDBInterface, session: AsyncSession, flow_run_id: UUID, flow_run: schemas.actions.FlowRunUpdate) -> bool\n```\n\nUpdates a flow run.\n\n**Args:**\n\n* `session`: a database session\n* `flow_run_id`: the flow run id to update\n* `flow_run`: a flow run model\n\n**Returns:**\n\n* whether or not matching rows were found to update\n\n### `read_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L178\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_flow_run(db: PrefectDBInterface, session: AsyncSession, flow_run_id: UUID, for_update: bool = False) -> Optional[orm_models.FlowRun]\n```\n\nReads a flow run by id.\n\n**Args:**\n\n* `session`: A database session\n* `flow_run_id`: a flow run id\n\n**Returns:**\n\n* orm\\_models.FlowRun: the flow run\n\n### `read_flow_runs` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L282\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_flow_runs(db: PrefectDBInterface, session: AsyncSession, columns: Optional[list[str]] = None, flow_filter: Optional[schemas.filters.FlowFilter] = None, flow_run_filter: Optional[schemas.filters.FlowRunFilter] = None, task_run_filter: Optional[schemas.filters.TaskRunFilter] = None, deployment_filter: Optional[schemas.filters.DeploymentFilter] = None, work_pool_filter: Optional[schemas.filters.WorkPoolFilter] = None, work_queue_filter: Optional[schemas.filters.WorkQueueFilter] = None, offset: Optional[int] = None, limit: Optional[int] = None, sort: schemas.sorting.FlowRunSort = schemas.sorting.FlowRunSort.ID_DESC) -> Sequence[orm_models.FlowRun]\n```\n\nRead flow runs.\n\n**Args:**\n\n* `session`: a database session\n* `columns`: a list of the flow run ORM columns to load, for performance\n* `flow_filter`: only select flow runs whose flows match these filters\n* `flow_run_filter`: only select flow runs match these filters\n* `task_run_filter`: only select flow runs whose task runs match these filters\n* `deployment_filter`: only select flow runs whose deployments match these filters\n* `offset`: Query offset\n* `limit`: Query limit\n* `sort`: Query sort\n\n**Returns:**\n\n* List\\[orm\\_models.FlowRun]: flow runs\n\n### `cleanup_flow_run_concurrency_slots` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L345\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncleanup_flow_run_concurrency_slots(session: AsyncSession, flow_run: orm_models.FlowRun) -> None\n```\n\nCleanup flow run related resources, such as releasing concurrency slots.\nAll operations should be idempotent and safe to call multiple times.\nIMPORTANT: This run may no longer exist in the database when this operation occurs.\n\n### `read_task_run_dependencies` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L387\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_task_run_dependencies(session: AsyncSession, flow_run_id: UUID) -> List[DependencyResult]\n```\n\nGet a task run dependency map for a given flow run.\n\n### `count_flow_runs` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L435\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncount_flow_runs(db: PrefectDBInterface, session: AsyncSession, flow_filter: Optional[schemas.filters.FlowFilter] = None, flow_run_filter: Optional[schemas.filters.FlowRunFilter] = None, task_run_filter: Optional[schemas.filters.TaskRunFilter] = None, deployment_filter: Optional[schemas.filters.DeploymentFilter] = None, work_pool_filter: Optional[schemas.filters.WorkPoolFilter] = None, work_queue_filter: Optional[schemas.filters.WorkQueueFilter] = None) -> int\n```\n\nCount flow runs.\n\n**Args:**\n\n* `session`: a database session\n* `flow_filter`: only count flow runs whose flows match these filters\n* `flow_run_filter`: only count flow runs that match these filters\n* `task_run_filter`: only count flow runs whose task runs match these filters\n* `deployment_filter`: only count flow runs whose deployments match these filters\n\n**Returns:**\n\n* count of flow runs\n\n### `delete_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L477\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ndelete_flow_run(db: PrefectDBInterface, session: AsyncSession, flow_run_id: UUID) -> bool\n```\n\nDelete a flow run by flow\\_run\\_id, handling concurrency limits if applicable.\n\n**Args:**\n\n* `session`: A database session\n* `flow_run_id`: a flow run id\n\n**Returns:**\n\n* whether or not the flow run was deleted\n\n### `set_flow_run_state` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L507\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nset_flow_run_state(session: AsyncSession, flow_run_id: UUID, state: schemas.states.State, force: bool = False, flow_policy: Optional[Type[FlowRunOrchestrationPolicy]] = None, orchestration_parameters: Optional[Dict[str, Any]] = None, client_version: Optional[str] = None) -> OrchestrationResult\n```\n\nCreates a new orchestrated flow run state.\n\nSetting a new state on a run is the one of the principal actions that is governed by\nPrefect's orchestration logic. Setting a new run state will not guarantee creation,\nbut instead trigger orchestration rules to govern the proposed `state` input. If\nthe state is considered valid, it will be written to the database. Otherwise, a\nit's possible a different state, or no state, will be created. A `force` flag is\nsupplied to bypass a subset of orchestration logic.\n\n**Args:**\n\n* `session`: a database session\n* `flow_run_id`: the flow run id\n* `state`: a flow run state model\n* `force`: if False, orchestration rules will be applied that may alter or prevent\n  the state transition. If True, orchestration rules are not applied.\n\n**Returns:**\n\n* OrchestrationResult object\n\n### `read_flow_run_graph` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L597\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_flow_run_graph(db: PrefectDBInterface, session: AsyncSession, flow_run_id: UUID, since: datetime.datetime = earliest_possible_datetime()) -> Graph\n```\n\nGiven a flow run, return the graph of it's task and subflow runs. If a `since`\ndatetime is provided, only return items that may have changed since that time.\n\n### `with_system_labels_for_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L617\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nwith_system_labels_for_flow_run(session: AsyncSession, flow_run: Union[schemas.core.FlowRun, schemas.actions.FlowRunCreate]) -> schemas.core.KeyValueLabels\n```\n\nAugment user supplied labels with system default labels for a flow\nrun.\n\n### `update_flow_run_labels` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L654\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nupdate_flow_run_labels(db: PrefectDBInterface, session: AsyncSession, flow_run_id: UUID, labels: KeyValueLabels) -> bool\n```\n\nUpdate flow run labels by patching existing labels with new values.\nArgs:\nsession: A database session\nflow\\_run\\_id: the flow run id to update\nlabels: the new labels to patch into existing labels\nReturns:\nbool: whether the update was successful\n\n## Classes\n\n### `DependencyResult` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/flow_runs.py#L374\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `model_validate_list` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/_internal/schemas/bases.py#L56\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nmodel_validate_list(cls, obj: Any) -> list[Self]\n```\n\n#### `reset_fields` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/_internal/schemas/bases.py#L85\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nreset_fields(self: Self) -> Self\n```\n\nReset the fields of the model that are in the `_reset_fields` set.\n\n**Returns:**\n\n* A new instance of the model with the reset fields.",
  "content_length": 9958
}