{
  "title": "Get to know the ECS worker",
  "source_url": "https://docs-3.prefect.io/integrations/prefect-aws/ecs-worker/index",
  "content": "Deploy production-ready Prefect workers on AWS Elastic Container Service (ECS) for scalable, containerized flow execution. ECS workers provide robust infrastructure management with automatic scaling, high availability, and seamless AWS integration.\n\n## Why use ECS for flow run execution?\n\nECS (Elastic Container Service) is an excellent choice for executing Prefect flow runs in production environments:\n\n* **Production-ready scalability**: ECS automatically scales your infrastructure based on demand, efficiently managing container distribution across multiple instances\n* **Flexible compute options**: Choose between AWS Fargate for serverless execution or Amazon EC2 for faster job start times and additional control\n* **Native AWS integration**: Seamlessly connect with AWS services like IAM, CloudWatch, Secrets Manager, and VPC networking\n* **Containerized reliability**: Docker container support ensures reproducible deployments and consistent runtime environments\n* **Cost optimization**: Pay only for the compute resources you use with automatic scaling and spot instance support\n\n## Architecture Overview\n\nECS workers operate within your AWS infrastructure, providing secure and scalable flow execution. Prefect enables remote flow execution via workers and work pools - to learn more about these concepts see the [deployment docs](/v3/deploy/infrastructure-concepts/work-pools/).\n\n```mermaid  theme={null}\n%%{\n  init: {\n    'theme': 'neutral',\n    'themeVariables': {\n      'margin': '10px'\n    }\n  }\n}%%\n\nflowchart TB\n    subgraph ecs_cluster[ECS Cluster]\n        subgraph ecs_service[ECS Service]\n            td_worker[Worker Task Definition] --> |defines| prefect_worker[Prefect Worker]\n        end\n\n        prefect_worker -->|kicks off| ecs_task\n\n        fr_task_definition[Flow Run Task Definition]\n\n        subgraph ecs_task[ECS Task Execution]\n            flow_run((Flow Run))\n        end\n\n        fr_task_definition -->|defines| ecs_task\n    end\n\n    subgraph prefect_cloud[Prefect Cloud]\n        work_pool[ECS Work Pool]\n    end\n\n    subgraph github[ECR]\n        flow_code[\"Flow Code\"]\n    end\n\n    flow_code --> |pulls| ecs_task\n    prefect_worker -->|polls| work_pool\n    work_pool -->|configures| fr_task_definition\n```\n\n### Key Components\n\n* **ECS Worker**: Long-running service that polls work pools and manages flow run execution. Runs as an ECS Service for auto-recovery in case of failure\n* **Task Definitions**: Blueprint for ECS tasks that describes which Docker containers to run and their configuration\n* **ECS Cluster**: Provides the underlying compute capacity with auto-scaling capabilities\n* **Work Pools**: Typed according to infrastructure - flow runs in `ecs` work pools are executed as ECS tasks\n* **Flow Run Tasks**: Ephemeral ECS tasks that execute individual Prefect flows until completion\n\n### How It Works\n\n1. **Continuous Polling**: The ECS worker continuously polls your Prefect server or Prefect Cloud for scheduled flow runs\n2. **Task Creation**: When work is available, the worker creates ECS task definitions based on work pool configuration\n3. **Flow Execution**: Flow runs are launched as ECS tasks with appropriate resource allocation and configuration\n4. **Auto-scaling**: ECS automatically manages container distribution and scaling based on demand\n5. **Cleanup**: After flow completion, containers are cleaned up while the worker continues polling\n\n<Tip>\n  **ECS tasks ≠ Prefect tasks**\n\n  An ECS task is **not** the same as a [Prefect task](/v3/develop/write-tasks). ECS tasks are groupings of containers that run within an ECS Cluster, defined by task definitions. They're ideal for ephemeral processes like Prefect flow runs.\n</Tip>\n\n## Deployment options\n\n### With the `prefect-aws` CLI\n\nThe fastest way to deploy production-ready ECS workers is by using the `prefect-aws` CLI:\n\n```bash  theme={null}\nprefect-aws ecs-worker deploy-service \\\n  --work-pool-name my-ecs-pool \\\n  --stack-name prefect-ecs-worker \\\n  --existing-cluster-identifier my-ecs-cluster \\\n  --existing-vpc-id vpc-12345678 \\\n  --existing-subnet-ids subnet-12345,subnet-67890 \\\n  --prefect-api-url https://api.prefect.cloud/api/accounts/.../workspaces/... \\\n  --prefect-api-key your-api-key\n```\n\nThis command creates a CloudFormation stack that provisions all the infrastructure required for a production-ready ECS worker service.\n\n**Key benefits:**\n\n* **One-command deployment**: Provisions complete infrastructure with a single command\n* **CloudFormation managed**: Infrastructure as code with rollback capabilities\n* **Auto-scaling configured**: Built-in scaling policies for production workloads\n* **Monitoring included**: CloudWatch logs and alarms pre-configured\n* **Production defaults**: Secure, optimized settings out of the box\n\n**Additional CLI commands:**\n\n* `prefect-aws ecs-worker list` - View all deployed stacks\n* `prefect-aws ecs-worker status <stack-name>` - Check deployment status\n* `prefect-aws ecs-worker delete <stack-name>` - Clean up infrastructure\n* `prefect-aws ecs-worker export-template` - Export CloudFormation templates for customization\n\nFor detailed CLI options run `prefect-aws ecs-worker deploy-service --help`.\n\n### Manual deployment\n\nFor users who want full control over their ECS infrastructure setup:\n\n**[Deploy manually →](/integrations/prefect-aws/ecs-worker/manual-deployment)**\nStep-by-step guide for creating ECS clusters, task definitions, and configuring workers from scratch.\n\n## Prerequisites\n\nBefore deploying ECS workers, ensure you have:\n\n* **AWS Account**: Active AWS account with appropriate permissions\n* **IAM Permissions**: Rights to create ECS clusters, task definitions, and IAM roles\n* **Docker Knowledge**: Basic understanding of containerization concepts\n* **Prefect Setup**: Active Prefect server or Prefect Cloud workspace\n\n## Getting started\n\n1. **Choose your deployment method**: Manual setup provides maximum flexibility, while infrastructure as code offers reproducible deployments\n2. **Configure AWS credentials**: Set up IAM roles and permissions for secure AWS service access\n3. **Create work pools**: Define work pool configurations that match your ECS infrastructure\n4. **Deploy workers**: Launch ECS workers that will poll for and execute flow runs\n5. **Monitor and scale**: Use CloudWatch and ECS metrics to optimize performance\n\n## Next steps\n\n* **[Manual Deployment Guide](/integrations/prefect-aws/ecs-worker/manual-deployment)** - Complete walkthrough for setting up ECS workers step-by-step\n* **[Work Pool Configuration](/v3/deploy/infrastructure-concepts/work-pools/)** - Learn about Prefect work pools and worker concepts\n* **[AWS ECS Documentation](https://docs.aws.amazon.com/ecs/)** - Official AWS documentation for ECS services\n* **[Prefect Cloud Push Work Pools](/v3/how-to-guides/deployment_infra/serverless)** - Serverless alternative to self-managed workers",
  "content_length": 6877
}