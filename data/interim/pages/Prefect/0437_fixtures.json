{
  "title": "fixtures",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-testing-fixtures",
  "content": "# `prefect.testing.fixtures`\n\n## Functions\n\n### `add_prefect_loggers_to_caplog` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L45\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nadd_prefect_loggers_to_caplog(caplog: pytest.LogCaptureFixture) -> Generator[None, None, None]\n```\n\n### `is_port_in_use` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L59\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nis_port_in_use(port: int) -> bool\n```\n\n### `hosted_api_server` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L65\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhosted_api_server(unused_tcp_port_factory: Callable[[], int], test_database_connection_url: Optional[str]) -> AsyncGenerator[str, None]\n```\n\nRuns an instance of the Prefect API server in a subprocess instead of the using the\nephemeral application.\n\nUses the same database as the rest of the tests.\n\n### `use_hosted_api_server` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L148\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nuse_hosted_api_server(hosted_api_server: str) -> Generator[str, None, None]\n```\n\nSets `PREFECT_API_URL` to the test session's hosted API endpoint.\n\n### `disable_hosted_api_server` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L162\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ndisable_hosted_api_server() -> Generator[None, None, None]\n```\n\nDisables the hosted API server by setting `PREFECT_API_URL` to `None`.\n\n### `enable_ephemeral_server` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L175\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nenable_ephemeral_server(disable_hosted_api_server: None) -> Generator[None, None, None]\n```\n\nEnables the ephemeral server by setting `PREFECT_SERVER_ALLOW_EPHEMERAL_MODE` to `True`.\n\n### `mock_anyio_sleep` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L192\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nmock_anyio_sleep(monkeypatch: pytest.MonkeyPatch) -> Generator[Callable[[float], None], None, None]\n```\n\nMock sleep used to not actually sleep but to set the current time to now + sleep\ndelay seconds while still yielding to other tasks in the event loop.\n\nProvides \"assert\\_sleeps\\_for\" context manager which asserts a sleep time occurred\nwithin the context while using the actual runtime of the context as a tolerance.\n\n### `recorder` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L295\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrecorder() -> Recorder\n```\n\n### `puppeteer` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L300\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\npuppeteer() -> Puppeteer\n```\n\n### `events_server` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L305\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nevents_server(unused_tcp_port: int, recorder: Recorder, puppeteer: Puppeteer) -> AsyncGenerator[Server, None]\n```\n\n### `events_api_url` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L378\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nevents_api_url(events_server: Server, unused_tcp_port: int) -> str\n```\n\n### `events_cloud_api_url` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L383\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nevents_cloud_api_url(events_server: Server, unused_tcp_port: int) -> str\n```\n\n### `mock_should_emit_events` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L388\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nmock_should_emit_events(monkeypatch: pytest.MonkeyPatch) -> mock.Mock\n```\n\n### `asserting_events_worker` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L396\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nasserting_events_worker(monkeypatch: pytest.MonkeyPatch) -> Generator[EventsWorker, None, None]\n```\n\n### `asserting_and_emitting_events_worker` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L409\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nasserting_and_emitting_events_worker(monkeypatch: pytest.MonkeyPatch) -> Generator[EventsWorker, None, None]\n```\n\n### `events_pipeline` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L422\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nevents_pipeline(asserting_events_worker: EventsWorker) -> AsyncGenerator[EventsPipeline, None]\n```\n\n### `emitting_events_pipeline` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L459\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nemitting_events_pipeline(asserting_and_emitting_events_worker: EventsWorker) -> AsyncGenerator[EventsPipeline, None]\n```\n\n### `reset_worker_events` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L475\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nreset_worker_events(asserting_events_worker: EventsWorker) -> Generator[None, None, None]\n```\n\n## Classes\n\n### `Recorder` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L265\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `Puppeteer` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/testing/fixtures.py#L278\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>",
  "content_length": 6925
}