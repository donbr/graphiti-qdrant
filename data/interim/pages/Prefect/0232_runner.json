{
  "title": "runner",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-runner-runner",
  "content": "# `prefect.runner.runner`\n\nRunners are responsible for managing the execution of all deployments.\n\nWhen creating a deployment using either `flow.serve` or the `serve` utility,\nthey also will poll for scheduled runs.\n\nExample:\n\n```python  theme={null}\nimport time\nfrom prefect import flow, serve\n\n\n@flow\ndef slow_flow(sleep: int = 60):\n    \"Sleepy flow - sleeps the provided amount of time (in seconds).\"\n    time.sleep(sleep)\n\n\n@flow\ndef fast_flow():\n    \"Fastest flow this side of the Mississippi.\"\n    return\n\n\nif __name__ == \"__main__\":\n    slow_deploy = slow_flow.to_deployment(name=\"sleeper\", interval=45)\n    fast_deploy = fast_flow.to_deployment(name=\"fast\")\n\n    # serve generates a Runner instance\n    serve(slow_deploy, fast_deploy)\n```\n\n## Classes\n\n### `ProcessMapEntry` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L144\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n### `Runner` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L149\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `add_deployment` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L287\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nadd_deployment(self, deployment: 'RunnerDeployment') -> UUID\n```\n\nRegisters the deployment with the Prefect API and will monitor for work once\nthe runner is started.\n\n**Args:**\n\n* `deployment`: A deployment for the runner to register.\n\n#### `add_flow` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L314\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nadd_flow(self, flow: Flow[Any, Any], name: Optional[str] = None, interval: Optional[Union[Iterable[Union[int, float, datetime.timedelta]], int, float, datetime.timedelta]] = None, cron: Optional[Union[Iterable[str], str]] = None, rrule: Optional[Union[Iterable[str], str]] = None, paused: Optional[bool] = None, schedule: Optional[Schedule] = None, schedules: Optional['FlexibleScheduleList'] = None, concurrency_limit: Optional[Union[int, ConcurrencyLimitConfig, None]] = None, parameters: Optional[dict[str, Any]] = None, triggers: Optional[List[Union[DeploymentTriggerTypes, TriggerTypes]]] = None, description: Optional[str] = None, tags: Optional[List[str]] = None, version: Optional[str] = None, enforce_parameter_schema: bool = True, entrypoint_type: EntrypointType = EntrypointType.FILE_PATH) -> UUID\n```\n\nProvides a flow to the runner to be run based on the provided configuration.\n\nWill create a deployment for the provided flow and register the deployment\nwith the runner.\n\n**Args:**\n\n* `flow`: A flow for the runner to run.\n* `name`: The name to give the created deployment. Will default to the name\n  of the runner.\n* `interval`: An interval on which to execute the current flow. Accepts either a number\n  or a timedelta object. If a number is given, it will be interpreted as seconds.\n* `cron`: A cron schedule of when to execute runs of this flow.\n* `rrule`: An rrule schedule of when to execute runs of this flow.\n* `paused`: Whether or not to set the created deployment as paused.\n* `schedule`: A schedule object defining when to execute runs of this deployment.\n  Used to provide additional scheduling options like `timezone` or `parameters`.\n* `schedules`: A list of schedule objects defining when to execute runs of this flow.\n  Used to define multiple schedules or additional scheduling options like `timezone`.\n* `concurrency_limit`: The maximum number of concurrent runs of this flow to allow.\n* `triggers`: A list of triggers that should kick of a run of this flow.\n* `parameters`: A dictionary of default parameter values to pass to runs of this flow.\n* `description`: A description for the created deployment. Defaults to the flow's\n  description if not provided.\n* `tags`: A list of tags to associate with the created deployment for organizational\n  purposes.\n* `version`: A version for the created deployment. Defaults to the flow's version.\n* `entrypoint_type`: Type of entrypoint to use for the deployment. When using a module path\n  entrypoint, ensure that the module will be importable in the execution environment.\n\n#### `cancel_all` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L544\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncancel_all(self) -> None\n```\n\n#### `execute_bundle` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L651\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nexecute_bundle(self, bundle: SerializedBundle, cwd: Path | str | None = None, env: dict[str, str | None] | None = None) -> None\n```\n\nExecutes a bundle in a subprocess.\n\n#### `execute_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L579\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nexecute_flow_run(self, flow_run_id: UUID, entrypoint: str | None = None, command: str | None = None, cwd: Path | str | None = None, env: dict[str, str | None] | None = None, task_status: anyio.abc.TaskStatus[int] = anyio.TASK_STATUS_IGNORED, stream_output: bool = True) -> anyio.abc.Process | multiprocessing.context.SpawnProcess | None\n```\n\nExecutes a single flow run with the given ID.\n\nExecution will wait to monitor for cancellation requests. Exits once\nthe flow run process has exited.\n\n**Returns:**\n\n* The flow run process.\n\n#### `execute_in_background` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L533\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nexecute_in_background(self, func: Callable[..., Any], *args: Any, **kwargs: Any) -> 'concurrent.futures.Future[Any]'\n```\n\nExecutes a function in the background.\n\n#### `handle_sigterm` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L435\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_sigterm(self, *args: Any, **kwargs: Any) -> None\n```\n\nGracefully shuts down the runner when a SIGTERM is received.\n\n#### `has_slots_available` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L1154\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhas_slots_available(self) -> bool\n```\n\nDetermine if the flow run limit has been reached.\n\n**Returns:**\n\n* * bool: True if the limit has not been reached, False otherwise.\n\n#### `reschedule_current_flow_runs` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L907\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nreschedule_current_flow_runs(self) -> None\n```\n\nReschedules all flow runs that are currently running.\n\nThis should only be called when the runner is shutting down because it kill all\nchild processes and short-circuit the crash detection logic.\n\n#### `start` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L444\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstart(self, run_once: bool = False, webserver: Optional[bool] = None) -> None\n```\n\nStarts a runner.\n\nThe runner will begin monitoring for and executing any scheduled work for all added flows.\n\n**Args:**\n\n* `run_once`: If True, the runner will through one query loop and then exit.\n* `webserver`: a boolean for whether to start a webserver for this runner. If provided,\n  overrides the default on the runner\n\n**Examples:**\n\nInitialize a Runner, add two flows, and serve them by starting the Runner:\n\n```python  theme={null}\nimport asyncio\nfrom prefect import flow, Runner\n\n@flow\ndef hello_flow(name):\n    print(f\"hello {name}\")\n\n@flow\ndef goodbye_flow(name):\n    print(f\"goodbye {name}\")\n\nif __name__ == \"__main__\"\n    runner = Runner(name=\"my-runner\")\n\n    # Will be runnable via the API\n    runner.add_flow(hello_flow)\n\n    # Run on a cron schedule\n    runner.add_flow(goodbye_flow, schedule={\"cron\": \"0 * * * *\"})\n\n    asyncio.run(runner.start())\n```\n\n#### `stop` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/runner/runner.py#L561\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstop(self)\n```\n\nStops the runner's polling cycle.",
  "content_length": 8888
}