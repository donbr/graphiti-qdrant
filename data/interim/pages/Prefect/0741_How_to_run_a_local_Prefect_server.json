{
  "title": "How to run a local Prefect server",
  "source_url": "https://docs-3.prefect.io/v3/how-to-guides/self-hosted/server-cli",
  "content": "Get started with self-hosting by running Prefect server locally.\n\nThe [Prefect CLI](/v3/get-started/install) is the easiest way to start a local instance of Prefect server.\n\n## Start the server\n\n1. Spin up a self-hosted Prefect server instance UI with the `prefect server start` CLI command in the terminal:\n\n```bash  theme={null}\nprefect server start\n```\n\n2. Open the URL for the Prefect server UI ([http://127.0.0.1:4200](http://127.0.0.1:4200) by default) in a browser.\n\n<img src=\"https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=455fc524a4713d0a15710471edc5ca63\" alt=\"Viewing the dashboard in the Prefect UI.\" data-og-width=\"2484\" width=\"2484\" data-og-height=\"1475\" height=\"1475\" data-path=\"v3/img/ui/self-hosted-server-dashboard.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?w=280&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=98822e1595dda10882658dcaee9e516d 280w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?w=560&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=0027b8c73ee8dff1b914caf23b24dd17 560w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?w=840&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=3cdeda13aa65efd4910e3c5c34703e00 840w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?w=1100&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=960f6558a26d3639108d198b602a83b8 1100w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?w=1650&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=c4b65c8b0e5a37008333bc0ea085ad42 1650w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/self-hosted-server-dashboard.png?w=2500&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=54e6ee3ec756ce20c13d523461918165 2500w\" />\n\n3. Shut down the Prefect server with ctrl  +  c in the terminal.\n\n## Configure the server\n\nGo to your terminal session and run this command to set the API URL to point to a self-hosted Prefect server instance:\n\n```bash  theme={null}\nprefect config set PREFECT_API_URL=\"http://127.0.0.1:4200/api\"\n```\n\nYou can save the API server address in a Prefect profile.\nWhenever that profile is active, the API endpoint is at that address.\nSee [Profiles and configuration](/v3/develop/settings-and-profiles/) for more information on profiles and configurable Prefect settings.\n\n## Database configuration\n\n### Use SQLite (default)\n\nBy default, Prefect uses a SQLite database stored at `~/.prefect/prefect.db`. No additional configuration is needed for basic use.\n\n### Use PostgreSQL\n\nTo use PostgreSQL as your database backend:\n\n1. Set the database connection URL:\n\n```bash  theme={null}\nprefect config set PREFECT_API_DATABASE_CONNECTION_URL=\"postgresql+asyncpg://postgres:yourTopSecretPassword@localhost:5432/prefect\"\n```\n\n2. Start the server:\n\n```bash  theme={null}\nprefect server start\n```\n\nFor more database configuration options, see the [database settings reference](/v3/api-ref/settings-ref#database).\n\n## Database management commands\n\n### Reset the database\n\nClear all data and reapply the schema:\n\n```bash  theme={null}\nprefect server database reset -y\n```\n\n### Manage migrations\n\nApply database migrations:\n\n```bash  theme={null}\n# Upgrade to the latest version\nprefect server database upgrade -y\n\n# Downgrade to the previous version\nprefect server database downgrade -y -r -1\n\n# Downgrade to a specific revision\nprefect server database downgrade -y -r d20618ce678e\n```\n\nFor large databases, you may need to increase the timeout:\n\n```bash  theme={null}\nexport PREFECT_API_DATABASE_TIMEOUT=600\nprefect server database upgrade -y\n```\n\n## Multi-worker API server\n\nFor high-throughput scenarios, you can run the server with multiple worker processes to handle concurrent requests more efficiently:\n\n```bash  theme={null}\nprefect server start --workers 4\n```\n\nThis starts 4 worker processes to handle API and UI requests concurrently.\n\n### Requirements for multi-worker mode\n\nMulti-worker mode has specific infrastructure requirements:\n\n1. **PostgreSQL database** - SQLite is not supported due to database locking issues\n2. **Redis messaging** - In-memory messaging doesn't work across processes\n\n### Configuration example\n\n```bash  theme={null}\n# Set PostgreSQL connection\nprefect config set PREFECT_API_DATABASE_CONNECTION_URL=\"postgresql+asyncpg://postgres:password@localhost:5432/prefect\"\n\n# Configure Redis messaging\nprefect config set PREFECT_SERVER_EVENTS_MESSAGING_CACHE=\"prefect.server.utilities.messaging.redis\"\nprefect config set PREFECT_SERVER_EVENTS_MESSAGING_BROKER=\"prefect.server.utilities.messaging.redis\"\n\n# Configure Redis messaging host and port\nexport PREFECT_REDIS_MESSAGING_HOST=\"redis\"\nexport PREFECT_REDIS_MESSAGING_PORT=\"6379\"\n\n# Start server with 4 workers\nprefect server start --workers 4\n```\n\n<Tip>\n  The number of workers should typically match the number of CPU cores available to your server process, but you may need to experiment to find the optimal value for your workload.\n</Tip>\n\n## Advanced configuration\n\nFor advanced deployment scenarios including:\n\n* Running behind a reverse proxy\n* Configuring SSL certificates\n* Multi-server deployments\n* Handling migration issues\n\nSee [How to scale self-hosted Prefect](/v3/advanced/self-hosted).",
  "content_length": 5482
}