{
  "title": "task_runs",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-server-models-task_runs",
  "content": "# `prefect.server.models.task_runs`\n\nFunctions for interacting with task run ORM objects.\nIntended for internal use by the Prefect REST API.\n\n## Functions\n\n### `create_task_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L51\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_task_run(db: PrefectDBInterface, session: AsyncSession, task_run: schemas.core.TaskRun, orchestration_parameters: Optional[Dict[str, Any]] = None) -> orm_models.TaskRun\n```\n\nCreates a new task run.\n\nIf a task run with the same flow\\_run\\_id, task\\_key, and dynamic\\_key already exists,\nthe existing task run will be returned. If the provided task run has a state\nattached, it will also be created.\n\n**Args:**\n\n* `session`: a database session\n* `task_run`: a task run model\n\n**Returns:**\n\n* orm\\_models.TaskRun: the newly-created or existing task run\n\n### `update_task_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L151\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nupdate_task_run(db: PrefectDBInterface, session: AsyncSession, task_run_id: UUID, task_run: schemas.actions.TaskRunUpdate) -> bool\n```\n\nUpdates a task run.\n\n**Args:**\n\n* `session`: a database session\n* `task_run_id`: the task run id to update\n* `task_run`: a task run model\n\n**Returns:**\n\n* whether or not matching rows were found to update\n\n### `read_task_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L180\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_task_run(db: PrefectDBInterface, session: AsyncSession, task_run_id: UUID) -> Union[orm_models.TaskRun, None]\n```\n\nRead a task run by id.\n\n**Args:**\n\n* `session`: a database session\n* `task_run_id`: the task run id\n\n**Returns:**\n\n* orm\\_models.TaskRun: the task run\n\n### `read_task_run_with_flow_run_name` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L199\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_task_run_with_flow_run_name(db: PrefectDBInterface, session: AsyncSession, task_run_id: UUID) -> Union[orm_models.TaskRun, None]\n```\n\nRead a task run by id.\n\n**Args:**\n\n* `session`: a database session\n* `task_run_id`: the task run id\n\n**Returns:**\n\n* orm\\_models.TaskRun: the task run with the flow run name\n\n### `read_task_runs` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L310\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nread_task_runs(db: PrefectDBInterface, session: AsyncSession, flow_filter: Optional[schemas.filters.FlowFilter] = None, flow_run_filter: Optional[schemas.filters.FlowRunFilter] = None, task_run_filter: Optional[schemas.filters.TaskRunFilter] = None, deployment_filter: Optional[schemas.filters.DeploymentFilter] = None, offset: Optional[int] = None, limit: Optional[int] = None, sort: schemas.sorting.TaskRunSort = schemas.sorting.TaskRunSort.ID_DESC) -> Sequence[orm_models.TaskRun]\n```\n\nRead task runs.\n\n**Args:**\n\n* `session`: a database session\n* `flow_filter`: only select task runs whose flows match these filters\n* `flow_run_filter`: only select task runs whose flow runs match these filters\n* `task_run_filter`: only select task runs that match these filters\n* `deployment_filter`: only select task runs whose deployments match these filters\n* `offset`: Query offset\n* `limit`: Query limit\n* `sort`: Query sort\n\n**Returns:**\n\n* List\\[orm\\_models.TaskRun]: the task runs\n\n### `count_task_runs` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L361\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncount_task_runs(db: PrefectDBInterface, session: AsyncSession, flow_filter: Optional[schemas.filters.FlowFilter] = None, flow_run_filter: Optional[schemas.filters.FlowRunFilter] = None, task_run_filter: Optional[schemas.filters.TaskRunFilter] = None, deployment_filter: Optional[schemas.filters.DeploymentFilter] = None) -> int\n```\n\nCount task runs.\n\n**Args:**\n\n* `session`: a database session\n* `flow_filter`: only count task runs whose flows match these filters\n* `flow_run_filter`: only count task runs whose flow runs match these filters\n* `task_run_filter`: only count task runs that match these filters\n* `deployment_filter`: only count task runs whose deployments match these filters\n\nReturns:\nint: count of task runs\n\n### `count_task_runs_by_state` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L418\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncount_task_runs_by_state(db: PrefectDBInterface, session: AsyncSession, flow_filter: Optional[schemas.filters.FlowFilter] = None, flow_run_filter: Optional[schemas.filters.FlowRunFilter] = None, task_run_filter: Optional[schemas.filters.TaskRunFilter] = None, deployment_filter: Optional[schemas.filters.DeploymentFilter] = None) -> schemas.states.CountByState\n```\n\nCount task runs by state.\n\n**Args:**\n\n* `session`: a database session\n* `flow_filter`: only count task runs whose flows match these filters\n* `flow_run_filter`: only count task runs whose flow runs match these filters\n* `task_run_filter`: only count task runs that match these filters\n* `deployment_filter`: only count task runs whose deployments match these filters\n\nReturns:\nschemas.states.CountByState: count of task runs by state\n\n### `delete_task_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L465\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ndelete_task_run(db: PrefectDBInterface, session: AsyncSession, task_run_id: UUID) -> bool\n```\n\nDelete a task run by id.\n\n**Args:**\n\n* `session`: a database session\n* `task_run_id`: the task run id to delete\n\n**Returns:**\n\n* whether or not the task run was deleted\n\n### `set_task_run_state` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L485\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nset_task_run_state(session: AsyncSession, task_run_id: UUID, state: schemas.states.State, force: bool = False, task_policy: Optional[Type[TaskRunOrchestrationPolicy]] = None, orchestration_parameters: Optional[Dict[str, Any]] = None) -> OrchestrationResult\n```\n\nCreates a new orchestrated task run state.\n\nSetting a new state on a run is the one of the principal actions that is governed by\nPrefect's orchestration logic. Setting a new run state will not guarantee creation,\nbut instead trigger orchestration rules to govern the proposed `state` input. If\nthe state is considered valid, it will be written to the database. Otherwise, a\nit's possible a different state, or no state, will be created. A `force` flag is\nsupplied to bypass a subset of orchestration logic.\n\n**Args:**\n\n* `session`: a database session\n* `task_run_id`: the task run id\n* `state`: a task run state model\n* `force`: if False, orchestration rules will be applied that may alter or prevent\n  the state transition. If True, orchestration rules are not applied.\n\n**Returns:**\n\n* OrchestrationResult object\n\n### `with_system_labels_for_task_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/models/task_runs.py#L569\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nwith_system_labels_for_task_run(session: AsyncSession, task_run: schemas.core.TaskRun) -> schemas.core.KeyValueLabels\n```\n\nAugment user supplied labels with system default labels for a task\nrun.",
  "content_length": 8096
}