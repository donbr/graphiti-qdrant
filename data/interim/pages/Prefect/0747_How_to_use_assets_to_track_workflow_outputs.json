{
  "title": "How to use assets to track workflow outputs",
  "source_url": "https://docs-3.prefect.io/v3/how-to-guides/workflows/assets",
  "content": "<span class=\"badge cloud\" />\n\nAssets in Prefect represent important outputs (such as data) that are produced by your tasks and flows. Assets can reference virtually any output such as files, dataframes, tables, dashboards, or ML models. By using the `@materialize` decorator, you can track when your workflows create, update, or reference these objects.\n\n## Basic asset materialization\n\nUse the `@materialize` decorator to mark functions that create or update assets. This decorator wraps your function similar to `@task` but specifically tracks asset creation:\n\n```python  theme={null}\nfrom prefect import flow\nfrom prefect.assets import materialize\n\n@materialize(\"s3://my-bucket/processed-data.csv\")\ndef process_data(data: dict) -> dict:\n    # Your data processing logic here\n    # save_to_s3(data, \"s3://my-bucket/processed-data.csv\")\n    return data\n\n@flow\ndef data_pipeline(data: dict):\n    process_data(data)\n```\n\nAsset keys must be valid URIs that uniquely identify your workflow outputs. Assets are automatically grouped by type (specified by the URI prefix) and can be nested based on the URI path structure. For example, `s3://` assets are grouped separately from `postgres://` assets, and nested paths like `s3://bucket/team-a/data.csv` and `s3://bucket/team-b/data.csv` create hierarchical organization.\n\n<Note>\n  **`@materialize` wraps `@task`**: the `@materialize` decorator accepts all keyword arguments and configuration that the `@task` decorator accepts and can be used as a drop-in replacement.\n</Note>\n\n## Asset dependencies\n\n### Inferred from task graphs\n\nPrefect automatically infers asset dependencies from your task graph. When materialized assets flow through your workflow, downstream materializations inherit these dependencies:\n\n```python  theme={null}\nfrom prefect import flow\nfrom prefect.assets import materialize\n\n\n@materialize(\"file://my-local-directory/raw-data.csv\")\ndef extract_data() -> str:\n    raw_data = \"name,age\\nchris,21\"\n    with open(\"raw-data.csv\", \"w\") as f:\n        f.write(raw_data)\n    return raw_data\n\n\n@materialize(\"s3://my-bucket/clean-data.csv\")\ndef transform_data(raw_data):\n    # saves raw_data to s3\n    pass\n\n\n@flow\ndef etl_pipeline():\n    raw_data = extract_data()\n    transform_data(raw_data)  # Automatically depends on raw-data.csv\n```\n\nRunning this flow produces the following asset graph:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=f94e8971f57299cd43e178177ec977e6\" alt=\"Asset Graph in the UI\" data-og-width=\"2168\" width=\"2168\" data-og-height=\"1050\" height=\"1050\" data-path=\"v3/img/guides/assets-1.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?w=280&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=3942dff6aebbc16b3003edd0f1157939 280w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?w=560&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=891215c14054dde3756f57a42ee0be4e 560w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?w=840&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=ff37d171b4ed22c84448b970efd2ce92 840w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?w=1100&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=8e8831d3dee4e393723911d2de11af4e 1100w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?w=1650&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=b374943828b27175579a47e7f37b3930 1650w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-1.png?w=2500&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=347f9e4f85d98a235f6cb27833b3813f 2500w\" />\n\n### External and cross-flow asset dependencies\n\nUse `asset_deps` to reference assets that are external to your current workflow. This creates dependencies on assets that may be materialized by other flows, external systems, or manual processes:\n\n```python  theme={null}\nfrom prefect import flow\nfrom prefect.assets import materialize\n\n\n# Depends on asset from another Prefect flow\n@materialize(\n    \"s3://my-bucket/downstream-data.csv\",\n    asset_deps=[\"s3://my-bucket/upstream-data.csv\"]  # From different flow\n)\ndef process_downstream_data():\n    pass\n\n# Depends on external system assets\n@materialize(\n    \"s3://my-bucket/enriched-data.csv\",\n    asset_deps=[\n        \"postgres://db/users_table\",      # External database\n        \"sftp://vendor/daily-feed.csv\"    # External data feed\n    ]\n)\ndef enrich_user_data():\n    pass\n\n@flow\ndef analytics_pipeline():\n    process_downstream_data()\n    enrich_user_data()\n```\n\nRunning this flow produces the following asset graph:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=c64f005627357c5ddaf1e46552291c71\" alt=\"Asset Graph in the UI\" data-og-width=\"1920\" width=\"1920\" data-og-height=\"1288\" height=\"1288\" data-path=\"v3/img/guides/assets-2.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?w=280&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=c1c62e2c56fe4a48a43a0bb5cdc29a73 280w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?w=560&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=d2f64e0e1d585c5acec95dedf06b5c60 560w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?w=840&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=73ca041924db8b1c57a13db8212ebf31 840w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?w=1100&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=d56b80723f2088d45b13a863f0cc86b7 1100w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?w=1650&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=d110be8dcd989769d3264d544424dea4 1650w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/assets-2.png?w=2500&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=f78547f2d31b6c70e9c3efae4ed8d203 2500w\" />\n\nThis approach allows you to model your complete data ecosystem, tracking dependencies even when some assets are managed outside your current workflow or outside Prefect entirely.\n\n## Multiple asset materialization\n\nMaterialize multiple related assets in a single function when they share the same upstream dependencies:\n\n```python  theme={null}\nfrom prefect.assets import materialize\n\n\n@materialize(\n    \"s3://my-bucket/summary.csv\",\n    \"s3://my-bucket/details.csv\"\n)\ndef generate_reports():\n    data = fetch_source_data()\n    create_summary_report(data)\n    create_detailed_report(data)\n```\n\n## Dynamic asset materialization\n\nUse [the `with_options` pattern](/v3/api-ref/python/prefect-tasks#with-options) to dynamically change asset keys and dependencies at runtime. This is useful when you need to parameterize asset paths based on flow inputs, dates, or other runtime conditions:\n\n```python  theme={null}\nfrom prefect import flow\nfrom prefect.assets import materialize\nfrom datetime import datetime\n\n\n@materialize(\"s3://my-bucket/daily-report.csv\")\ndef generate_daily_report(date: str):\n    # Process and save daily report\n    pass\n\n\n@flow\ndef dynamic_reporting_pipeline():\n    base_task = generate_daily_report\n    today = datetime.now().strftime(\"%Y-%m-%d\")\n    \n    # Dynamically set asset key based on date\n    daily_task = base_task.with_options(\n        assets=[f\"s3://my-bucket/reports/{today}/daily-report.csv\"]\n    )\n    \n    daily_task(today)\n```\n\nYou can also dynamically modify asset dependencies alongside the materialized assets:\n\n```python  theme={null}\nfrom prefect import flow\nfrom prefect.assets import materialize\n\n\n@materialize(\n    \"s3://my-bucket/processed-data.csv\",\n    asset_deps=[\"s3://my-bucket/raw-data.csv\"]\n)\ndef process_data(environment: str):\n    pass\n\n\n@flow\ndef environment_specific_pipeline(env: str):\n    base_task = process_data\n    \n    # Use different assets based on environment\n    env_task = base_task.with_options(\n        assets=[f\"s3://my-bucket/{env}/processed-data.csv\"],\n        asset_deps=[f\"s3://my-bucket/{env}/raw-data.csv\"]\n    )\n    \n    env_task(env)\n```\n\nThis pattern enables you to reuse the same processing logic across different environments, time periods, or data partitions while maintaining proper asset lineage tracking.\n\n## Further Reading\n\n* [How to customize asset metadata](/v3/advanced/assets)\n* [Learn about asset health and asset events](/v3/concepts/assets)",
  "content_length": 8545
}