{
  "title": "Settings and profiles",
  "source_url": "https://docs-3.prefect.io/v3/concepts/settings-and-profiles",
  "content": "Prefect settings let you customize behavior across different environments.\n\n## Why use settings?\n\nSettings in Prefect help you control how your workflows behave. They let you easily customize Prefect to work the way you need it to, whether you're testing locally or running in production.\n\nSpecifically, settings enable:\n\n* **Environment-Specific Configuration**: Use different settings for development (like detailed logging), testing (like test databases), and production (like your production server) without changing your workflow code.\n\n* **Runtime Flexibility**: Quickly adjust things like retry attempts or logging levels without having to modify and redeploy your workflows.\n\n## Get started with settings\n\nThe simplest way declare settings is by creating a `prefect.toml` file in your project directory. For example:\n\n```toml prefect.toml theme={null}\n# Set more detailed logging while developing\n[logging]\nlevel = \"DEBUG\"\n```\n\n<Note>\n  To use `prefect.toml` or `pyproject.toml` for configuration, `prefect>=3.1` must be installed.\n\n  To use a `.env` file for configuration, `prefect>=3.0.5` must be installed.\n</Note>\n\nMost editors have plugins for TOML that provide syntax highlighting, linting, and autocomplete for `prefect.toml` files. If you use VSCode, we recommend the [Even Better TOML extension](https://marketplace.visualstudio.com/items?itemName=tamasfe.even-better-toml).\n\n<Tip>\n  **Writing TOML**\n\n  TOML is a simple configuration language. If you're new to TOML, learn more about the syntax in the [official documentation](https://toml.io/en/).\n\n  In particular, note that TOML uses square brackets to denote [tables](https://toml.io/en/v1.0.0#table), which are analogous to dictionaries in Python.\n</Tip>\n\n## Settings sources\n\nYou can configure settings via the following sources (highest to lowest precedence):\n\n* **Environment variables**: Environment variables are useful for temporarily overriding settings or configuring the runtime environment of a single workflow run.\n\n* **`.env` file**: `.env` files are useful for declaring local settings that you want to apply across multiple runs.\n\n* **`prefect.toml` file**: A `prefect.toml` file is useful when you want to declare settings for an entire project. You can keep this file in your project directory and it will be automatically applied regardless of where you run your project.\n\n* **`pyproject.toml` file**: If you already have a `pyproject.toml` file in your project or like to consolidate settings for all your tools in one place, you can declare settings in the `[tool.prefect]` table of your `pyproject.toml` file.\n\n* **Profiles**: Prefect profiles are useful for switching between different environments. For example, you might use one profile for a local Prefect server and another for your production environment.\n\nWhen multiple settings sources define the same setting, Prefect follows this precedence order (highest to lowest):\n\n<Steps>\n  <Step title=\"Environment variables\" />\n\n  <Step title=\".env file in the current working directory\" />\n\n  <Step title=\"prefect.toml file in the current working directory\" />\n\n  <Step title=\"pyproject.toml file in the current working directory\" />\n\n  <Step title=\"Active profile settings\" />\n\n  <Step title=\"Default values\" />\n</Steps>\n\nFor example, if you set `PREFECT_API_URL` in both your environment and your active profile, the environment variable value will take precedence.\n\n### Environment variables\n\nEnvironment variables are useful for temporarily overriding settings or configuring the runtime environment of a workflow.\n\nAll Prefect settings can be set using environment variables prefixed with `PREFECT_`. They take precedence over all other sources, making them ideal for adjustments that should only apply to a single session or process.\n\nFor example, you can run the following command to temporarily set the logging level for a single flow run:\n\n```bash  theme={null}\nPREFECT_LOGGING_LEVEL=\"DEBUG\" python my_flow.py\n```\n\nYou can also export an environment variable in your shell to apply it to all flow runs in that shell session:\n\n```bash  theme={null}\nexport PREFECT_LOGGING_LEVEL=\"DEBUG\"\nprefect run my_flow.py\n```\n\nYou can see supported environment variables for each setting in the [settings reference documentation](/v3/develop/settings-ref).\n\n<Tip>\n  **Environment variables *always* take precedence**\n\n  Environment variables always take precedence over values declared in other sources.\n  This allows you to configure certain runtime behavior for your workflows by setting the appropriate\n  environment variable on the job or process executing the workflow.\n</Tip>\n\n### `.env` file\n\n`.env` files are useful for declaring local settings that you want to apply across multiple runs.\n\nWhen running `prefect` in a directory that contains a `.env` file, Prefect will automatically apply the settings in the file. We recommend keeping your `.env` files local and not committing them to your code repositories.\n\nFor example, the following `.env` file declares a local setting for the logging level:\n\n```bash .env theme={null}\nPREFECT_LOGGING_LEVEL=\"DEBUG\"\n```\n\nAny flows run in the same directory as this `.env` file will use the `DEBUG` logging level, even if they are run in different shell sessions.\n\nView supported environment variables for each setting in the [settings reference documentation](/v3/develop/settings-ref).\n\n### `prefect.toml` file\n\nA `prefect.toml` file is useful when you want to declare settings for an entire project.\n\nYou can keep a `prefect.toml` file in your project directory and the declared settings will be automatically applied when running `prefect` in that directory. We recommend committing this file to your code repositories to ensure consistency across environments.\n\nFor example, the following `prefect.toml` file declares a setting for the logging level:\n\n```toml prefect.toml theme={null}\n[logging]\nlevel = \"DEBUG\"\n```\n\nIf you commit your `prefect.toml` file to a code repository, creating deployments from flows in that repository will use the settings declared in the `prefect.toml` file.\n\nYou can see the `prefect.toml` path for each setting in the [settings reference documentation](/v3/develop/settings-ref).\n\n### `pyproject.toml` file\n\nDeclaring settings in a `pyproject.toml` file is very similar to declaring settings in a `prefect.toml` file. The main difference is that settings are declared in the `[tool.prefect]` table instead of at the root of the file.\n\nFor example, the following `pyproject.toml` file declares a setting for the logging level:\n\n```toml pyproject.toml theme={null}\n[tool.prefect]\nlogging.level = \"DEBUG\"\n```\n\nThe advantage of declaring settings in a `pyproject.toml` file is that it allows you to keep all your dependencies and settings for all your tools in one place. You can learn more about `pyproject.toml` files in the [Python Packaging User Guide](https://packaging.python.org/en/latest/specifications/pyproject-toml/#arbitrary-tool-configuration-the-tool-table).\n\n### Profiles\n\nPrefect profiles are useful for switching between different environments. By creating different profiles with different API URLs, you can easily switch between a local Prefect server and your production environment.\n\nProfiles are stored in a [TOML](https://toml.io/en/) file located at `~/.prefect/profiles.toml` by default. This location can be configured by setting `PREFECT_PROFILES_PATH`.\n\nOne and only one profile can be active at any time.\n\nImmediately after installation, the `ephemeral` profile will be used, which only has `PREFECT_SERVER_ALLOW_EPHEMERAL_MODE` configured:\n\n<Tip>\n  **What is `PREFECT_SERVER_ALLOW_EPHEMERAL_MODE`?**\n\n  This setting allows a Prefect server to be run ephemerally as needed without explicitly starting a server process.\n</Tip>\n\nThe `prefect profile` CLI commands enable you to create, review, and manage profiles:\n\n| Command             | Description                                                                        |\n| ------------------- | ---------------------------------------------------------------------------------- |\n| `create`            | Create a new profile; use the `--from` flag to copy settings from another profile. |\n| `delete`            | Delete the given profile.                                                          |\n| `inspect`           | Display settings from a given profile; defaults to active.                         |\n| `ls`                | List all profile names.                                                            |\n| `rename`            | Change the name of a profile.                                                      |\n| `use`               | Switch the active profile.                                                         |\n| `populate-defaults` | Populate your `profiles.toml` file with opinionated stock profiles.                |\n\n... or you may edit your `profiles.toml` file directly:\n\n```bash  theme={null}\nvim ~/.prefect/profiles.toml\n```\n\n#### Configure settings for the active profile\n\nThe `prefect config` CLI commands enable you to manage the settings within the currently active profile.\n\n| Command | Description                              |\n| ------- | ---------------------------------------- |\n| set     | Change the value for a setting.          |\n| unset   | Restore the default value for a setting. |\n| view    | Display the current settings.            |\n\nFor example, the following CLI commands set configuration in the `ephemeral` profile and then create a new\nprofile with new settings:\n\n```bash  theme={null}\nprefect profile use ephemeral\nprefect config set PREFECT_API_URL=http://127.0.0.1:4200/api\n\nprefect profile create new-profile --from ephemeral\nprefect profile use new-profile\nprefect config set PREFECT_RESULTS_PERSIST_BY_DEFAULT=true PREFECT_LOGGING_LEVEL=\"ERROR\"\n\nprefect profile inspect\nprefect config unset PREFECT_LOGGING_LEVEL -y\n```\n\n## Common client settings\n\n* [`api.url`](/v3/develop/settings-ref/#url): this setting specifies the API endpoint of your\n  Prefect Cloud workspace or a self-hosted Prefect server instance.\n* [`api.key`](/v3/develop/settings-ref/#key): this setting specifies the\n  [API key](/v3/how-to-guides/cloud/manage-users/api-keys) used to authenticate with Prefect Cloud.\n* [`home`](/v3/develop/settings-ref/#home): the `home` value specifies the local Prefect directory for configuration files,\n  profiles, and the location of the default Prefect SQLite database.\n\n<Tip>\n  **Use `prefect cloud login` to set these values for Prefect Cloud**\n\n  To set `PREFECT_API_URL` and `PREFECT_API_KEY` for your active profile, run `prefect cloud login`.\n  Read more about [managing API keys](/v3/how-to-guides/cloud/manage-users/api-keys).\n</Tip>\n\n## Common server settings\n\n* [`server.database.connection_url`](/v3/develop/settings-ref#connection-url): the database connection URL for a self-hosted Prefect server instance.\n  Must be provided in a SQLAlchemy-compatible format. Prefect currently supports SQLite and Postgres.",
  "content_length": 10993
}