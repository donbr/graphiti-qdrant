{
  "title": "Measure reliability with Service Level Agreements",
  "source_url": "https://docs-3.prefect.io/v3/concepts/slas",
  "content": "Define the performance expectations for your flows and to enable automated alerts when those expectations are not met.\n\n<Warning> <b>Experimental:</b> This feature is experimental and may change in the future.</Warning>\n\n## Prerequisites\n\n* Prefect Client Version 3.1.12 or later\n* Prefect Cloud account (SLAs are only available in Prefect Cloud)\n* (If using Terraform) [Prefect Terraform Provider](https://registry.terraform.io/providers/PrefectHQ/prefect/latest/docs) version 2.22.0 or later\n\n## Service Level Agreements\n\n<span class=\"badge cloud\" /> Service Level Agreements (SLAs) help you set and monitor performance standards for your data stack. By establishing specific thresholds for flow runs on your Deployments, you can automatically detect when your system isn't meeting expectations.\nWhen you set up an SLA, you define specific performance criteria - such as a maximum runtime of 10 minutes for a flow. If a flow run exceeds this threshold, the system generates an alert event. You can then use these events to trigger automated responses, whether that's sending notifications to your team or initiating other corrective actions through automations.\n\n## Defining SLAs\n\nTo define an SLA you can add it to the deployment through a `prefect.yaml` file, a `.deploy` method, or the CLI:\n\n<AccordionGroup>\n  <Accordion title=\"Defining SLAs in your prefect.yaml file\">\n    ```yaml prefect.yaml SLA theme={null}\n    deployments:\n      my-deployment:\n        sla:\n            - name: \"time-to-completion\"\n              duration: 10\n              severity: \"high\"\n            - name: \"lateness\"\n              within: 600\n              severity: \"high\"\n    ```\n  </Accordion>\n\n  <Accordion title=\"Defining SLAs using a .deploy method\">\n    ```python .deploy SLA theme={null}\n        from prefect import flow\n        from prefect._experimental.sla.objects import TimeToCompletionSla, LatenessSla, FrequencySla\n\n        @flow\n        def my_flow():\n            pass\n\n        flow.from_source(\n            source=source,\n            entrypoint=\"my_file.py:my_flow\",\n        ).deploy(\n            name=\"my-deployment\",\n            work_pool_name=\"my_pool\",\n            _sla=[\n                TimeToCompletionSla(name=\"my-time-to-completion-sla\", duration=30, severity=\"high\"),\n                LatenessSla(name=\"my-lateness-sla\", within=timedelta(minutes=10), severity=\"high\"),\n                FrequencySla(name=\"my-frequency-sla\", stale_after=timedelta(hours=1), severity=\"high\"),\n            ]\n        )\n    ```\n  </Accordion>\n\n  <Accordion title=\"Defining SLAs with the Prefect CLI\">\n    ```bash CLI SLA theme={null}\n    prefect deploy --sla '{\"name\": \"my-time-to-completion-sla\", \"duration\": 10, \"severity\": \"high\"}'\n    ```\n  </Accordion>\n\n  <Accordion title=\"Defining SLAs with the Terraform Provider\">\n    ```hcl Terraform Provider theme={null}\n    provider \"prefect\" {}\n\n    resource \"prefect_flow\" \"my_flow\" {\n      name = \"my-flow\"\n    }\n\n    resource \"prefect_deployment\" \"my_deployment\" {\n      name    = \"my-deployment\"\n      flow_id = prefect_flow.my_flow.id\n    }\n\n    resource \"prefect_resource_sla\" \"slas\" {\n      resource_id = \"prefect.deployment.${prefect_deployment.my_deployment.id}\"\n      slas = [\n        {\n          name     = \"my-time-to-completion-sla\"\n          severity = \"high\"\n          duration = 30\n        },\n        {\n          name     = \"my-lateness-sla\"\n          severity = \"high\"\n          within   = 600\n        },\n        {\n          name        = \"my-frequency-sla\"\n          severity    = \"high\"\n          stale_after = 3600\n        }\n      ]\n    }\n    ```\n  </Accordion>\n</AccordionGroup>\n\n## Types of SLAs\n\n### Time to Completion SLA\n\nA Time to Completion SLA describes how long flow runs should take and the severity of going over that duration.\nThe SLA is triggered when a flow run takes longer than the specified duration to complete.\n\nThe Time to Completion SLA requires one unique parameter:\n\n* `duration`: The maximum allowed duration in seconds before the SLA is violated\n\nThis SLA is useful for monitoring long-running flows and ensuring they complete within an expected timeframe.\nFor example, if you set a Time to Completion SLA on your deployment with a `duration` of 600 seconds (10 minutes) the backend will emit an `prefect.sla.violation` event if a flow run does not complete within that timeframe.\n\n### Frequency SLA\n\nA Frequency SLA describes the interval a deployment should run at and the severity of missing that interval.\n\nThe Frequency SLA requires one unique parameter:\n\n* `stale_after`: The maximum allowed time between flow runs (e.g. `1 hour` for hourly jobs)\n\nFor example, if you have a deployment that should run every hour, you can set up a Frequency SLA with a `stale_after` of 1 hour.\nThis SLA triggers when more than an hour passes between `Completed` flow runs.\n\n### Lateness SLA\n\nA Lateness SLA describes the severity of a flow run failing to start at its scheduled time.\n\nThe Lateness SLA requires one unique parameter:\n\n* `within`: The amount of startup time allotted to a flow run before the SLA is violated.\n\nFor example, if a deployment is scheduled to run every day at 10am, and has a Lateness SLA of 5 minutes, the backend will emit an SLA violation event if a flow run does not start by 10:05am.\n\n## Monitoring SLAs\n\nYou can monitor SLAs in the Prefect Cloud UI. On the runs page you can see the SLA status in the top level metrics:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=1e48e62b8e670119d56a333ca3561e16\" alt=\"SLA status\" data-og-width=\"3026\" width=\"3026\" data-og-height=\"730\" height=\"730\" data-path=\"v3/img/ui/sla-overview.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?w=280&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=29d21b91dbdfa7d8df313b8e41a642bf 280w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?w=560&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=604fd8dd5d7e88cf70dda25108c7c578 560w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?w=840&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=56ba57b46ffb3bae7c739390911dc017 840w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?w=1100&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=08d5648d7ef43f1272f6072044d6e6ac 1100w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?w=1650&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=44a7d01a0b995580e4516561eb308368 1650w, https://mintcdn.com/prefect-bd373955/dwD6EJObIjtIzwSC/v3/img/ui/sla-overview.png?w=2500&fit=max&auto=format&n=dwD6EJObIjtIzwSC&q=85&s=5321d664a963370144f50e247b71caaf 2500w\" />\n\n## Setting up an automation\n\nTo set up an automation to notify a team or to take other actions when an SLA is triggered, you can use the [automations](/v3/automate/events/automations-triggers/) feature. To create the automation first you'll need to create a trigger.\n\n1. Choose trigger type 'Custom'.\n2. Choose any event matching: `prefect.sla.violation`\n3. For \"From the Following Resources\" choose: `prefect.flow-run.*`\n\n<img src=\"https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=9dca987a16c4d0c5501c7e87b9d33c04\" alt=\"Create an automation\" data-og-width=\"3026\" width=\"3026\" data-og-height=\"1788\" height=\"1788\" data-path=\"v3/img/ui/sla-trigger-automation.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?w=280&fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=482a1c3ea0d408fab0bf13e3f654c227 280w, https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?w=560&fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=a572a17d05a1b1a28d5794fd89f1b4e2 560w, https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?w=840&fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=fec05464f868c8fc486cf377868b97cc 840w, https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?w=1100&fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=37d8e69a1ce2df3d2646c54391640912 1100w, https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?w=1650&fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=42fee6782e194d0e1e4ddb66040faa92 1650w, https://mintcdn.com/prefect-bd373955/rT_XiX8cZI7Bzt5c/v3/img/ui/sla-trigger-automation.png?w=2500&fit=max&auto=format&n=rT_XiX8cZI7Bzt5c&q=85&s=da10cb229bb58f5ca4517b3865727a6a 2500w\" />\n\nAfter creating the trigger, you can create an automation to notify a team or to take other actions when an SLA is triggered using [automations](/v3/automate/events/automations-triggers/).",
  "content_length": 8879
}