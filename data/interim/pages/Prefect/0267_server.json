{
  "title": "server",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-server-api-server",
  "content": "# `prefect.server.api.server`\n\nDefines the Prefect REST API FastAPI app.\n\n## Functions\n\n### `validation_exception_handler` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L195\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nvalidation_exception_handler(request: Request, exc: RequestValidationError) -> JSONResponse\n```\n\nProvide a detailed message for request validation errors.\n\n### `integrity_exception_handler` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L211\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nintegrity_exception_handler(request: Request, exc: Exception) -> JSONResponse\n```\n\nCapture database integrity errors.\n\n### `is_client_retryable_exception` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L226\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nis_client_retryable_exception(exc: Exception) -> bool\n```\n\n### `replace_placeholder_string_in_files` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L255\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nreplace_placeholder_string_in_files(directory: str, placeholder: str, replacement: str, allowed_extensions: list[str] | None = None) -> None\n```\n\nRecursively loops through all files in the given directory and replaces\na placeholder string.\n\n### `copy_directory` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L282\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncopy_directory(directory: str, path: str) -> None\n```\n\n### `custom_internal_exception_handler` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L302\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncustom_internal_exception_handler(request: Request, exc: Exception) -> JSONResponse\n```\n\nLog a detailed exception for internal server errors before returning.\n\nSend 503 for errors clients can retry on.\n\n### `prefect_object_not_found_exception_handler` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L327\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nprefect_object_not_found_exception_handler(request: Request, exc: ObjectNotFoundError) -> JSONResponse\n```\n\nReturn 404 status code on object not found exceptions.\n\n### `create_api_app` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L339\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_api_app(dependencies: list[Any] | None = None, health_check_path: str = '/health', version_check_path: str = '/version', fast_api_app_kwargs: dict[str, Any] | None = None, final: bool = False, ignore_cache: bool = False) -> FastAPI\n```\n\nCreate a FastAPI app that includes the Prefect REST API\n\n**Args:**\n\n* `dependencies`: a list of global dependencies to add to each Prefect REST API router\n* `health_check_path`: the health check route path\n* `fast_api_app_kwargs`: kwargs to pass to the FastAPI constructor\n* `final`: whether this will be the last instance of the Prefect server to be\n  created in this process, so that additional optimizations may be applied\n* `ignore_cache`: if set, a new app will be created even if the settings and fast\\_api\\_app\\_kwargs match\n  an existing app in the cache\n\n**Returns:**\n\n* a FastAPI app that serves the Prefect REST API\n\n### `create_ui_app` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L454\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_ui_app(ephemeral: bool) -> FastAPI\n```\n\n### `create_app` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L612\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_app(settings: Optional[prefect.settings.Settings] = None, ephemeral: bool = False, webserver_only: bool = False, final: bool = False, ignore_cache: bool = False) -> FastAPI\n```\n\nCreate a FastAPI app that includes the Prefect REST API and UI\n\n**Args:**\n\n* `settings`: The settings to use to create the app. If not set, settings are pulled\n  from the context.\n* `ephemeral`: If set, the application will be treated as ephemeral. The UI\n  and services will be disabled.\n* `webserver_only`: If set, the webserver and UI will be available but all background\n  services will be disabled.\n* `final`: whether this will be the last instance of the Prefect server to be\n  created in this process, so that additional optimizations may be applied\n* `ignore_cache`: If set, a new application will be created even if the settings\n  match. Otherwise, an application is returned from the cache.\n\n## Classes\n\n### `SPAStaticFiles` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L162\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nImplementation of `StaticFiles` for serving single page applications.\n\nAdds `get_response` handling to ensure that when a resource isn't found the\napplication still returns the index.\n\n**Methods:**\n\n#### `get_response` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L170\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nget_response(self, path: str, scope: Any) -> Response\n```\n\n### `RequestLimitMiddleware` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L177\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nA middleware that limits the number of concurrent requests handled by the API.\n\nThis is a blunt tool for limiting SQLite concurrent writes which will cause failures\nat high volume. Ideally, we would only apply the limit to routes that perform\nwrites.\n\n### `SubprocessASGIServer` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L811\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `address` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L854\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\naddress(self) -> str\n```\n\n#### `api_url` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L858\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\napi_url(self) -> str\n```\n\n#### `find_available_port` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L833\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nfind_available_port(self) -> int\n```\n\n#### `is_port_available` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L843\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nis_port_available(port: int) -> bool\n```\n\n#### `start` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L861\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstart(self, timeout: Optional[int] = None) -> None\n```\n\nStart the server in a separate process. Safe to call multiple times; only starts\nthe server once.\n\n**Args:**\n\n* `timeout`: The maximum time to wait for the server to start\n\n#### `stop` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/server/api/server.py#L955\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstop(self) -> None\n```",
  "content_length": 8437
}