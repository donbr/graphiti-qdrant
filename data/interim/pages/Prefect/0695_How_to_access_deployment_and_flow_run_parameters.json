{
  "title": "How to access deployment and flow run parameters",
  "source_url": "https://docs-3.prefect.io/v3/how-to-guides/automations/access-parameters-in-templates",
  "content": "Learn how to access deployment and flow run parameters in templates\n\nMany of the parameters of automation actions can be defined with [Jinja2 templates](/v3/concepts/automations#templating-with-jinja). These templates have access to objects related to the event that triggered your automation, including the deployment and flow run of that event (if applicable). Here we'll explore an example illustrating how to access their parameters in an automation action.\n\nLet's start with two flows, `alpha` and `beta`:\n\n```python  theme={null}\nfrom prefect import flow\n\n\n@flow\ndef alpha(name: str, value: int):\n    print(name, value)\n\n\n@flow\ndef beta(name: str, value: int, another: float):\n    print(name, value, another)\n```\n\nOnce a run of `alpha` completes, we'll automate running a flow of `beta` with the same parameters:\n\n```python  theme={null}\nfrom datetime import timedelta\n\nfrom prefect.automations import (\n    Automation,\n    EventTrigger,\n    Posture,\n    ResourceSpecification,\n    RunDeployment,\n)\n\nfrom .flows import alpha, beta\n\n# Note: deploy these flows in the way you best see fit for your environment\nalpha.deploy(\n    name=\"alpha\",\n    work_pool_name=\"my-work-pool\",\n    image=\"prefecthq/prefect-client:3-latest\",\n)\nbeta_deployment_id = beta.deploy(\n    name=\"beta\",\n    work_pool_name=\"my-work-pool\",\n    image=\"prefecthq/prefect-client:3-latest\",\n)\n\nautomation = Automation(\n    name=\"Passing parameters\",\n    trigger=EventTrigger(\n        # Here we're matching on every completion of the `alpha` flow\n        expect={\"prefect.flow-run.Completed\"},\n        match_related=ResourceSpecification(\n            {\n                \"prefect.resource.role\": \"flow\",\n                \"prefect.resource.name\": \"alpha\"\n            }\n        ),\n        # And we'll react to each event immediately and individually\n        posture=Posture.Reactive,\n        threshold=1,\n        within=timedelta(0),\n    ),\n    actions=[\n        RunDeployment(\n            # We will be selecting a specific deployment (rather than attempting to\n            # infer it from the event)\n            source=\"selected\",\n            # The deployment we want to run is the `beta` deployment we created above\n            deployment_id=beta_deployment_id,\n            parameters={\n                # For the \"name\" and \"value\" parameters, we tell Prefect we're using a\n                # Jinja2 template by creating a nested dictionary with the special\n                # `__prefect_kind` key set to \"jinja\".  Then we supply the `template`\n                # value with any valid Jinja2 template.  This step may also be done\n                # in the Prefect UI by selecting \"Use Jinja input\" for the parameters\n                # you want to template.\n                #\n                # The \"{{ flow_run }}\" variable here is a special shortcut that gives us\n                # access to the `FlowRun` object associated with this event.  There are\n                # also variables like \"{{ deployment }}\", \"{{ flow }}\",\n                # \"{{ work_pool }}\" and so on.\n                #\n                # In this case, the {{ flow_run }} represent the run of `alpha` that\n                # emitted the `prefect.flow-run.Completed` event that triggered this\n                # automation.\n                \"name\": {\n                    \"template\": \"{{ flow_run.parameters['name'] }}\",\n                    \"__prefect_kind\": \"jinja\",\n                },\n                \"value\": {\n                    \"template\": \"{{ flow_run.parameters['value'] }}\",\n                    \"__prefect_kind\": \"jinja\",\n                },\n                # You can also just pass literal parameters\n                \"another\": 1.2345,\n            },\n        )\n    ],\n).create()\n```\n\nIf you are defining your automation in the Prefect web UI, you can switch the parameter input to support Jinja2 values:\n\n<img src=\"https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=9609c36afc9d6d7800f75197e07767e8\" alt=\"Use Jinja input for an action\" data-og-width=\"732\" width=\"732\" data-og-height=\"753\" height=\"753\" data-path=\"v3/img/guides/automation-use-jinja-input.png\" data-optimize=\"true\" data-opv=\"3\" srcset=\"https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?w=280&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=a691e383832856eb40cc1101130cd1eb 280w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?w=560&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=3db43f776c1bfe800573e0cbcff3397a 560w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?w=840&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=af932dec4e8ab1cf04c68ff10e9b3dc2 840w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?w=1100&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=e7632848927fa34d69c864ddd3ea8c48 1100w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?w=1650&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=4d76f281b0729de09ccca098d97846c6 1650w, https://mintcdn.com/prefect-bd373955/rm4-_dTLtkmSX6eG/v3/img/guides/automation-use-jinja-input.png?w=2500&fit=max&auto=format&n=rm4-_dTLtkmSX6eG&q=85&s=8b41f48b4c5c9aef1ebd98f0842850ed 2500w\" />",
  "content_length": 5379
}