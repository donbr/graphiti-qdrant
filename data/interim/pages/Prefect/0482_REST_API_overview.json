{
  "title": "REST API overview",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/rest-api/index",
  "content": "Prefect REST API for interacting with Prefect Cloud & self-hosted Prefect server.\n\nThe Prefect API is organized around REST. It is used for communicating data from clients to a self-hosted Prefect server instance so that orchestration can be performed. This API is consumed by clients such as the Prefect Python SDK or the server dashboard.\n\nPrefect Cloud and self-hosted Prefect server each provide a REST API.\n\n* Prefect Cloud:\n  * [Interactive Prefect Cloud REST API documentation](https://app.prefect.cloud/api/docs)\n  * [Finding your Prefect Cloud details](#finding-your-prefect-cloud-details)\n* Self-hosted Prefect server:\n  * Interactive REST API documentation for self-hosted Prefect server is available under **Server API** on the sidebar navigation or at `http://localhost:4200/docs` or the `/docs` endpoint of the [PREFECT\\_API\\_URL](/v3/develop/settings-and-profiles/) you have configured to access the server. You must have the server running with `prefect server start` to access the interactive documentation.\n\n## Interact with the REST API\n\nYou can interact with the Prefect REST API in several ways:\n\n* Create an instance of [`PrefectClient`](https://reference.prefect.io/prefect/client/orchestration/#prefect.client.orchestration.PrefectClient), which is part of the [Prefect Python SDK](/v3/api-ref/python/).\n* Use your favorite Python HTTP library such as [Requests](https://requests.readthedocs.io/en/latest/) or [HTTPX](https://www.python-httpx.org/)\n* Use an HTTP library in your language of choice\n* Use [curl](https://curl.se/) from the command line\n\n### PrefectClient with self-hosted Prefect server\n\nThis example uses `PrefectClient` with self-hosted Prefect server:\n\n```python  theme={null}\nimport asyncio\nfrom prefect.client.orchestration import get_client\n\n\nasync def get_flows():\n    client = get_client()\n    r = await client.read_flows(limit=5)\n    return r\n\n\nr = asyncio.run(get_flows())\n\nfor flow in r:\n    print(flow.name, flow.id)\n\n\nif __name__ == \"__main__\":\n    asyncio.run(get_flows())\n```\n\nOutput:\n\n```bash  theme={null}\ncat-facts 58ed68b1-0201-4f37-adef-0ea24bd2a022\ndog-facts e7c0403d-44e7-45cf-a6c8-79117b7f3766\nsloth-facts 771c0574-f5bf-4f59-a69d-3be3e061a62d\ncapybara-facts fbadaf8b-584f-48b9-b092-07d351edd424\nlemur-facts 53f710e7-3b0f-4b2f-ab6b-44934111818c\n```\n\n### Requests with Prefect\n\nThis example uses the Requests library with Prefect Cloud to return the five newest artifacts.\n\n```python  theme={null}\nimport requests\n\n\nPREFECT_API_URL=\"https://api.prefect.cloud/api/accounts/abc-my-cloud-account-id-is-here/workspaces/123-my-workspace-id-is-here\"\nPREFECT_API_KEY=\"123abc_my_api_key_goes_here\"\ndata = {\n    \"sort\": \"CREATED_DESC\",\n    \"limit\": 5,\n    \"artifacts\": {\n        \"key\": {\n            \"exists_\": True\n        }\n    }\n}\n\nheaders = {\"Authorization\": f\"Bearer {PREFECT_API_KEY}\"}\nendpoint = f\"{PREFECT_API_URL}/artifacts/filter\"\n\nresponse = requests.post(endpoint, headers=headers, json=data)\nassert response.status_code == 200\nfor artifact in response.json():\n    print(artifact)\n```\n\n### curl with Prefect Cloud\n\nThis example uses curl with Prefect Cloud to create a flow run:\n\n```bash  theme={null}\nACCOUNT_ID=\"abc-my-cloud-account-id-goes-here\"\nWORKSPACE_ID=\"123-my-workspace-id-goes-here\"\nPREFECT_API_URL=\"https://api.prefect.cloud/api/accounts/$ACCOUNT_ID/workspaces/$WORKSPACE_ID\"\nPREFECT_API_KEY=\"123abc_my_api_key_goes_here\"\nDEPLOYMENT_ID=\"my_deployment_id\"\n\ncurl --location --request POST \"$PREFECT_API_URL/deployments/$DEPLOYMENT_ID/create_flow_run\" \\\n  --header \"Content-Type: application/json\" \\\n  --header \"Authorization: Bearer $PREFECT_API_KEY\" \\\n  --header \"X-PREFECT-API-VERSION: 0.8.4\" \\\n  --data-raw \"{}\"\n```\n\nNote that in this example `--data-raw \"{}\"` is required and is where you can specify other aspects of the flow run such as the state. Windows users substitute `^` for `\\` for line multi-line commands.\n\n## Finding your Prefect Cloud details\n\nWhen working with the Prefect Cloud REST API you will need your Account ID and often the Workspace ID for the [workspace](/v3/manage/cloud/workspaces/) you want to interact with. You can find both IDs for a [Prefect profile](/v3/develop/settings-and-profiles/) in the CLI with `prefect profile inspect my_profile`. This command will also display your [Prefect API key](/v3/how-to-guides/cloud/manage-users/api-keys), as shown below:\n\n```bash  theme={null}\nPREFECT_API_URL='https://api.prefect.cloud/api/accounts/abc-my-account-id-is-here/workspaces/123-my-workspace-id-is-here'\nPREFECT_API_KEY='123abc_my_api_key_is_here'\n```\n\nAlternatively, view your Account ID and Workspace ID in your browser URL. For example: `https://app.prefect.cloud/account/abc-my-account-id-is-here/workspaces/123-my-workspace-id-is-here`.\n\n## REST guidelines\n\nThe REST APIs adhere to the following guidelines:\n\n* Collection names are pluralized (for example, `/flows` or `/runs`).\n* We indicate variable placeholders with colons: `GET /flows/:id`.\n* We use snake case for route names: `GET /task_runs`.\n* We avoid nested resources unless there is no possibility of accessing the child resource outside the parent context. For example, we query `/task_runs` with a flow run filter instead of accessing `/flow_runs/:id/task_runs`.\n* The API is hosted with an `/api/:version` prefix that (optionally) allows versioning in the future. By convention, we treat that as part of the base URL and do not include that in API examples.\n* Filtering, sorting, and pagination parameters are provided in the request body of `POST` requests where applicable.\n  * Pagination parameters are `limit` and `offset`.\n  * Sorting is specified with a single `sort` parameter.\n  * See more information on [filtering](#filtering) below.\n\n### HTTP verbs\n\n* `GET`, `PUT` and `DELETE` requests are always idempotent. `POST` and `PATCH` are not guaranteed to be idempotent.\n* `GET` requests cannot receive information from the request body.\n* `POST` requests can receive information from the request body.\n* `POST /collection` creates a new member of the collection.\n* `GET /collection` lists all members of the collection.\n* `GET /collection/:id` gets a specific member of the collection by ID.\n* `DELETE /collection/:id` deletes a specific member of the collection.\n* `PUT /collection/:id` creates or replaces a specific member of the collection.\n* `PATCH /collection/:id` partially updates a specific member of the collection.\n* `POST /collection/action` is how we implement non-CRUD actions. For example, to set a flow run's state, we use `POST /flow_runs/:id/set_state`.\n* `POST /collection/action` may also be used for read-only queries. This is to allow us to send complex arguments as body arguments (which often cannot be done via `GET`). Examples include `POST /flow_runs/filter`, `POST /flow_runs/count`, and `POST /flow_runs/history`.\n\n## Filter results\n\nObjects can be filtered by providing filter criteria in the body of a `POST` request. When multiple criteria are specified, logical AND will be applied to the criteria.\n\nFilter criteria are structured as follows:\n\n```json  theme={null}\n{\n    \"objects\": {\n        \"object_field\": {\n            \"field_operator_\": <field_value>\n        }\n    }\n}\n```\n\nIn this example, `objects` is the name of the collection to filter over (for example, `flows`). The collection can be either the object being queried for (`flows` for `POST /flows/filter`) or a related object (`flow_runs` for `POST /flows/filter`).\n\n`object_field` is the name of the field over which to filter (`name` for `flows`). Note that some objects may have nested object fields, such as `{flow_run: {state: {type: {any_: []}}}}`.\n\n`field_operator_` is the operator to apply to a field when filtering. Common examples include:\n\n* `any_`: return objects where this field matches any of the following values.\n* `is_null_`: return objects where this field is or is not null.\n* `eq_`: return objects where this field is equal to the following value.\n* `all_`: return objects where this field matches all of the following values.\n* `before_`: return objects where this datetime field is less than or equal to the following value.\n* `after_`: return objects where this datetime field is greater than or equal to the following value.\n\nFor example, to query for flows with the tag `\"database\"` and failed flow runs, `POST /flows/filter` with the following request body:\n\n```json  theme={null}\n{\n    \"flows\": {\n        \"tags\": {\n            \"all_\": [\"database\"]\n        }\n    },\n    \"flow_runs\": {\n        \"state\": {\n            \"type\": {\n              \"any_\": [\"FAILED\"]\n            }\n        }\n    }\n}\n```\n\n## OpenAPI\n\nThe Prefect REST API can be fully described with an OpenAPI 3.0 compliant document. [OpenAPI](https://swagger.io/docs/specification/about/) is a standard specification for describing REST APIs.\n\nTo generate self-hosted Prefect server's complete OpenAPI document, run the following commands in an interactive Python session:\n\n```python  theme={null}\nfrom prefect.server.api.server import create_app\n\n\napp = create_app()\nopenapi_doc = app.openapi()\n```\n\nThis document allows you to generate your own API client, explore the API using an API inspection tool, or write tests to ensure API compliance.",
  "content_length": 9212
}