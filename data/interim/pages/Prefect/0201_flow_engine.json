{
  "title": "flow_engine",
  "source_url": "https://docs-3.prefect.io/v3/api-ref/python/prefect-flow_engine",
  "content": "# `prefect.flow_engine`\n\n## Functions\n\n### `load_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L136\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nload_flow_run(flow_run_id: UUID) -> FlowRun\n```\n\n### `load_flow` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L142\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nload_flow(flow_run: FlowRun) -> Flow[..., Any]\n```\n\n### `load_flow_and_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L158\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nload_flow_and_flow_run(flow_run_id: UUID) -> tuple[FlowRun, Flow[..., Any]]\n```\n\n### `run_flow_sync` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1406\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_flow_sync(flow: Flow[P, R], flow_run: Optional[FlowRun] = None, parameters: Optional[Dict[str, Any]] = None, wait_for: Optional[Iterable[PrefectFuture[Any]]] = None, return_type: Literal['state', 'result'] = 'result', context: Optional[dict[str, Any]] = None) -> Union[R, State, None]\n```\n\n### `run_flow_async` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1430\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_flow_async(flow: Flow[P, R], flow_run: Optional[FlowRun] = None, parameters: Optional[Dict[str, Any]] = None, wait_for: Optional[Iterable[PrefectFuture[Any]]] = None, return_type: Literal['state', 'result'] = 'result', context: Optional[dict[str, Any]] = None) -> Union[R, State, None]\n```\n\n### `run_generator_flow_sync` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1454\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_generator_flow_sync(flow: Flow[P, R], flow_run: Optional[FlowRun] = None, parameters: Optional[Dict[str, Any]] = None, wait_for: Optional[Iterable[PrefectFuture[Any]]] = None, return_type: Literal['state', 'result'] = 'result', context: Optional[dict[str, Any]] = None) -> Generator[R, None, None]\n```\n\n### `run_generator_flow_async` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1495\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_generator_flow_async(flow: Flow[P, R], flow_run: Optional[FlowRun] = None, parameters: Optional[Dict[str, Any]] = None, wait_for: Optional[Iterable[PrefectFuture[R]]] = None, return_type: Literal['state', 'result'] = 'result', context: Optional[dict[str, Any]] = None) -> AsyncGenerator[R, None]\n```\n\n### `run_flow` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1538\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_flow(flow: Flow[P, R], flow_run: Optional[FlowRun] = None, parameters: Optional[Dict[str, Any]] = None, wait_for: Optional[Iterable[PrefectFuture[R]]] = None, return_type: Literal['state', 'result'] = 'result', error_logger: Optional[logging.Logger] = None, context: Optional[dict[str, Any]] = None) -> R | State | None | Coroutine[Any, Any, R | State | None] | Generator[R, None, None] | AsyncGenerator[R, None]\n```\n\n### `run_flow_in_subprocess` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1611\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_flow_in_subprocess(flow: 'Flow[..., Any]', flow_run: 'FlowRun | None' = None, parameters: dict[str, Any] | None = None, wait_for: Iterable[PrefectFuture[Any]] | None = None, context: dict[str, Any] | None = None) -> multiprocessing.context.SpawnProcess\n```\n\nRun a flow in a subprocess.\n\nNote the result of the flow will only be accessible if the flow is configured to\npersist its result.\n\n**Args:**\n\n* `flow`: The flow to run.\n* `flow_run`: The flow run object containing run metadata.\n* `parameters`: The parameters to use when invoking the flow.\n* `wait_for`: The futures to wait for before starting the flow.\n* `context`: A serialized context to hydrate before running the flow. If not provided,\n  the current context will be used. A serialized context should be provided if\n  this function is called in a separate memory space from the parent run (e.g.\n  in a subprocess or on another machine).\n\n**Returns:**\n\n* A multiprocessing.context.SpawnProcess representing the process that is running the flow.\n\n## Classes\n\n### `FlowRunTimeoutError` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L132\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nRaised when a flow run exceeds its defined timeout.\n\n### `BaseFlowRunEngine` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L165\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `cancel_all_tasks` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L203\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncancel_all_tasks(self) -> None\n```\n\n#### `is_pending` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L198\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nis_pending(self) -> bool\n```\n\n#### `is_running` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L193\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nis_running(self) -> bool\n```\n\n#### `state` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L190\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstate(self) -> State\n```\n\n### `FlowRunEngine` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L242\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n**Methods:**\n\n#### `begin_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L292\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nbegin_run(self) -> State\n```\n\n#### `call_flow_fn` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L804\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncall_flow_fn(self) -> Union[R, Coroutine[Any, Any, R]]\n```\n\nConvenience method to call the flow function. Returns a coroutine if the\nflow is async.\n\n#### `call_hooks` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L538\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncall_hooks(self, state: Optional[State] = None) -> None\n```\n\n#### `client` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L248\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nclient(self) -> SyncPrefectClient\n```\n\n#### `create_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L503\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_flow_run(self, client: SyncPrefectClient) -> FlowRun\n```\n\n#### `handle_crash` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L445\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_crash(self, exc: BaseException) -> None\n```\n\n#### `handle_exception` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L394\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_exception(self, exc: Exception, msg: Optional[str] = None, result_store: Optional[ResultStore] = None) -> State\n```\n\n#### `handle_success` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L374\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_success(self, result: R) -> R\n```\n\n#### `handle_timeout` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L427\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_timeout(self, exc: TimeoutError) -> None\n```\n\n#### `initialize_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L690\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ninitialize_run(self)\n```\n\nEnters a client context and creates a flow run if needed.\n\n#### `load_subflow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L454\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nload_subflow_run(self, parent_task_run: TaskRun, client: SyncPrefectClient, context: FlowRunContext) -> Union[FlowRun, None]\n```\n\nThis method attempts to load an existing flow run for a subflow task\nrun, if appropriate.\n\nIf the parent task run is in a final but not COMPLETED state, and not\nbeing rerun, then we attempt to load an existing flow run instead of\ncreating a new one. This will prevent the engine from running the\nsubflow again.\n\nIf no existing flow run is found, or if the subflow should be rerun,\nthen no flow run is returned.\n\n#### `result` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L348\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nresult(self, raise_on_failure: bool = True) -> 'Union[R, State, None]'\n```\n\n#### `run_context` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L785\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_context(self)\n```\n\n#### `set_state` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L331\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nset_state(self, state: State, force: bool = False) -> State\n```\n\n#### `setup_run_context` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L595\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nsetup_run_context(self, client: Optional[SyncPrefectClient] = None)\n```\n\n#### `start` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L773\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstart(self) -> Generator[None, None, None]\n```\n\n### `AsyncFlowRunEngine` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L822\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\nAsync version of the flow run engine.\n\nNOTE: This has not been fully asyncified yet which may lead to async flows\nnot being fully asyncified.\n\n**Methods:**\n\n#### `begin_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L879\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nbegin_run(self) -> State\n```\n\n#### `call_flow_fn` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1394\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncall_flow_fn(self) -> Coroutine[Any, Any, R]\n```\n\nConvenience method to call the flow function. Returns a coroutine if the\nflow is async.\n\n#### `call_hooks` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1122\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncall_hooks(self, state: Optional[State] = None) -> None\n```\n\n#### `client` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L835\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nclient(self) -> PrefectClient\n```\n\n#### `create_flow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1089\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ncreate_flow_run(self, client: PrefectClient) -> FlowRun\n```\n\n#### `handle_crash` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1027\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_crash(self, exc: BaseException) -> None\n```\n\n#### `handle_exception` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L977\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_exception(self, exc: Exception, msg: Optional[str] = None, result_store: Optional[ResultStore] = None) -> State\n```\n\n#### `handle_success` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L960\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_success(self, result: R) -> R\n```\n\n#### `handle_timeout` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1008\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nhandle_timeout(self, exc: TimeoutError) -> None\n```\n\n#### `initialize_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1272\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\ninitialize_run(self)\n```\n\nEnters a client context and creates a flow run if needed.\n\n#### `load_subflow_run` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1040\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nload_subflow_run(self, parent_task_run: TaskRun, client: PrefectClient, context: FlowRunContext) -> Union[FlowRun, None]\n```\n\nThis method attempts to load an existing flow run for a subflow task\nrun, if appropriate.\n\nIf the parent task run is in a final but not COMPLETED state, and not\nbeing rerun, then we attempt to load an existing flow run instead of\ncreating a new one. This will prevent the engine from running the\nsubflow again.\n\nIf no existing flow run is found, or if the subflow should be rerun,\nthen no flow run is returned.\n\n#### `result` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L935\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nresult(self, raise_on_failure: bool = True) -> 'Union[R, State, None]'\n```\n\n#### `run_context` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1375\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nrun_context(self)\n```\n\n#### `set_state` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L918\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nset_state(self, state: State, force: bool = False) -> State\n```\n\n#### `setup_run_context` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1179\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nsetup_run_context(self, client: Optional[PrefectClient] = None)\n```\n\n#### `start` <sup><a href=\"https://github.com/PrefectHQ/prefect/blob/main/src/prefect/flow_engine.py#L1363\" target=\"_blank\"><Icon icon=\"github\" style=\"width: 14px; height: 14px;\" /></a></sup>\n\n```python  theme={null}\nstart(self) -> AsyncGenerator[None, None]\n```",
  "content_length": 17126
}